
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Household Electric Power Consumption Forecasting &#8212; Veri Bilimi Portfolyosu</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"00db6a80c50d41b7b81330aa5bc43cb3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "01a9e011e6d14f1482c932e2f44b3a05": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0634730cbbff42a9bf0744e681223238": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0fc8ded140704ac6962e36a07377ef3c", "IPY_MODEL_48a3e65bc9b84c0eb029021a8b7d6c26", "IPY_MODEL_877ad3965e044d7b9c57509c0f056c0c"], "layout": "IPY_MODEL_464705dcba88447d80d66465aa5a9219", "tabbable": null, "tooltip": null}}, "06d18256f62f41ee9dd6c78ffa44dcd4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "06e431b57b4c42e98a53e4c0f7c285ae": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "075325c025294f7ba2c57cf7667d1dd8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0887c3a2aa8947779affaa5b51bc67a9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "090b71a0e73b4108ab1cc4bdd40a2e4d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "09408436f39c410faef3ac8328e6d993": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f01cafd778574d07aabdbc115770119f", "IPY_MODEL_2d33e53c28c3475482558af57d9a22dc", "IPY_MODEL_82f4febc9931416cbaa244c18b4832f2"], "layout": "IPY_MODEL_abda0f25d35849cdbb53a97e6c5250af", "tabbable": null, "tooltip": null}}, "0943543befd348bba4e330a9de40c452": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "098a383ceb2b4eddaec1aaac4dccceb8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0c60a9aec0d641e1b23845c91c73da43": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0d9028d01b764a64b39f3920f39ca037": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0e4eba0d140749cbb97a8dc200d01e5f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "0f6e4ebd56eb4e749aa2912ae1b2cdc4": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f7662381c55418fa47fb758910e748a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0fc8ded140704ac6962e36a07377ef3c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_906d8add8b80437e98f69c2285b9a208", "placeholder": "\u200b", "style": "IPY_MODEL_d75c3de0fcdf4aebb446b90f0afa98a0", "tabbable": null, "tooltip": null, "value": "100%"}}, "1151dc80cbc4465d8668c235045d9550": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "11f3ddcadf4142f29267646927a3616d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1209f6594cba4069bec2c3f0f0c1037c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "128b3021e52045bfb79189ba7cac26dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c7b7cb92127143b7a3dd556d223d6bca", "placeholder": "\u200b", "style": "IPY_MODEL_939b9fb43b7545bf832b29e0cf7d2b11", "tabbable": null, "tooltip": null, "value": "100%"}}, "134acb5a6b204f359ef63a74b8865343": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "134afd40c07b42789a909cab3aeb117e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_4c35e12420eb42c3bab7401df110c720", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_06d18256f62f41ee9dd6c78ffa44dcd4", "tabbable": null, "tooltip": null, "value": 4}}, "1622a83830c045d1a2f05c23b15d6431": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_653df322e32c4e5a8f21508f422c4cf7", "placeholder": "\u200b", "style": "IPY_MODEL_6dc37c370e8f411e82829c13fd1926ec", "tabbable": null, "tooltip": null, "value": "100%"}}, "16cadeea8f57455eb69f357236951e18": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "195c38e02be140bbb70ced9a060f58b9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "196ddd4e9ff846188be22ee5d4d9fdc8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "19eaa1de60e842e1b6810dceae4bed46": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b4de85c521fc4ad49212240871c74d89", "IPY_MODEL_cc2d41c9938c44cc82c3f16aaa4b3667", "IPY_MODEL_fd0c80ac97d24194b047899bf7a01a5e"], "layout": "IPY_MODEL_b0a85852bb8b436285e60bd1964c5e58", "tabbable": null, "tooltip": null}}, "1a2ca60babd34f41bc44c307a70b5d2f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1ec02c6d487f45a5bf2fa89d01774ac6": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "21100b4d827347ce9bc52fcf9b3e1c45": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2176f1146ad3497d865501e4a56aeee6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e4493afc7f934cd09a2b6485bb88865d", "IPY_MODEL_134afd40c07b42789a909cab3aeb117e", "IPY_MODEL_528f4bb287e541d6a7dd8b6b85fe36af"], "layout": "IPY_MODEL_1151dc80cbc4465d8668c235045d9550", "tabbable": null, "tooltip": null}}, "222f002885eb492d9a5743df55512faf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "2797940911c34de0b192402a3dbf8b23": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "28a306bec0a84e1cbaa3743a6797ea7e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2953596ad8af4830a9f6b50872722977": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2cb22d58519e4cf88332ac26ef77e191": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e049af5f846145dc8ca43123ac1a08e3", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_3a0a7a13919f4d20b6d89ac908343654", "tabbable": null, "tooltip": null, "value": 4}}, "2d31c35007ed4067806d3470d026313d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2d33e53c28c3475482558af57d9a22dc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b524fc7bbae24382abf72ed9230eb5f1", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_4289ae7edd7f461883e1df6c6b708ad8", "tabbable": null, "tooltip": null, "value": 4}}, "306d3e6a33db41b0bfed4500cfe00dcd": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36101bb7015143dc84004309cf6888fe": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_195c38e02be140bbb70ced9a060f58b9", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_7adafe9842794a598cb3f9ebe59659ea", "tabbable": null, "tooltip": null, "value": 4}}, "3752f8934ab649a8b4738ab325fb5184": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "37576bb7ddf1478da54b17706e3af65f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "393d53c3ca514010b2fcd4800107c8ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "39a7dbc6ff76406d8103542768aef236": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "39e327d7816e418885e99b1a94225810": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3a0a7a13919f4d20b6d89ac908343654": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "3a0d676a14494f2ca7dafda578a0c7b0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4289ae7edd7f461883e1df6c6b708ad8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "42964137b3c54d388c04bca5668fd770": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fe7678ba408441df8ae9f664bfce5ed5", "placeholder": "\u200b", "style": "IPY_MODEL_8feb7ef95db2406a862ec19dbb9070eb", "tabbable": null, "tooltip": null, "value": "100%"}}, "448723a572504393a0214c846f2c28ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4528ddfef46749f8922e11ade00f45f8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_16cadeea8f57455eb69f357236951e18", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_7652ca7cfebd4625a5ca196510ba5f30", "tabbable": null, "tooltip": null, "value": 4}}, "464705dcba88447d80d66465aa5a9219": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "476bb1ecc2684b6fb2d83ebc5cc46e2f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e585a89d318842d08846b7af7837f037", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_7e6c5d737bc547aca4571e8e1581573a", "tabbable": null, "tooltip": null, "value": 4}}, "48a3e65bc9b84c0eb029021a8b7d6c26": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9c3c190c36c741168d5d9e6834434575", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_92a41ff7fddd4546ab99ba63be879389", "tabbable": null, "tooltip": null, "value": 4}}, "498f7d4e8bf1439683ee95596320ee50": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4c35e12420eb42c3bab7401df110c720": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4c6ef65f264443ef90b8ff3abf91e29a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9d61fdde0ca04998a38436d7ee0c0c10", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_0e4eba0d140749cbb97a8dc200d01e5f", "tabbable": null, "tooltip": null, "value": 4}}, "5151467faaa044a8b3c759b035876a82": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "523a1093434a48509808f7c7e4e408fe": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9f8ff1c7140d420db775b8653d644cf9", "placeholder": "\u200b", "style": "IPY_MODEL_da03fcee9df84dbcbbdaa1c4471f94bf", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.51it/s]"}}, "5274c4ecedef49ae9a4219272b420cbe": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0f6e4ebd56eb4e749aa2912ae1b2cdc4", "placeholder": "\u200b", "style": "IPY_MODEL_c0fe75ea92cb43a2bd5e64da4840ad94", "tabbable": null, "tooltip": null, "value": "100%"}}, "528f4bb287e541d6a7dd8b6b85fe36af": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_8a40b4353a574c5d81a42be2802e0c3e", "placeholder": "\u200b", "style": "IPY_MODEL_3752f8934ab649a8b4738ab325fb5184", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:01&lt;00:00,\u2007\u20071.76it/s]"}}, "528f88cdaa494dcdb135d6957736e299": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5ab0a6def9754e63b33a96b02079decd": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5de39113b0e24af188677abee08cac6b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "5e2c3d221ccc48b38fff725cfa8342f9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5eb1dbfec1c44ab4b5e737a636dd837c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "6025cfa7228840619933b83c73e144dc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_90e179b0de1545bd945de8996df53584", "placeholder": "\u200b", "style": "IPY_MODEL_098a383ceb2b4eddaec1aaac4dccceb8", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20075.50it/s]"}}, "624cd576a7274887894b889786c5e47a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9f27d9d985404662833b45db05ada62a", "IPY_MODEL_476bb1ecc2684b6fb2d83ebc5cc46e2f", "IPY_MODEL_9b481149f1654dd3b4a33dd079410724"], "layout": "IPY_MODEL_2797940911c34de0b192402a3dbf8b23", "tabbable": null, "tooltip": null}}, "63df6edb19084aeb8c5c40b7d35f3b35": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1209f6594cba4069bec2c3f0f0c1037c", "placeholder": "\u200b", "style": "IPY_MODEL_b3abb6f2d3054ae08303765fa5f85f03", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.76it/s]"}}, "64b2ef2a4fed4535b18b1caea011b2c5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_bdd6601c5d86432296b00b451ab0b60d", "placeholder": "\u200b", "style": "IPY_MODEL_5de39113b0e24af188677abee08cac6b", "tabbable": null, "tooltip": null, "value": "100%"}}, "64c76e4117c4434c92215d50aa2d3980": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "653df322e32c4e5a8f21508f422c4cf7": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "665d3e262b494404bdcafd01b142a781": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "66aecf77181a4623b24331a250825de6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "6c15d96d1aec43229e6df9cfa3e5708e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_dad989dd5d7c47f6a10ec7aa09d74d70", "IPY_MODEL_afeeb367c77b4485b17df598e1013323", "IPY_MODEL_83edf3ff997345148f46688d2fd37faa"], "layout": "IPY_MODEL_498f7d4e8bf1439683ee95596320ee50", "tabbable": null, "tooltip": null}}, "6dc37c370e8f411e82829c13fd1926ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "6e2c9901b1d94cb2866d4903e12cac93": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ee25fef0e7346f6abca571c6aece8dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "711964b1500145c983713f4e25cf93d7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5151467faaa044a8b3c759b035876a82", "placeholder": "\u200b", "style": "IPY_MODEL_b924eeb8b87d43e1aeaa990be457fa0a", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:02&lt;00:00,\u2007\u20071.74it/s]"}}, "7652ca7cfebd4625a5ca196510ba5f30": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7671adaa53d9403eb53aedbf3f43f1fd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0d9028d01b764a64b39f3920f39ca037", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_37576bb7ddf1478da54b17706e3af65f", "tabbable": null, "tooltip": null, "value": 4}}, "767b39f56eb047d8907a82aabe57ed47": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7adafe9842794a598cb3f9ebe59659ea": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7e6c5d737bc547aca4571e8e1581573a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "8210d760e32c4499a53936455d36d4e7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "82f4febc9931416cbaa244c18b4832f2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e54969ee334b4324b69c81e1d336ad25", "placeholder": "\u200b", "style": "IPY_MODEL_66aecf77181a4623b24331a250825de6", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.85it/s]"}}, "83edf3ff997345148f46688d2fd37faa": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d61969114e004dd393fd1050b51d75f9", "placeholder": "\u200b", "style": "IPY_MODEL_075325c025294f7ba2c57cf7667d1dd8", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.56it/s]"}}, "86a4fa4d0f334a529b025de140f93382": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0943543befd348bba4e330a9de40c452", "placeholder": "\u200b", "style": "IPY_MODEL_fb7293ef5c4a46cf92247ac9ea1f1204", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:02&lt;00:00,\u2007\u20071.30it/s]"}}, "876b1cabe009455990acc25e8589d6c6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "877ad3965e044d7b9c57509c0f056c0c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2d31c35007ed4067806d3470d026313d", "placeholder": "\u200b", "style": "IPY_MODEL_134acb5a6b204f359ef63a74b8865343", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:02&lt;00:00,\u2007\u20071.69it/s]"}}, "8a40b4353a574c5d81a42be2802e0c3e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8b7118c50c414839a2adc3d7c1585584": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8dc13dc88cbb4e87beecb79d64c938ee": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_090b71a0e73b4108ab1cc4bdd40a2e4d", "placeholder": "\u200b", "style": "IPY_MODEL_6ee25fef0e7346f6abca571c6aece8dd", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.54it/s]"}}, "8e2ba2507cd946ac9fe76355baea08ee": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b1a392e469414b138b87644ab68f8231", "placeholder": "\u200b", "style": "IPY_MODEL_222f002885eb492d9a5743df55512faf", "tabbable": null, "tooltip": null, "value": "100%"}}, "8e311df9b75048958f409a6ec8c34fa7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_cdec8951ed534051a3a2c6b6ffc43dc9", "placeholder": "\u200b", "style": "IPY_MODEL_d764b640de9a4780bcfa0a2105f98fc9", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:02&lt;00:00,\u2007\u20071.30it/s]"}}, "8feb7ef95db2406a862ec19dbb9070eb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "906d8add8b80437e98f69c2285b9a208": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "90ce857b7da3481283fce91a513ca207": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a9bf7c6c576144a9b3cd40343519b7fb", "IPY_MODEL_dd20256ebea44020927c53d5ab762f2f", "IPY_MODEL_bf32aff4d2054ba2ae467573f3cc544a"], "layout": "IPY_MODEL_306d3e6a33db41b0bfed4500cfe00dcd", "tabbable": null, "tooltip": null}}, "90e179b0de1545bd945de8996df53584": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "92a41ff7fddd4546ab99ba63be879389": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "939b9fb43b7545bf832b29e0cf7d2b11": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "964c7b129e2a400b8c06b580a2c561ba": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c22bf1b6a9e34feeb867abec14fe7fad", "placeholder": "\u200b", "style": "IPY_MODEL_393d53c3ca514010b2fcd4800107c8ef", "tabbable": null, "tooltip": null, "value": "100%"}}, "9654c81b22794215b8547dcfd1430a80": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5274c4ecedef49ae9a4219272b420cbe", "IPY_MODEL_7671adaa53d9403eb53aedbf3f43f1fd", "IPY_MODEL_8e311df9b75048958f409a6ec8c34fa7"], "layout": "IPY_MODEL_767b39f56eb047d8907a82aabe57ed47", "tabbable": null, "tooltip": null}}, "98168b8caa054aeeb8447d0e0c1019cb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_cb5163c6fc4145fdbe269e6b943dacfc", "IPY_MODEL_2cb22d58519e4cf88332ac26ef77e191", "IPY_MODEL_e2b9cd3f517e4da4ba1ba755be881c4d"], "layout": "IPY_MODEL_b2b4c3d9169941d0aca474b7e180920b", "tabbable": null, "tooltip": null}}, "99029cb5c0604b4f9c950f595032c56c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_8e2ba2507cd946ac9fe76355baea08ee", "IPY_MODEL_f4ec43dd392d479bb8de13ed596d6036", "IPY_MODEL_d9f142d3a7f44864a30557a74c3ecd0b"], "layout": "IPY_MODEL_01a9e011e6d14f1482c932e2f44b3a05", "tabbable": null, "tooltip": null}}, "9a9a1c2bc42c48988998bc73f2f6f395": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_db8dfdd2198d4702841fbfe26ec691f8", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_5eb1dbfec1c44ab4b5e737a636dd837c", "tabbable": null, "tooltip": null, "value": 4}}, "9b481149f1654dd3b4a33dd079410724": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3a0d676a14494f2ca7dafda578a0c7b0", "placeholder": "\u200b", "style": "IPY_MODEL_0f7662381c55418fa47fb758910e748a", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20075.23it/s]"}}, "9ba2ff54d6ee4e7281ab488017d96dfa": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9c3c190c36c741168d5d9e6834434575": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9d61fdde0ca04998a38436d7ee0c0c10": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9f27d9d985404662833b45db05ada62a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_528f88cdaa494dcdb135d6957736e299", "placeholder": "\u200b", "style": "IPY_MODEL_876b1cabe009455990acc25e8589d6c6", "tabbable": null, "tooltip": null, "value": "100%"}}, "9f8ff1c7140d420db775b8653d644cf9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9fee281c72e94d04b15986608899b3f1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_64c76e4117c4434c92215d50aa2d3980", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_d295e37ebe85495084eff54048a91fa4", "tabbable": null, "tooltip": null, "value": 4}}, "a1ddc8f84c2b4e7b91a95aa543d2227a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a36987b82da7405e88882c9a062b2be1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a834c2d1fb4748cea80945cd38531d1d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a9bf7c6c576144a9b3cd40343519b7fb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2953596ad8af4830a9f6b50872722977", "placeholder": "\u200b", "style": "IPY_MODEL_8b7118c50c414839a2adc3d7c1585584", "tabbable": null, "tooltip": null, "value": "100%"}}, "a9cc0afcd23346d28b555fac4b600427": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "aa9332bfb60a4304beffbd5e9f64aa36": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "abda0f25d35849cdbb53a97e6c5250af": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "afeeb367c77b4485b17df598e1013323": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_196ddd4e9ff846188be22ee5d4d9fdc8", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_bf28911ef4874c03bada443b4f290f1c", "tabbable": null, "tooltip": null, "value": 4}}, "b0a85852bb8b436285e60bd1964c5e58": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1a392e469414b138b87644ab68f8231": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b2b4c3d9169941d0aca474b7e180920b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b2ecef6e8a4949cb8483eeaf9bf65814": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b3abb6f2d3054ae08303765fa5f85f03": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b4de85c521fc4ad49212240871c74d89": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b2ecef6e8a4949cb8483eeaf9bf65814", "placeholder": "\u200b", "style": "IPY_MODEL_e6f4aa072f1a4204baaf062ecad3384e", "tabbable": null, "tooltip": null, "value": "100%"}}, "b524fc7bbae24382abf72ed9230eb5f1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b63c5dcc1cca435583b5ba2ed3cb6c0e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_128b3021e52045bfb79189ba7cac26dd", "IPY_MODEL_4c6ef65f264443ef90b8ff3abf91e29a", "IPY_MODEL_63df6edb19084aeb8c5c40b7d35f3b35"], "layout": "IPY_MODEL_06e431b57b4c42e98a53e4c0f7c285ae", "tabbable": null, "tooltip": null}}, "b924eeb8b87d43e1aeaa990be457fa0a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "bc8bad0c75dc45a887c01266b003a2f0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_42964137b3c54d388c04bca5668fd770", "IPY_MODEL_9fee281c72e94d04b15986608899b3f1", "IPY_MODEL_86a4fa4d0f334a529b025de140f93382"], "layout": "IPY_MODEL_c3eddec4fcfa42fab5217e68684e6c31", "tabbable": null, "tooltip": null}}, "bdd6601c5d86432296b00b451ab0b60d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bf28911ef4874c03bada443b4f290f1c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "bf32aff4d2054ba2ae467573f3cc544a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5ab0a6def9754e63b33a96b02079decd", "placeholder": "\u200b", "style": "IPY_MODEL_a9cc0afcd23346d28b555fac4b600427", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:01&lt;00:00,\u2007\u20071.87it/s]"}}, "bfd04bdc26f647b1a2961d66f0e5c2c5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d9c179c0cbb84d02abd8b39389ceb90f", "IPY_MODEL_9a9a1c2bc42c48988998bc73f2f6f395", "IPY_MODEL_6025cfa7228840619933b83c73e144dc"], "layout": "IPY_MODEL_11f3ddcadf4142f29267646927a3616d", "tabbable": null, "tooltip": null}}, "c0fe75ea92cb43a2bd5e64da4840ad94": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c22bf1b6a9e34feeb867abec14fe7fad": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c3439099f1b54588b3c812ed490a6060": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c3eddec4fcfa42fab5217e68684e6c31": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c7b7cb92127143b7a3dd556d223d6bca": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cb5163c6fc4145fdbe269e6b943dacfc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d209064cdc274affa1a3699a9eb4db91", "placeholder": "\u200b", "style": "IPY_MODEL_a834c2d1fb4748cea80945cd38531d1d", "tabbable": null, "tooltip": null, "value": "100%"}}, "cc2d41c9938c44cc82c3f16aaa4b3667": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9ba2ff54d6ee4e7281ab488017d96dfa", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_448723a572504393a0214c846f2c28ef", "tabbable": null, "tooltip": null, "value": 4}}, "cdec8951ed534051a3a2c6b6ffc43dc9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf2caf1d84c04ce998f5722fb2c4db8f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1622a83830c045d1a2f05c23b15d6431", "IPY_MODEL_4528ddfef46749f8922e11ade00f45f8", "IPY_MODEL_711964b1500145c983713f4e25cf93d7"], "layout": "IPY_MODEL_00db6a80c50d41b7b81330aa5bc43cb3", "tabbable": null, "tooltip": null}}, "d209064cdc274affa1a3699a9eb4db91": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d295e37ebe85495084eff54048a91fa4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "d322ca2ad2734677a4efe832b2184f2a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d4fae5de79fa49b992928d4fa4e3d12c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d61969114e004dd393fd1050b51d75f9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d75c3de0fcdf4aebb446b90f0afa98a0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d764b640de9a4780bcfa0a2105f98fc9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d9c179c0cbb84d02abd8b39389ceb90f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f6066a919d624c0e8174e73daa7a2918", "placeholder": "\u200b", "style": "IPY_MODEL_0887c3a2aa8947779affaa5b51bc67a9", "tabbable": null, "tooltip": null, "value": "100%"}}, "d9f142d3a7f44864a30557a74c3ecd0b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c3439099f1b54588b3c812ed490a6060", "placeholder": "\u200b", "style": "IPY_MODEL_1a2ca60babd34f41bc44c307a70b5d2f", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:03&lt;00:00,\u2007\u20071.27it/s]"}}, "da03fcee9df84dbcbbdaa1c4471f94bf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "dad989dd5d7c47f6a10ec7aa09d74d70": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f7a2f3c45bf04787bec011a81b8231d6", "placeholder": "\u200b", "style": "IPY_MODEL_0c60a9aec0d641e1b23845c91c73da43", "tabbable": null, "tooltip": null, "value": "100%"}}, "db8dfdd2198d4702841fbfe26ec691f8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd20256ebea44020927c53d5ab762f2f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d322ca2ad2734677a4efe832b2184f2a", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_39a7dbc6ff76406d8103542768aef236", "tabbable": null, "tooltip": null, "value": 4}}, "e049af5f846145dc8ca43123ac1a08e3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e2b9cd3f517e4da4ba1ba755be881c4d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6e2c9901b1d94cb2866d4903e12cac93", "placeholder": "\u200b", "style": "IPY_MODEL_e2e80e71e54549f5aba2258cb68d23d5", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:00&lt;00:00,\u2007\u20074.89it/s]"}}, "e2e80e71e54549f5aba2258cb68d23d5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "e4493afc7f934cd09a2b6485bb88865d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1ec02c6d487f45a5bf2fa89d01774ac6", "placeholder": "\u200b", "style": "IPY_MODEL_aa9332bfb60a4304beffbd5e9f64aa36", "tabbable": null, "tooltip": null, "value": "100%"}}, "e54969ee334b4324b69c81e1d336ad25": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e57d36f8fe444ed3950eed2a48545abc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_64b2ef2a4fed4535b18b1caea011b2c5", "IPY_MODEL_f4034db826d84d6580ca893e9fd6ae0b", "IPY_MODEL_8dc13dc88cbb4e87beecb79d64c938ee"], "layout": "IPY_MODEL_21100b4d827347ce9bc52fcf9b3e1c45", "tabbable": null, "tooltip": null}}, "e585a89d318842d08846b7af7837f037": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e6f4aa072f1a4204baaf062ecad3384e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f01cafd778574d07aabdbc115770119f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a1ddc8f84c2b4e7b91a95aa543d2227a", "placeholder": "\u200b", "style": "IPY_MODEL_a36987b82da7405e88882c9a062b2be1", "tabbable": null, "tooltip": null, "value": "100%"}}, "f0b479ebe5c240929460079309bfb61d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "f4034db826d84d6580ca893e9fd6ae0b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_39e327d7816e418885e99b1a94225810", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_8210d760e32c4499a53936455d36d4e7", "tabbable": null, "tooltip": null, "value": 4}}, "f4ec43dd392d479bb8de13ed596d6036": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d4fae5de79fa49b992928d4fa4e3d12c", "max": 4, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_f0b479ebe5c240929460079309bfb61d", "tabbable": null, "tooltip": null, "value": 4}}, "f6066a919d624c0e8174e73daa7a2918": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f7a2f3c45bf04787bec011a81b8231d6": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9b444a569af40fe8ccd2bcd7254245f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_964c7b129e2a400b8c06b580a2c561ba", "IPY_MODEL_36101bb7015143dc84004309cf6888fe", "IPY_MODEL_523a1093434a48509808f7c7e4e408fe"], "layout": "IPY_MODEL_5e2c3d221ccc48b38fff725cfa8342f9", "tabbable": null, "tooltip": null}}, "fb7293ef5c4a46cf92247ac9ea1f1204": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "fd0c80ac97d24194b047899bf7a01a5e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_28a306bec0a84e1cbaa3743a6797ea7e", "placeholder": "\u200b", "style": "IPY_MODEL_665d3e262b494404bdcafd01b142a781", "tabbable": null, "tooltip": null, "value": "\u20074/4\u2007[00:02&lt;00:00,\u2007\u20071.63it/s]"}}, "fe7678ba408441df8ae9f664bfce5ed5": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_notebooks/ARIMA_SARIMA_XGBoost';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Face Detection" href="OpenCV.html" />
    <link rel="prev" title="About Dataset And Features:" href="LSTM_GRU_DeepAR_notebook.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/profile.png" class="logo__image only-light" alt="Veri Bilimi Portfolyosu - Home"/>
    <script>document.write(`<img src="../_static/profile.png" class="logo__image only-dark" alt="Veri Bilimi Portfolyosu - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Veri Bilimi Portfolyom/Anasayfa
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bike-shares-data-viz-notebook.html"><span style=" color:red">WELCOME!</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="energy_supply_and_demand_optimisation.html"><em><strong>Energy Supply and Demand Optimisation: Mathematical Modelling Using <strong>Gurobi Python</strong></strong></em></a></li>
<li class="toctree-l1"><a class="reference internal" href="CNN_Notebook_1_CNN_complex.html">Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="LSTM_GRU_DeepAR_notebook.html"><em><strong>About Dataset And Features:</strong></em></a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#"><u> <p style="text-indent:30px; text-align:center;"><strong>Household Electric Power Consumption Forecasting</strong></p></u></a></li>






<li class="toctree-l1"><a class="reference internal" href="OpenCV.html">Face Detection</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/kullaniciadi/ds_portfolio/blob/master/_notebooks/ARIMA_SARIMA_XGBoost.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/kullaniciadi/ds_portfolio" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_notebooks/ARIMA_SARIMA_XGBoost.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><u> <p style="text-indent:30px; text-align:center;">Household Electric Power Consumption Forecasting</p></u></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><u> <p style="text-indent:30px; text-align:center;"><strong>Household Electric Power Consumption Forecasting</strong></p></u></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-dataset-and-features"><em><strong>About Dataset And Features:</strong></em><br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notes"><em><strong>Notes:</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#features"><em><strong><u>Features:</u></strong></em> <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries"><strong>1.Import Libraries:</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data"><em><strong>2.Reading Data</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#change-all-column-names-to-lowercase"><strong>Change all column names to lowercase</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-values-nan-with-a-test-statistic"><em><strong>Dealing with missing values  nan with a test statistic</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-and-analyzing-values-feature-by-feature"><em><strong>3. Data visualization and analyzing values feature by feature</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dt-dates-and-time">3.1 dt (Dates and time)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-active-power-kw">3.2 Global_Active_Power[kw]:<br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#above-i-resampled-data-over-day-and-show-the-sum-and-mean-of-global-active-power-it-is-seen-that-mean-and-sum-of-resampled-dataset-have-similar-behaviour">Above I resampled data over day, and show the sum and mean of Global_active_power. It is seen that mean and sum of resampled dataset, have similar behaviour.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-with-moving-average">Trend Analysis with Moving Average</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-graph-displays-daily-total-active-power-consumption-blue-line-and-its-30-day-moving-average-red-line-for-smoothing-fluctuations">This graph displays daily total active power consumption (blue line) and its 30-day moving average (red line) for smoothing fluctuations.<br/></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-decomposition"><strong>Seasonal Decomposition</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-very-important-to-note-from-above-plots-that-resampling-over-larger-time-inteval-will-diminish-the-periodicity-of-system-as-we-expect-this-is-important-for-machine-learning-feature-engineering">It is very important to note from above plots that resampling over larger time inteval, will diminish the periodicity of system as we expect. This is important for machine learning feature engineering.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-reactive-power-kw">3.3 Global_reactive_power[kw]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-intensity-ampere">3.4 Global_intensity[Ampere]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voltage-v">3.5 Voltage[ V ]:<br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-seen-from-the-above-plots-that-the-mean-of-volage-over-month-is-pretty-much-constant-compared-to-other-features-this-is-important-again-in-feature-selection">It is seen from the above plots that the mean of Volage over month is pretty much constant compared to other features. This is important again in feature selection.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-1-wh">3.6 Sub_metering_1[WH]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-2-wh">3.7 Sub_metering_2[WH]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-3-wh">3.8 Sub_metering_3[WH]:<br/></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations-among-features"><em><strong>4.Correlations among features</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-above-two-plots-it-is-seen-that-global-intensity-and-global-active-power-correlated-but-voltage-global-active-power-are-less-correlated-this-is-important-observation-for-machine-learning-purpose">From above two plots it is seen that Global_intensity and Global_active_power correlated. But Voltage, Global_active_power are less correlated. This is important observation for machine learning purpose.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-seen-from-above-that-with-resampling-techniques-one-can-change-the-correlations-among-features-this-is-important-for-feature-engineering"><em><strong>It is seen from above that with resampling techniques one can change the correlations among features. This is important for feature  engineering.</strong></em></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling"><em><strong>5.MODELING</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-preparation">5.1. Model Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-and-adding-power-factor"><em><strong><em>5.1.1. Calculating and Adding Power Factor</em></strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-power-factor">What is Power Factor?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where">Where:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-the-picture-below">Look at the picture below <br/></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-power-factor-important">Why is Power Factor Important?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-want-to-do-the-trend-and-seasonal-decomposition-analyses-that-i-did-for-global-active-power-in-the-previous-sections-for-the-power-factor-here"><strong>I want to do the trend and seasonal decomposition analyses that I did forglobal_active_power in the previous sections for the power factor here.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-factor-time-series-decomposition-in-detail"><em><strong>Power Factor time series decomposition in detail:</strong></em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection"><em><strong>5.2. Model Selection:</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-sarima-models"><em><strong>5.2.1.ARIMA/SARIMA MODELS</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-stationarity"><em><strong>5.2.1.1.Checking Stationarity:</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adf-and-kpss"><em><strong>ADF and KPSS</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tests-we-performed-showed-that-all-the-features-were-stationary-but-if-they-were-not-stationary-we-would-have-to-apply-the-following-methods"><em><strong>The tests we performed showed that all the features were stationary, but if they were not stationary, we would have to apply the following methods.</strong></em><br/><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-sarima-model-implementation"><em><strong>5.2.1.2.ARIMA/SARIMA Model Implementation:</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#of-course-this-is-not-a-result-to-be-taken-seriously"><em><strong>Of course, this is not a result to be taken seriously.</strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prophet-model"><em><strong>5.2.2.Prophet Model</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zoom-in-on-estimated-time-range-this-prophet-forecast-chart-shows-the-actual-and-forecast-values-of-the-time-series-in-the-test-period-year-2010"><em><strong>zoom in on estimated time range: This Prophet forecast chart shows the actual and forecast values of the time series in the test period (year 2010)</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-features-did-not-contribute-to-the-model"><em><strong>Adding features did not contribute to the model</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-to-capture-the-best-parameters-for-prophet"><em><strong>Cross validation to capture the best parameters for Prophet</strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost"><em><strong>5.2.3.XGBoost</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-with-daily-data"><em><strong>XgBoost with daily data</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><em><strong>Conclusion:</strong></em></a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This Python 3 environment comes with many helpful analytics libraries installed</span>
<span class="c1"># It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python</span>
<span class="c1"># For example, here&#39;s several helpful packages to load</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1"># linear algebra</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span> <span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv)</span>

<span class="c1"># Input data files are available in the read-only &quot;../input/&quot; directory</span>
<span class="c1"># For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;/kaggle/input&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>

<span class="c1"># You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using &quot;Save &amp; Run All&quot; </span>
<span class="c1"># You can also write temporary files to /kaggle/temp/, but they won&#39;t be saved outside of the current session</span>
</pre></div>
</div>
</div>
</div>
<section id="household-electric-power-consumption-forecasting">
<h1><u> <p style="text-indent:30px; text-align:center;"><strong>Household Electric Power Consumption Forecasting</strong></p></u><a class="headerlink" href="#household-electric-power-consumption-forecasting" title="Link to this heading">#</a></h1>
<p style="text-indent:30px;"> The real energy demand made on the present electrical supply is referred to as electric energy consumption. However, poor management of its use can result in a reduction in electrical supply. As a result, it is critical that everyone be concerned about energy efficiency in order to reduce consumption. The goals of this study are to develop a model for <strong>forecasting household electricity usage</strong> and to determine the best forecasting period, which could be daily, weekly, monthly, or quarterly. Individual household electricity power usage is the time-series data in our investigation.This Notebook use Deep Learning and time-series data analysis methods for this aim.<br></p>
<p style="text-indent:30px;">Any household requires electricity to function. In this period of global instability, the globe requires rising amounts of energy to maintain economic and social progress and improve living standards. Mishandling of electric energy could result in future excessive costs. Over 60% of residential energy in the United States is wasted. Many people who use power on a regular basis are unaware of how much energy is wasted. The monthly electricity usage is predicted using a forecasting tool.In this notebook series I want to use <strong>Prophet  Facebook, ARIMA (Autoregressive Integrated Moving Average), XGBoost/LightGBM, LSTM (Long Short Term Memory), DeepAR (Amazon time series model),TimeGPT (TimeGPT is a production-ready, generative, pre-trained transformer-GPT model developed by Nixtla for time series data), which is quite efficient for time series examples like ours.<section id="about-dataset-and-features">
<h2><em><strong>About Dataset And Features:</strong></em><br><a class="headerlink" href="#about-dataset-and-features" title="Link to this heading">#</a></h2>
<p>The Household Power Consumption dataset is a multivariate time series dataset that describes the electricity consumption for a single household over four years from December 2006 to November 2010. The observations were collected every minute.Measurements of electric power consumption in one household with a one-minute sampling rate over a period of almost 4 years. Different electrical quantities and some sub-metering values are available.This archive contains    2.075.259 measurements gathered in a house located in Sceaux (7km of Paris, France) between December 2006 and November 2010 (47 months).<br></p>
<p><em><strong><u>Data Set Characteristics:</u></strong></em><br><br>
Multivariate, Time-Series<br></p>
<p>This archive contains 2.075.259 measurements gathered between December 2006 and November 2010 (47 months).<br><br></p>
<section id="notes">
<h3><em><strong>Notes:</strong></em><br><a class="headerlink" href="#notes" title="Link to this heading">#</a></h3>
<p>1.(global_active_power*1000/60 - sub_metering_1 - sub_metering_2 - sub_metering_3) represents the active energy consumed every minute (in watt hour) in the household by electrical equipment not measured in sub-meterings 1, 2 and 3.<br></p>
<p>2.The dataset contains some missing values in the measurements (nearly 1,25% of the rows). All calendar timestamps are present in the dataset but for some timestamps, the measurement values are missing: a missing value is represented by the absence of value between two consecutive semi-colon attribute separators. For instance, the dataset shows missing values on April 28, 2007.<br><br></p>
</section>
<section id="features">
<h3><em><strong><u>Features:</u></strong></em> <br><a class="headerlink" href="#features" title="Link to this heading">#</a></h3>
<p><em><strong>1.date:</strong></em> Date in format dd/mm/yyyy</p>
<p><em><strong>2.time:</strong></em> time in format hh:mm:ss</p>
<p><em><strong>3.global_active_power:</strong></em> household global minute-averaged active power (in kilowatt), It is the power that is actually consumed by an appliance averaged per minute</p>
<p><em><strong>4.global_reactive_power:</strong></em> household global minute-averaged reactive power (in kilowatt), It is the Imaginary power that is not consumed by an appliance averaged per minute.</p>
<p><em><strong>5.voltage:</strong></em> minute-averaged voltage (in volt)</p>
<p><em><strong>6.global_intensity:</strong></em> household global minute-averaged current intensity (in ampere)</p>
<p><em><strong>7.sub_metering_1:</strong></em> energy sub-metering No. 1 (in watt-hour of active energy). It corresponds to the kitchen, containing mainly a dishwasher, an oven and a microwave (hot plates are not electric but gas powered).</p>
<p><em><strong>8.sub_metering_2:</strong></em> energy sub-metering No. 2 (in watt-hour of active energy). It corresponds to the laundry room, containing a washing-machine, a tumble-drier, a refrigerator and a light.</p>
<p><em><strong>9.sub_metering_3:</strong></em> energy sub-metering No. 3 (in watt-hour of active energy). It corresponds to an electric water-heater and an air-conditioner.</p>
</section>
</section>
</section>
<section id="import-libraries">
<h1><strong>1.Import Libraries:</strong><a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let`s import all packages that we may need:</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1"># linear algebra</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span> <span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv), data manipulation as in SQL</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> <span class="c1"># this is used for the plot the graph</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span> <span class="c1"># used for plot interactive graph.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span> <span class="c1"># use for cross validation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span> <span class="c1"># for normalization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span> <span class="c1"># pipeline making</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectFromModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span> <span class="c1"># for the check the error and accuracy of the model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span><span class="n">r2_score</span>

<span class="c1">## for Deep-learing:</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.optimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SGD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">LSTM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Conv1D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaxPooling1D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dropout</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-data">
<h1><em><strong>2.Reading Data</strong></em><a class="headerlink" href="#reading-data" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/electric-power-consumption-data-set/household_power_consumption.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                 <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">]},</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>

<span class="c1"># 1) Note that data include &#39;nan&#39; and &#39;?&#39; as a string. I converted both to numpy nan in importing stage (above) and treated both of them the same.&lt;br&gt;</span>
<span class="c1"># 2) I merged two columns &#39;Date&#39; and &#39;Time&#39; to &#39;dt&#39;. &lt;br&gt;</span>
<span class="c1"># 3) I also converted in the above, the data to time-series type, by taking index to be the time.&lt;br&gt; </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/electric-power-consumption-data-set/household_power_consumption.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                  <span class="n">parse_dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">]},</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                  <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\anaconda3\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/kaggle/input/electric-power-consumption-data-set/household_power_consumption.txt&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Global_active_power</th>
      <th>Global_reactive_power</th>
      <th>Voltage</th>
      <th>Global_intensity</th>
      <th>Sub_metering_1</th>
      <th>Sub_metering_2</th>
      <th>Sub_metering_3</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>4.216</td>
      <td>0.418</td>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>5.360</td>
      <td>0.436</td>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>5.374</td>
      <td>0.498</td>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>5.388</td>
      <td>0.502</td>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>3.666</td>
      <td>0.528</td>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Global_active_power</th>
      <th>Global_reactive_power</th>
      <th>Voltage</th>
      <th>Global_intensity</th>
      <th>Sub_metering_1</th>
      <th>Sub_metering_2</th>
      <th>Sub_metering_3</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-11-26 20:58:00</th>
      <td>0.946</td>
      <td>0.0</td>
      <td>240.43</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2010-11-26 20:59:00</th>
      <td>0.944</td>
      <td>0.0</td>
      <td>240.00</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2010-11-26 21:00:00</th>
      <td>0.938</td>
      <td>0.0</td>
      <td>239.82</td>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2010-11-26 21:01:00</th>
      <td>0.934</td>
      <td>0.0</td>
      <td>239.70</td>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2010-11-26 21:02:00</th>
      <td>0.932</td>
      <td>0.0</td>
      <td>239.55</td>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
      <th>global_reactive_power</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2008-07-01 21:50:00</th>
      <td>2.456</td>
      <td>0.368</td>
      <td>237.27</td>
      <td>10.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>2007-02-03 07:35:00</th>
      <td>2.380</td>
      <td>0.000</td>
      <td>241.43</td>
      <td>9.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-04-03 02:21:00</th>
      <td>0.350</td>
      <td>0.050</td>
      <td>243.21</td>
      <td>1.6</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2008-04-04 19:05:00</th>
      <td>0.210</td>
      <td>0.000</td>
      <td>238.31</td>
      <td>0.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2009-07-08 05:52:00</th>
      <td>0.660</td>
      <td>0.270</td>
      <td>242.14</td>
      <td>3.2</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="change-all-column-names-to-lowercase">
<h2><strong>Change all column names to lowercase</strong><a class="headerlink" href="#change-all-column-names-to-lowercase" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;global_active_power&#39;, &#39;global_reactive_power&#39;, &#39;voltage&#39;,
       &#39;global_intensity&#39;, &#39;sub_metering_1&#39;, &#39;sub_metering_2&#39;,
       &#39;sub_metering_3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">show_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># &quot;show_counts&quot; is for showing the non-null counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 2075259 entries, 2006-12-16 17:24:00 to 2010-11-26 21:02:00
Data columns (total 7 columns):
 #   Column                 Non-Null Count    Dtype  
---  ------                 --------------    -----  
 0   global_active_power    2049280 non-null  float64
 1   global_reactive_power  2049280 non-null  float64
 2   voltage                2049280 non-null  float64
 3   global_intensity       2049280 non-null  float64
 4   sub_metering_1         2049280 non-null  float64
 5   sub_metering_2         2049280 non-null  float64
 6   sub_metering_3         2049280 non-null  float64
dtypes: float64(7)
memory usage: 126.7 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> rows, </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset shape: 2,075,259 rows, 7 columns
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;global_active_power&#39;, &#39;global_reactive_power&#39;, &#39;voltage&#39;,
       &#39;global_intensity&#39;, &#39;sub_metering_1&#39;, &#39;sub_metering_2&#39;,
       &#39;sub_metering_3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">summarytools</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting summarytools
  Downloading summarytools-0.3.0-py3-none-any.whl.metadata (3.5 kB)
Requirement already satisfied: pandas&gt;=1.4.0 in /usr/local/lib/python3.10/dist-packages (from summarytools) (2.2.3)
Requirement already satisfied: ipython&gt;=7.20.0 in /usr/local/lib/python3.10/dist-packages (from summarytools) (7.34.0)
Requirement already satisfied: numpy&gt;=1.18.5 in /usr/local/lib/python3.10/dist-packages (from summarytools) (1.26.4)
Requirement already satisfied: matplotlib&gt;=3.3.0 in /usr/local/lib/python3.10/dist-packages (from summarytools) (3.7.5)
Requirement already satisfied: setuptools&gt;=18.5 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (75.1.0)
Requirement already satisfied: jedi&gt;=0.16 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (0.19.2)
Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (4.4.2)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (0.7.5)
Requirement already satisfied: traitlets&gt;=4.2 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (5.7.1)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (3.0.48)
Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (2.19.1)
Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (0.2.0)
Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (0.1.7)
Requirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=7.20.0-&gt;summarytools) (4.9.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (4.55.3)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (1.4.7)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (24.2)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (11.0.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (3.2.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.3.0-&gt;summarytools) (2.9.0.post0)
Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (1.3.8)
Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (1.2.4)
Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (0.1.1)
Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (2025.0.1)
Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (2022.0.0)
Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.18.5-&gt;summarytools) (2.4.1)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.4.0-&gt;summarytools) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.4.0-&gt;summarytools) (2025.1)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.4 in /usr/local/lib/python3.10/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=7.20.0-&gt;summarytools) (0.8.4)
Requirement already satisfied: ptyprocess&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect&gt;4.3-&gt;ipython&gt;=7.20.0-&gt;summarytools) (0.7.0)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython&gt;=7.20.0-&gt;summarytools) (0.2.13)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.3.0-&gt;summarytools) (1.17.0)
Requirement already satisfied: intel-openmp&gt;=2024 in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.18.5-&gt;summarytools) (2024.2.0)
Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.18.5-&gt;summarytools) (2022.0.0)
Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*-&gt;mkl-&gt;numpy&gt;=1.18.5-&gt;summarytools) (1.2.0)
Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath-&gt;numpy&gt;=1.18.5-&gt;summarytools) (2024.2.0)
Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp&gt;=2024-&gt;mkl-&gt;numpy&gt;=1.18.5-&gt;summarytools) (2024.2.0)
Downloading summarytools-0.3.0-py3-none-any.whl (12 kB)
Installing collected packages: summarytools
Successfully installed summarytools-0.3.0
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">summarytools</span><span class="w"> </span><span class="kn">import</span> <span class="n">dfSummary</span> <span class="c1"># for summary of the data</span>

<span class="n">dfSummary</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_3c065 thead>tr>th {
  text-align: left;
}
#T_3c065_row0_col0, #T_3c065_row1_col0, #T_3c065_row2_col0, #T_3c065_row3_col0, #T_3c065_row4_col0, #T_3c065_row5_col0, #T_3c065_row6_col0 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 5%;
  max-width: 50px;
  min-width: 20px;
}
#T_3c065_row0_col1, #T_3c065_row1_col1, #T_3c065_row2_col1, #T_3c065_row3_col1, #T_3c065_row4_col1, #T_3c065_row5_col1, #T_3c065_row6_col1 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 15%;
  max-width: 200px;
  min-width: 100px;
  word-break: break-word;
}
#T_3c065_row0_col2, #T_3c065_row1_col2, #T_3c065_row2_col2, #T_3c065_row3_col2, #T_3c065_row4_col2, #T_3c065_row5_col2, #T_3c065_row6_col2 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 30%;
  min-width: 100px;
}
#T_3c065_row0_col3, #T_3c065_row1_col3, #T_3c065_row2_col3, #T_3c065_row3_col3, #T_3c065_row4_col3, #T_3c065_row5_col3, #T_3c065_row6_col3 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 25%;
  min-width: 100px;
}
#T_3c065_row0_col4, #T_3c065_row1_col4, #T_3c065_row2_col4, #T_3c065_row3_col4, #T_3c065_row4_col4, #T_3c065_row5_col4, #T_3c065_row6_col4 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 20%;
  min-width: 150px;
}
#T_3c065_row0_col5, #T_3c065_row1_col5, #T_3c065_row2_col5, #T_3c065_row3_col5, #T_3c065_row4_col5, #T_3c065_row5_col5, #T_3c065_row6_col5 {
  text-align: left;
  font-size: 12px;
  vertical-align: middle;
  width: 10%;
}
</style>
<table id="T_3c065">
  <caption><strong>Data Frame Summary</strong><br>df<br>Dimensions: 2,075,259 x 7<br>Duplicates: 168,560</caption>
  <thead>
    <tr>
      <th id="T_3c065_level0_col0" class="col_heading level0 col0" >No</th>
      <th id="T_3c065_level0_col1" class="col_heading level0 col1" >Variable</th>
      <th id="T_3c065_level0_col2" class="col_heading level0 col2" >Stats / Values</th>
      <th id="T_3c065_level0_col3" class="col_heading level0 col3" >Freqs / (% of Valid)</th>
      <th id="T_3c065_level0_col4" class="col_heading level0 col4" >Graph</th>
      <th id="T_3c065_level0_col5" class="col_heading level0 col5" >Missing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_3c065_row0_col0" class="data row0 col0" >1</td>
      <td id="T_3c065_row0_col1" class="data row0 col1" ><strong>global_active_power</strong><br>[float64]</td>
      <td id="T_3c065_row0_col2" class="data row0 col2" >Mean (sd) : 1.1 (1.1)<br>min < med < max:<br>0.1 < 0.6 < 11.1<br>IQR (CV) : 1.2 (1.0)</td>
      <td id="T_3c065_row0_col3" class="data row0 col3" >4,186 distinct values</td>
      <td id="T_3c065_row0_col4" class="data row0 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACDUlEQVR4nO3czUoCURyG8f/JkjFpBhF05yW0cOlFdLFt23stIkiOOGnKcNpkBFHqOVjznp7f2jmKPPgFvs57b0DTXf31AwBOcX3sBs65jpm1A8/fee83gdcCH34M1TnX6ff7D3me90IOX61Wz865R2JFrGOvqO08z3uTyWRTFMX2nIPLssym02lvsVi0zYxQEeXoW7+ZWVEU28Fg8BJwfifgGuALvkxBAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCAqFCwklrfqHqur4xs9w5F3oEQ8AwswuGWlXVzX6/vx+NRq1Wq3XWtuoBQ8A4uFiou93uOsuy2/F4vB0Oh8/nXs8QMD676Fu/mVm32w0dATZjCBjv+DIFCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCRf/u3SMyKUVVlYS0thQY5dWWFlJS2NDjVlaYWUlPY0N9SBiaYWVlYQ0PtRQLAmmJclQWRJMT5KhsiSYniRDPYhZEqzrOjd+GmuMk0ItyzI79+D1ep2ZmVVVlc3n89vfvD72vmez2V3MR4flcrl2zj2ZWdDHjn/q1Xv/7fP1Bhrv0Yey/P5JAAAAAElFTkSuQmCC"></img></td>
      <td id="T_3c065_row0_col5" class="data row0 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row1_col0" class="data row1 col0" >2</td>
      <td id="T_3c065_row1_col1" class="data row1 col1" ><strong>global_reactive_power</strong><br>[float64]</td>
      <td id="T_3c065_row1_col2" class="data row1 col2" >Mean (sd) : 0.1 (0.1)<br>min < med < max:<br>0.0 < 0.1 < 1.4<br>IQR (CV) : 0.1 (1.1)</td>
      <td id="T_3c065_row1_col3" class="data row1 col3" >532 distinct values</td>
      <td id="T_3c065_row1_col4" class="data row1 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAB+0lEQVR4nO3dwWrCQBRG4TuNSlSaIILufIQuXPoQfdhuu/dZRJAaSaqNyHRTS6G0mgm2+cP51s4gckgIeDPOe29A09399xcArtG59AHnXN/MeoH7l977feBa4NOvoTrn+uPx+DFJklHI5rvd7sU590SsqOvSFbWXJMlosVjs0zQ9VNk4y7J4uVyONptNz8wIFbVcvPWbmaVpephMJq8B+/cD1gDf8DAFCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCYQKCVedihLqdDp1zSxxzoVuwYFqMLMbhloURfd4PD7MZrMoiqJKZ1SdcaAazm4WalmWnTiOB/P5/DCdTl+qrudANXx101u/mdlwOAw9TM2MA9XwgYcpSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSCBUSLj5/1HrqDnKwhhLizQ21LqjLIyxtEtjQ60zysIYS/s0NtSzGqMsjLG0CA9TkECokND4W38oXn7RLleFmmVZXHXjPM9jM7OiKOL1ej34y/Wr1eq+7ssvtttt7px7NrOg9ajszXv/42/9Drbxn/IYp9qqAAAAAElFTkSuQmCC"></img></td>
      <td id="T_3c065_row1_col5" class="data row1 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row2_col0" class="data row2 col0" >3</td>
      <td id="T_3c065_row2_col1" class="data row2 col1" ><strong>voltage</strong><br>[float64]</td>
      <td id="T_3c065_row2_col2" class="data row2 col2" >Mean (sd) : 240.8 (3.2)<br>min < med < max:<br>223.2 < 241.0 < 254.2<br>IQR (CV) : 3.9 (74.3)</td>
      <td id="T_3c065_row2_col3" class="data row2 col3" >2,837 distinct values</td>
      <td id="T_3c065_row2_col4" class="data row2 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACqElEQVR4nO3dMW/aQBiA4e9KIDYgA6KBjZWhEgMjP6I/tj+hAysLKxObhUFGuBDAuFOltkra2IZw3+V99gun6CWKxXecybJMANt9uvcGgLd4uPcGXGSM8UWkVnD5Mcuy/TX34wJCvTJjjN/tdr8GQdApsn673W6MMd+I9U+Een21IAg6k8lk32q1DnkWxnHsTafTThRFNREh1N8Q6o20Wq1Dr9f7UWCpf/XNOICHKahAqFCBUKECoUIFQoUKhAoVCBUqECpUIFSoQKhQgVChAp/1WyZN06qIBMaYoj/CyTFBQrVIkiTV0+k0GgwGlUqlkmvy6hdXxwQJ1SLH4/HB87z6eDw+9Pv9Td71Lo8JEqqFGo1G0RFBEUfHBHmYggqEChUIFSoQKlQgVKhAqFCBUKECoUIFQoUKhAoVCBUqECpUIFSoQKhQgVChAqFCBUKFCoQKFQgVKhAqVOBw3ytKXMETXC6X6rX389ER6gvKXMFzOp28NE2/HA6H7yJS9CQp/kKoLyt8Bc9yuezM5/P6+Xyu3GpzHxGh/kORK3g2m42T5+rvjYcpqECoUIFQoQKhQgVChQqEChUIFSoQKlQgVKhAqFCBj1AdU/JWFWtvVCFUh5S9VcXmG1UI1SFlblWx/UYVQnVQiVtVrJ384mEKKjj7F7XEURIRjpNYx8lQyxwlEeE4iY2cDFVKHCUR4TiJjVwNVUSKHSUR4TiJjXiYggqEChUIFSpY/T8q31byvkrOCYjccFbA2lD5tpL3VXZOQOS2swL/DdUY44nI47Vf+A2CZrP5NBqNzr7vP+dZuFqtvMViUY/juBGG4THvC+92O09EJEkSLwzDuoa1Zdev1+um53n14XBo2u12rt+3iMh+v3+czWZPURR9NsZs864Xkecsy159g/wE91gbHrzETTUAAAAASUVORK5CYII="></img></td>
      <td id="T_3c065_row2_col5" class="data row2 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row3_col0" class="data row3 col0" >4</td>
      <td id="T_3c065_row3_col1" class="data row3 col1" ><strong>global_intensity</strong><br>[float64]</td>
      <td id="T_3c065_row3_col2" class="data row3 col2" >Mean (sd) : 4.6 (4.4)<br>min < med < max:<br>0.2 < 2.6 < 48.4<br>IQR (CV) : 5.0 (1.0)</td>
      <td id="T_3c065_row3_col3" class="data row3 col3" >221 distinct values</td>
      <td id="T_3c065_row3_col4" class="data row3 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACFElEQVR4nO3cwWriUBiG4f8fW4kVEsRBd15CFy69iF5st7MUvBgh1IhprCKnm1oKpVVP6ky+zPusew5SXiJZ+HkIwYCm+/WvPwBwjptTf+DuPTPrRt6/CyFUkWeBd9+G6u694XD4kKbpIOby9Xr95O6PxIq6Tj1Ru2maDmazWZVl2faSi4uiSBaLxSDP866ZESpqOfnVb2aWZdl2NBo9R9zfizgDfMLLFCQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiScNTsZ63A43JpZ6u6xV7BYDTO7YqhlWd7u9/v7yWTS6XQ6F40AH7FYjaOrhbrb7W6SJLmbTqfb8Xj8dOl5Fqvx0VW/+s3M+v1+7Fq1GYvVeMPLFCQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiQQKiRc/VeoddQcsGC8okUaG2rdAQvGK9qlsaHWGbBgvKJ9GhvqUY0BC8YrWoSXKUho/BM1FkuC7dLKUFkSbJ9WhvoTS4Lz+XyU5/lvd1/HfAQC/1lnhVoURXLpxZvNJjEzK8syWS6Xd3/z/PFsrKqqaj2RV6vVxt3/mFnU0/w/9RJC+PL/9Qr7X8ac7lpX3AAAAABJRU5ErkJggg=="></img></td>
      <td id="T_3c065_row3_col5" class="data row3 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row4_col0" class="data row4 col0" >5</td>
      <td id="T_3c065_row4_col1" class="data row4 col1" ><strong>sub_metering_1</strong><br>[float64]</td>
      <td id="T_3c065_row4_col2" class="data row4 col2" >Mean (sd) : 1.1 (6.2)<br>min < med < max:<br>0.0 < 0.0 < 88.0<br>IQR (CV) : 0.0 (0.2)</td>
      <td id="T_3c065_row4_col3" class="data row4 col3" >88 distinct values</td>
      <td id="T_3c065_row4_col4" class="data row4 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABlklEQVR4nO3XwYoaQRSG0aogohC6UMGHcT/bPGy22fs2EltCNANS2WUTEseeAedPzln3vVyajxZr773Ae/fh0QfAS8xuPVBrXZZS5hP3P/fezxNn4Ze/hlprXW42m0/DMKymLD+dTl9rrZ/Fymvd+qLOh2FY7Xa7c2vtcs/icRwX+/1+dTgc5qUUofIqN3/6SymltXbZbrffJ+xfTpiB3/gzRQShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEmH26APeq1rrspQynzj+3Hs/v+U9/7sXhTqO4+LexeM4Lq7X66yUMtRa7z7swRbr9fqptfZxyvDxePxWa/1SSrm88V3/sh+99z++r5+4pTkqDNk+xwAAAABJRU5ErkJggg=="></img></td>
      <td id="T_3c065_row4_col5" class="data row4 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row5_col0" class="data row5 col0" >6</td>
      <td id="T_3c065_row5_col1" class="data row5 col1" ><strong>sub_metering_2</strong><br>[float64]</td>
      <td id="T_3c065_row5_col2" class="data row5 col2" >Mean (sd) : 1.3 (5.8)<br>min < med < max:<br>0.0 < 0.0 < 80.0<br>IQR (CV) : 1.0 (0.2)</td>
      <td id="T_3c065_row5_col3" class="data row5 col3" >81 distinct values</td>
      <td id="T_3c065_row5_col4" class="data row5 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABlklEQVR4nO3XwYoaQRSG0aogohC6UMGHcT/bPGy22fs2EltCNANS2WUTEseeAedPzln3vVyajxZr773Ae/fh0QfAS8xuPVBrXZZS5hP3P/fezxNn4Ze/hlprXW42m0/DMKymLD+dTl9rrZ/Fymvd+qLOh2FY7Xa7c2vtcs/icRwX+/1+dTgc5qUUofIqN3/6SymltXbZbrffJ+xfTpiB3/gzRQShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEkGoRBAqEYRKBKESQahEECoRhEoEoRJBqEQQKhGESgShEmH26APeq1rrspQynzj+3Hs/v+U9/7sXhTqO4+LexeM4Lq7X66yUMtRa7z7swRbr9fqptfZxyvDxePxWa/1SSrm88V3/sh+99z++r5+4pTkqDNk+xwAAAABJRU5ErkJggg=="></img></td>
      <td id="T_3c065_row5_col5" class="data row5 col5" >25,979<br>(1.3%)</td>
    </tr>
    <tr>
      <td id="T_3c065_row6_col0" class="data row6 col0" >7</td>
      <td id="T_3c065_row6_col1" class="data row6 col1" ><strong>sub_metering_3</strong><br>[float64]</td>
      <td id="T_3c065_row6_col2" class="data row6 col2" >Mean (sd) : 6.5 (8.4)<br>min < med < max:<br>0.0 < 1.0 < 31.0<br>IQR (CV) : 17.0 (0.8)</td>
      <td id="T_3c065_row6_col3" class="data row6 col3" >32 distinct values</td>
      <td id="T_3c065_row6_col4" class="data row6 col4" ><img src = "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAKoAAABGCAYAAABc8A97AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/xnp5ZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACIklEQVR4nO3dsY7aQBRG4TuBJeMF2QKy0PEIFJT0afOweQha3gPJWhnhmECMUyVNpIDHWOvfOl/NDAgdGSxxGVdVlQFd9+mjXwDwiOG9BzjnIjMbBe5/qaqqCFwL/PXfUJ1z0Xw+/xbH8TRk8+Px+O6c+06saOreFXUUx/F0u90WSZKc62ycZZnf7XbTNE1HZkaoaOTuR7+ZWZIk58Vi8SNg/yhgDfAPbqYggVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAhgVAh4aFTUVAPh8g9H6E+GYfItYNQn49D5FpAqC3hELnn4mYKEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEggVEvjhdMeUZfliZrFzLnSLXs5cEWqH5Hn+cr1e16vVajAYDGqNsfzR15krQu2Qy+Uy9N6/bjab83K5fK+7vs8zV4TaQePxOHTeyqynM1e9DbXhbL1ZT7/rqeplqE1n6836+12vTW3+8cZDoWZZ5us+a5ZlvizLoTW7gw0VTyaTt/V6/SuKop91FxdF8Xm/37+lafrFOXes+9y3220Y8p6dTidvZpbnuT8cDq9113/we+5ns9nXJEkmIYvvXRh+A3nfq6kH9rjDAAAAAElFTkSuQmCC"></img></td>
      <td id="T_3c065_row6_col5" class="data row6 col5" >25,979<br>(1.3%)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;df - Number of duplicate Record: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df - Number of duplicate Record: 168,560
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>global_active_power</th>
      <td>2049280.0</td>
      <td>1.091615</td>
      <td>1.057294</td>
      <td>0.076</td>
      <td>0.308</td>
      <td>0.602</td>
      <td>1.528</td>
      <td>11.122</td>
    </tr>
    <tr>
      <th>global_reactive_power</th>
      <td>2049280.0</td>
      <td>0.123714</td>
      <td>0.112722</td>
      <td>0.000</td>
      <td>0.048</td>
      <td>0.100</td>
      <td>0.194</td>
      <td>1.390</td>
    </tr>
    <tr>
      <th>voltage</th>
      <td>2049280.0</td>
      <td>240.839858</td>
      <td>3.239987</td>
      <td>223.200</td>
      <td>238.990</td>
      <td>241.010</td>
      <td>242.890</td>
      <td>254.150</td>
    </tr>
    <tr>
      <th>global_intensity</th>
      <td>2049280.0</td>
      <td>4.627759</td>
      <td>4.444396</td>
      <td>0.200</td>
      <td>1.400</td>
      <td>2.600</td>
      <td>6.400</td>
      <td>48.400</td>
    </tr>
    <tr>
      <th>sub_metering_1</th>
      <td>2049280.0</td>
      <td>1.121923</td>
      <td>6.153031</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>88.000</td>
    </tr>
    <tr>
      <th>sub_metering_2</th>
      <td>2049280.0</td>
      <td>1.298520</td>
      <td>5.822026</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>80.000</td>
    </tr>
    <tr>
      <th>sub_metering_3</th>
      <td>2049280.0</td>
      <td>6.458447</td>
      <td>8.437154</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>17.000</td>
      <td>31.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="dealing-with-missing-values-nan-with-a-test-statistic">
<h3><em><strong>Dealing with missing values  nan with a test statistic</strong></em><a class="headerlink" href="#dealing-with-missing-values-nan-with-a-test-statistic" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Global_active_power      25979
Global_reactive_power    25979
Voltage                  25979
Global_intensity         25979
Sub_metering_1           25979
Sub_metering_2           25979
Sub_metering_3           25979
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># checking missing data</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">percent_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="n">percent_2</span> <span class="o">=</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">percent_1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">total</span><span class="p">,</span> <span class="n">percent_2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">])</span>
<span class="n">missing_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>global_active_power</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>global_reactive_power</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>voltage</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>global_intensity</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>sub_metering_1</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>sub_metering_2</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>sub_metering_3</th>
      <td>25979</td>
      <td>1.25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># finding all columns that have nan:</span>

<span class="n">droping_list_all</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span> <span class="c1">#if there are any null values in the column</span>
        <span class="n">droping_list_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="c1">#print(df.iloc[:,j].unique())</span>
<span class="n">droping_list_all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4, 5, 6]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filling nan with mean in any columns</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># another sanity check to make sure that there are not more any nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>global_active_power      0
global_reactive_power    0
voltage                  0
global_intensity         0
sub_metering_1           0
sub_metering_2           0
sub_metering_3           0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-visualization-and-analyzing-values-feature-by-feature">
<h1><em><strong>3. Data visualization and analyzing values feature by feature</strong></em><a class="headerlink" href="#data-visualization-and-analyzing-values-feature-by-feature" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
      <th>global_reactive_power</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>4.216</td>
      <td>0.418</td>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>5.360</td>
      <td>0.436</td>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>5.374</td>
      <td>0.498</td>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>5.388</td>
      <td>0.502</td>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>3.666</td>
      <td>0.528</td>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="dt-dates-and-time">
<h2>3.1 dt (Dates and time)<a class="headerlink" href="#dt-dates-and-time" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Timestamp(&#39;2006-12-16 17:24:00&#39;), Timestamp(&#39;2010-11-26 21:02:00&#39;))
</pre></div>
</div>
</div>
</div>
</section>
<section id="global-active-power-kw">
<h2>3.2 Global_Active_Power[kw]:<br><a class="headerlink" href="#global-active-power-kw" title="Link to this heading">#</a></h2>
<p>Household global minute-averaged active power (in kilowatt), It is the power that is actually consumed by an appliance averaged per minute<br></p>
<p>Below I resample over day, and show the sum and mean of Global_active_power. It is seen that mean and sum of resampled data set, have similar behaviour.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;global_active_power&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dt
2006-12-16 17:24:00    4.216
2006-12-16 17:25:00    5.360
2006-12-16 17:26:00    5.374
2006-12-16 17:27:00    5.388
2006-12-16 17:28:00    3.666
Name: global_active_power, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.075259e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.091615e+00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.050655e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>7.600000e-02</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.100000e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.300000e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.520000e+00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.112200e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;global_active_power&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Global Active Power&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Global Active Power (kilowatts)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccea4171c5661c6d6479644f0a3f8467a936b2e1f4ea72affa29d6178ba536cc.png" src="../_images/ccea4171c5661c6d6479644f0a3f8467a936b2e1f4ea72affa29d6178ba536cc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="c1"># to extract time information from datetime index</span>
<span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Hour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>

<span class="c1"># to group by hour and average</span>
<span class="n">average_per_hour</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Hour&quot;</span><span class="p">)[</span><span class="s2">&quot;global_active_power&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># to set hours for the X-axis</span>
<span class="n">hours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>

<span class="c1"># For graph drawing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">average_per_hour</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hours</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>  <span class="c1"># Bar chart</span>

<span class="c1"># To specify x-axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">hours</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hours</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># For axis titles and chart title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time of Day&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average Active Power (kilowatt)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average Active Power Distribution by Hours of the Day&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># grid lines on Y the axis</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3cc130855de4ba62007db0c87ff513b15b5566489bb07d3851015376b81689fa.png" src="../_images/3cc130855de4ba62007db0c87ff513b15b5566489bb07d3851015376b81689fa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global_active_power resampled over day for sum&#39;</span><span class="p">)</span> <span class="c1"># Downsampling; converting from minutely to daily data points and summing the corresponding values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global_active_power resampled over day for mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">)</span> <span class="c1"># Downsampling; converting from minutely to daily data points and averaging the corresponding values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ac4d850fb6046916481f00e59173b3a00b04790f81bae55f40dfe95148f28c33.png" src="../_images/ac4d850fb6046916481f00e59173b3a00b04790f81bae55f40dfe95148f28c33.png" />
<img alt="../_images/301dfc6f5f1940e384f6431d6e69bd1b904ddcf9cd3956859ae6361df6e8ba16.png" src="../_images/301dfc6f5f1940e384f6431d6e69bd1b904ddcf9cd3956859ae6361df6e8ba16.png" />
</div>
</div>
<section id="above-i-resampled-data-over-day-and-show-the-sum-and-mean-of-global-active-power-it-is-seen-that-mean-and-sum-of-resampled-dataset-have-similar-behaviour">
<h3>Above I resampled data over day, and show the sum and mean of Global_active_power. It is seen that mean and sum of resampled dataset, have similar behaviour.<a class="headerlink" href="#above-i-resampled-data-over-day-and-show-the-sum-and-mean-of-global-active-power-it-is-seen-that-mean-and-sum-of-resampled-dataset-have-similar-behaviour" title="Link to this heading">#</a></h3>
<ul>
<li><p><em><strong>Long-term overall trend:</strong></em> The graph shows significant fluctuations over the years, but <em><strong>there is no clear upward or downward trend</strong></em>.</p></li>
<li><p><em><strong>Volatile pattern:</strong></em> The series starts at a high level in early 2007 and follows a fluctuating course.</p></li>
<li><p><em><strong>Recurring annual patterns:</strong></em> The graph exhibits peaks and troughs at certain times each year, indicating a <em><strong>strong seasonal pattern</strong></em>.</p></li>
<li><p><em><strong>Distinct fluctuations:</strong></em> There are noticeable increases and decreases at specific intervals each year, suggesting the presence of seasonal effects.
Overall, the time series appears to have a fluctuating trend along with strong seasonality.<br></p>
<h4 class="rubric" id="i-want-to-extract-insights-by-doing-a-more-detailed-analysis-i-want-to-experiment-with-this-data-using-commonly-used-methods-such-as-moving-averages-detrending-or-seasonal-decomposition"><em><strong>I want to extract insights by doing a more detailed analysis, I want to experiment with this data using commonly used methods (such as moving averages, detrending or seasonal decomposition)..</strong></em></h4>
</li>
</ul>
</section>
</section>
<section id="trend-analysis-with-moving-average">
<h2>Trend Analysis with Moving Average<a class="headerlink" href="#trend-analysis-with-moving-average" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_resampled</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 30-day moving average calculation</span>
<span class="n">df_resampled</span><span class="p">[</span><span class="s1">&#39;Moving_Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_resampled</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_resampled</span><span class="o">.</span><span class="n">global_active_power</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Data&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_resampled</span><span class="p">[</span><span class="s1">&#39;Moving_Avg&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;30-day Moving Average&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Moving Average Smoothing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a982d9dd4908f26b6f8b3ae08b2882b8857d85ab2d83707004ed76abeda6e65d.png" src="../_images/a982d9dd4908f26b6f8b3ae08b2882b8857d85ab2d83707004ed76abeda6e65d.png" />
</div>
</div>
<section id="this-graph-displays-daily-total-active-power-consumption-blue-line-and-its-30-day-moving-average-red-line-for-smoothing-fluctuations">
<h3>This graph displays daily total active power consumption (blue line) and its 30-day moving average (red line) for smoothing fluctuations.<br><a class="headerlink" href="#this-graph-displays-daily-total-active-power-consumption-blue-line-and-its-30-day-moving-average-red-line-for-smoothing-fluctuations" title="Link to this heading">#</a></h3>
<p>1-Trend (Long-Term Patterns)<br></p>
<ul class="simple">
<li><p>There is a clear seasonal fluctuation over time.<br></p></li>
<li><p>Several peaks and troughs are observed from 2007 to 2010.<br></p></li>
<li><p>A significant drop is noticeable around mid-2008 and early 2009.<br></p></li>
</ul>
<p>2- Seasonality (Periodic Fluctuations)<br></p>
<ul class="simple">
<li><p>The red line shows regular increases and decreases throughout the year, indicating a seasonal pattern.</p></li>
<li><p>Typically, higher consumption is seen in summer and winter, while lower consumption occurs in spring and fall.<br></p></li>
</ul>
<p>3-Volatility (Short-Term Variations)<br></p>
<ul class="simple">
<li><p>The blue line has large short-term fluctuations, meaning daily power consumption varies significantly.<br></p></li>
<li><p>However, the 30-day moving average smooths out these fluctuations, making the overall trend clearer.<br></p></li>
</ul>
<p>Energy consumption shows strong seasonal effects, along with long-term fluctuations.
The moving average helps filter out daily noise, revealing the main trend more effectively.
For deeper insights, seasonal decomposition or detrending techniques could be applied.
These findings provide valuable insights for energy management and demand forecasting</p>
</section>
</section>
<section id="seasonal-decomposition">
<h2><strong>Seasonal Decomposition</strong><a class="headerlink" href="#seasonal-decomposition" title="Link to this heading">#</a></h2>
<p><em><strong>Seasonal Decomposition</strong></em> is a method used to separate the observed trends, seasonal components, and random components (noise) in time series data. This process helps make the data easier to understand and aids in <em><strong>better modeling for future predictions.</strong></em></p>
<p>There are three main components in time series data:</p>
<p><em><strong>Trend:</strong></em> Represents the overall movement of the data over the long term. For example, an increase or decrease in sales over the years.</p>
<p><em><strong>Seasonal Component:</strong></em> Represents a periodic pattern in the data. This can include yearly, monthly, or daily cycles (e.g., increased sales during holiday seasons).</p>
<p><em><strong>Residual Component:</strong></em> The random noise left after removing the trend and seasonal components. This is typically the part of the data that the model cannot explain.</p>
<p>Separating these components is important for accurately modeling the data and making predictions. It is also useful for detecting anomalies and optimizing business strategies that aim to monitor and leverage seasonal effects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_resampled</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-05-19</th>
      <td>1426.752</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df_resampled</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>  <span class="c1"># Annual seasonal period (365 days)</span>

<span class="c1"># Plotting the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonality&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/072b6578485f3a64b9547786ac5dcf873a6a74066f5cd4143bdafa4236435d91.png" src="../_images/072b6578485f3a64b9547786ac5dcf873a6a74066f5cd4143bdafa4236435d91.png" />
</div>
</div>
<p>Heres analysis of this seasonal decomposition graph:</p>
<p><em><strong>Original Data (Blue):</strong></em><br></p>
<ul class="simple">
<li><p>A time series covering 2007-2010 period with high-frequency fluctuations<br></p></li>
<li><p>The data generally moves within the 0-10 range, occasionally reaching higher values<br></p></li>
<li><p>Notable volatility structure present<br>
<em><strong>Trend Component (Red):</strong></em><br></p></li>
<li><p>Shows the long-term tendency of the series<br></p></li>
<li><p>An upward trend in early 2008, followed by a downward trend until early 2009<br></p></li>
<li><p>Gradual recovery and upward trend after 2009<br></p></li>
<li><p>Moves within the 1500-1600 band<br>
Seasonal Component (Green):<br></p></li>
<li><p>Demonstrates a very clear and regular seasonal pattern<br></p></li>
<li><p>Shows recurring fluctuations during similar periods each year and repeats in approximately 6-12 month periods<br></p></li>
<li><p>The magnitude of seasonal effects varies between +1000 and -1000<br></p></li>
<li><p>Forms 4-5 distinct peaks and troughs within each year<br>
<em><strong>Residuals (Purple):</strong></em><br></p></li>
<li><p>Shows random fluctuations<br></p></li>
<li><p>Noise component generally varying between -1000 and +1000<br></p></li>
<li><p>High volatility clusters in some periods,shows some outliers in certain periods, this shows that sudden changes are taking place.<br></p></li>
<li><p>Relatively symmetric distribution of residuals<br></p></li>
<li><p>Possible external factors:</p>
<ul>
<li><p>Power outages</p></li>
<li><p>Major weather events (e.g. storms, extreme heat or cold waves)</p></li>
<li><p>Economic crises and price changes</p></li>
</ul>
</li>
</ul>
<p>This comprehensive breakdown of components helps us understand the underlying patterns in our time series data.This data provides critical information about utilities, public policies, and consumer habits. This analysis can be used to develop demand forecasts, energy conservation policies, and dynamic pricing strategies.<br></p>
<p>Here are the key insights from the time series decomposition:<br><br></p>
<ul class="simple">
<li><p>The trend component might be an economic indicator (seems to reflect the effects of 2008-2009 crisis)</p></li>
<li><p>The decomposition process appears successful as components are clearly separated</p></li>
<li><p>The dataset shows a strong seasonal component, indicating that seasonal factors must be considered in predictive modeling. This clear seasonality pattern suggests that any forecasting approach should incorporate these regular cyclical patterns.<br></p></li>
<li><p>The trend component shows a significant decline in 2008-2009 and then a recovery.</p></li>
<li><p>This historical context is crucial for understanding long-term patterns.<br></p></li>
<li><p>The stability of the residuals indicates that the decomposition model effectively explains the datas behavior. This suggests the chosen decomposition method is appropriate for this particular time series.<br></p></li>
<li><p>The pronounced seasonal pattern reveals strong periodicity inherent in the underlying process. This likely stems from recurring factors in business processes or external influences that follow a regular cycle.<br></p></li>
<li><p>The recovery trend observed after 2009 could be interpreted as a positive signal for future period forecasts, though this should be considered alongside other contextual factors.</p></li>
<li><p>SARIMA or other models containing seasonal components might be suitable for this series</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sum of &#39;Global_active_power&#39; resampled over month</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="n">xticks_dates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">xticks_dates</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;global_active_power by month (averaged over month)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8019156eea96b54a50df7cac8fad3c76e5152cdb2b6736c7850f7dd776818ebb.png" src="../_images/8019156eea96b54a50df7cac8fad3c76e5152cdb2b6736c7850f7dd776818ebb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Mean of &#39;Global_active_power&#39; resampled over quarter</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;QE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Global_active_power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Global_active_power by quarter (averaged over quarter)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1466c96aa85881964848446a293e13346415e88b93038906f247c7a60cf679f3.png" src="../_images/1466c96aa85881964848446a293e13346415e88b93038906f247c7a60cf679f3.png" />
</div>
</div>
<section id="it-is-very-important-to-note-from-above-plots-that-resampling-over-larger-time-inteval-will-diminish-the-periodicity-of-system-as-we-expect-this-is-important-for-machine-learning-feature-engineering">
<h3>It is very important to note from above plots that resampling over larger time inteval, will diminish the periodicity of system as we expect. This is important for machine learning feature engineering.<a class="headerlink" href="#it-is-very-important-to-note-from-above-plots-that-resampling-over-larger-time-inteval-will-diminish-the-periodicity-of-system-as-we-expect-this-is-important-for-machine-learning-feature-engineering" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="global-reactive-power-kw">
<h2>3.3 Global_reactive_power[kw]:<br><a class="headerlink" href="#global-reactive-power-kw" title="Link to this heading">#</a></h2>
<p>Household global minute-averaged reactive power (in kilowatt), It is the Imaginary power that is not consumed by an appliance averaged per minute.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Below I show mean and std of &#39;Global_reactive_power&#39; resampled over day</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">global_reactive_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="n">r2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global_reactive_power resampled over day&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1400x800 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/2aeb8c74119e785523d3cb068553c5deef35e75ffc674c57cea8f344b4c13320.png" src="../_images/2aeb8c74119e785523d3cb068553c5deef35e75ffc674c57cea8f344b4c13320.png" />
</div>
</div>
</section>
<section id="global-intensity-ampere">
<h2>3.4 Global_intensity[Ampere]:<br><a class="headerlink" href="#global-intensity-ampere" title="Link to this heading">#</a></h2>
<p>Household global minute-averaged current intensity (in ampere)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Below I show mean and std of &#39;Global_intensity&#39; resampled over day</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">global_intensity</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global_intensity resampled over day&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1400x800 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/2d99fe2d6e05a4c6fc07e4fbfbec6fc58ead958a909d1647f08181d123ad85ad.png" src="../_images/2d99fe2d6e05a4c6fc07e4fbfbec6fc58ead958a909d1647f08181d123ad85ad.png" />
</div>
</div>
</section>
<section id="voltage-v">
<h2>3.5 Voltage[ V ]:<br><a class="headerlink" href="#voltage-v" title="Link to this heading">#</a></h2>
<p>minute-averaged voltage (in volt)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">voltage</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.075259e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.408399e+02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.219643e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.232000e+02</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.390200e+02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.409600e+02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.428600e+02</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.541500e+02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## mean of &#39;Voltage&#39; resampled over month</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">xticks_dates</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Voltage by month (averaged over month)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/184511354bf8697937beda11f7f9bd9118ab1c257b4a6232144cb7780ce1974a.png" src="../_images/184511354bf8697937beda11f7f9bd9118ab1c257b4a6232144cb7780ce1974a.png" />
</div>
</div>
<section id="it-is-seen-from-the-above-plots-that-the-mean-of-volage-over-month-is-pretty-much-constant-compared-to-other-features-this-is-important-again-in-feature-selection">
<h3>It is seen from the above plots that the mean of Volage over month is pretty much constant compared to other features. This is important again in feature selection.<a class="headerlink" href="#it-is-seen-from-the-above-plots-that-the-mean-of-volage-over-month-is-pretty-much-constant-compared-to-other-features-this-is-important-again-in-feature-selection" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="sub-metering-1-wh">
<h2>3.6 Sub_metering_1[WH]:<br><a class="headerlink" href="#sub-metering-1-wh" title="Link to this heading">#</a></h2>
<p>Energy sub-metering No. 1 (in watt-hour of active energy). It corresponds to the kitchen, containing mainly a dishwasher, an oven and a microwave (hot plates are not electric but gas powered).<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">xticks_dates</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sub_metering_1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sub_metering_1 by month (averaged over month)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d8eb7f6c53a1a8d13d70717c373fd662cdb095090327f8427b1c2db817d84fd8.png" src="../_images/d8eb7f6c53a1a8d13d70717c373fd662cdb095090327f8427b1c2db817d84fd8.png" />
</div>
</div>
</section>
<section id="sub-metering-2-wh">
<h2>3.7 Sub_metering_2[WH]:<br><a class="headerlink" href="#sub-metering-2-wh" title="Link to this heading">#</a></h2>
<p>Energy sub-metering No. 2 (in watt-hour of active energy). It corresponds to the laundry room, containing a washing-machine, a tumble-drier, a refrigerator and a light.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sub_metering_2</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sub_metering_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.075259e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.298520e+00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.785470e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8.000000e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sub_metering_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">xticks_dates</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sub_metering_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sub_metering_2 by month (averaged over month)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/83378407fdd248578981d697bb280393fcda743f3d347c1537dcd67d43ccbb97.png" src="../_images/83378407fdd248578981d697bb280393fcda743f3d347c1537dcd67d43ccbb97.png" />
</div>
</div>
</section>
<section id="sub-metering-3-wh">
<h2>3.8 Sub_metering_3[WH]:<br><a class="headerlink" href="#sub-metering-3-wh" title="Link to this heading">#</a></h2>
<p>Energy sub-metering No. 3 (in watt-hour of active energy). It corresponds to an electric water-heater and an air-conditioner.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sub_metering_3</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sub_metering_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.075259e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>6.458447e+00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.384178e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.700000e+01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.100000e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sub_metering_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">xticks_dates</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sub_metering_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sub_metering_3 by month (averaged over month)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/19eacbd8f84cf539047a959133c01bff9001e6e96115856b4fffe0030e0e8a62.png" src="../_images/19eacbd8f84cf539047a959133c01bff9001e6e96115856b4fffe0030e0e8a62.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="s1">&#39;kilowatt&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Voltage&#39;</span><span class="p">:</span> <span class="s1">&#39;volt&#39;</span><span class="p">,</span>
          <span class="s1">&#39;intensity&#39;</span><span class="p">:</span> <span class="s1">&#39;ampere&#39;</span><span class="p">,</span>
          <span class="s1">&#39;metering&#39;</span><span class="p">:</span> <span class="s1">&#39;watt-hour&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">row</span>       <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># Calculate the row index</span>
    <span class="n">col_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>   <span class="c1"># Calculate the column index</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>  <span class="c1"># Access the subplot using two indices</span>
    <span class="k">if</span> <span class="s1">&#39;power&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>  <span class="c1"># Set title for each subplot</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">meters</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;Voltage&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">meters</span><span class="p">[</span><span class="s1">&#39;Voltage&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>  <span class="c1"># Set title for each subplot</span>
    <span class="k">elif</span> <span class="s1">&#39;intensity&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">meters</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>  <span class="c1"># Set title for each subplot</span>
    <span class="k">elif</span> <span class="s1">&#39;metering&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">meters</span><span class="p">[</span><span class="s1">&#39;metering&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;1&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">: a dishwasher, an oven and a microwave&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;2&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">: a washing-machine, a tumble-drier, a refrigerator and a light&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;3&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1">: an electric water-heater and an air-conditioner.&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc66c00aefb84189b6a6b3bf4410105e314ff0ae51610d7a44b10ff516a4e604.png" src="../_images/dc66c00aefb84189b6a6b3bf4410105e314ff0ae51610d7a44b10ff516a4e604.png" />
</div>
</div>
<ul class="simple">
<li><p>There is a huge reduction in all parameters during a short period between 2008-07 and 2008-10.<br></p></li>
<li><p>In addition to the above-mentioned period, there are some smaller periods with similar behaviors throughout all the datetimes.<br></p></li>
<li><p>here are two periods with a sharp decrease in voltage between 2008-04 and 2008-09.<br></p></li>
<li><p>There are several spikes in Submetering_1 and Submetering_2.<br></p></li>
<li><p>There is an approximately steady behavior in Submetering_3, except for the ending periods with a significant fluctuation in power consumption.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Below I compare the mean of different featuresresampled over day.</span>
<span class="c1"># specify columns to plot</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">groups</span><span class="o">=</span><span class="n">cols</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># plot each column</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">[:,</span> <span class="n">group</span><span class="p">])</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">group</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
	<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/44d9ef15621606e4ae865f5bd47d73941df0fe45b89e2d046c3cfa60ab0b785e.png" src="../_images/44d9ef15621606e4ae865f5bd47d73941df0fe45b89e2d046c3cfa60ab0b785e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## resampling over week and computing mean</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_reactive_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sub_metering_1</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_intensity</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ece4dd5943a529e0a351fec1fd534a2e38c9e5f7b2f3b13122b0dc3773800b21.png" src="../_images/ece4dd5943a529e0a351fec1fd534a2e38c9e5f7b2f3b13122b0dc3773800b21.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Below I show hist plot of the mean of different feature resampled over month</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_active_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_reactive_power</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#df.Voltage.resample(&#39;M&#39;).sum().plot(kind=&#39;hist&#39;,color=&#39;g&#39;, legend=True)</span>
<span class="n">df</span><span class="o">.</span><span class="n">global_intensity</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sub_metering_1</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ea7808e508471c6e8f75feff84dda76702de9eaad694517e0661259c555d3cf1.png" src="../_images/ea7808e508471c6e8f75feff84dda76702de9eaad694517e0661259c555d3cf1.png" />
</div>
</div>
</section>
</section>
<section id="correlations-among-features">
<h1><em><strong>4.Correlations among features</strong></em><a class="headerlink" href="#correlations-among-features" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## The correlations between &#39;Global_intensity&#39;, &#39;Global_active_power&#39;</span>
<span class="n">data_returns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span> <span class="c1"># compute the percentage change of the data</span>
<span class="n">data_sample</span> <span class="o">=</span> <span class="n">data_returns</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># sample data for reducing the computation</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_sample</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/68f597fb445cb6cfdda419e12026b8ae8c7f62941c4aff9ce03fc6c8850b9158.png" src="../_images/68f597fb445cb6cfdda419e12026b8ae8c7f62941c4aff9ce03fc6c8850b9158.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##The correlations between &#39;Voltage&#39; and  &#39;Global_active_power&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;voltage&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_sample</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f608ee16ac6097694451a1c671f9c826498ca316dd4932b9a1c106b17b753d76.png" src="../_images/f608ee16ac6097694451a1c671f9c826498ca316dd4932b9a1c106b17b753d76.png" />
</div>
</div>
<section id="from-above-two-plots-it-is-seen-that-global-intensity-and-global-active-power-correlated-but-voltage-global-active-power-are-less-correlated-this-is-important-observation-for-machine-learning-purpose">
<h2>From above two plots it is seen that Global_intensity and Global_active_power correlated. But Voltage, Global_active_power are less correlated. This is important observation for machine learning purpose.<a class="headerlink" href="#from-above-two-plots-it-is-seen-that-global-intensity-and-global-active-power-correlated-but-voltage-global-active-power-are-less-correlated-this-is-important-observation-for-machine-learning-purpose" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The pairplot is a great way to show the bivariate relationships between each pair of features.</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">df_sample</span><span class="p">[</span><span class="s2">&quot;global_active_power_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s2">&quot;global_active_power&quot;</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;medium-low&quot;</span><span class="p">,</span> <span class="s2">&quot;medium-high&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_sample</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;global_active_power_cat&quot;</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6769060e6984e75973659ec4db74df44fef6ecb6c411caa2488124c4ad244380.png" src="../_images/6769060e6984e75973659ec4db74df44fef6ecb6c411caa2488124c4ad244380.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
      <th>global_reactive_power</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>4.216</td>
      <td>0.418</td>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>5.360</td>
      <td>0.436</td>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>5.374</td>
      <td>0.498</td>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>5.388</td>
      <td>0.502</td>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>3.666</td>
      <td>0.528</td>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span> <span class="c1"># I use spearman method because it is more robust to outliers than pearson and measure the monotonic </span>
                           <span class="c1"># relationship between two continuous or ordinal variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
      <th>global_reactive_power</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>global_active_power</th>
      <td>1.000000</td>
      <td>0.266843</td>
      <td>-0.327121</td>
      <td>0.995525</td>
      <td>0.324621</td>
      <td>0.187453</td>
      <td>0.611548</td>
    </tr>
    <tr>
      <th>global_reactive_power</th>
      <td>0.266843</td>
      <td>1.000000</td>
      <td>-0.094692</td>
      <td>0.294988</td>
      <td>0.124556</td>
      <td>0.431917</td>
      <td>0.074071</td>
    </tr>
    <tr>
      <th>voltage</th>
      <td>-0.327121</td>
      <td>-0.094692</td>
      <td>1.000000</td>
      <td>-0.350782</td>
      <td>-0.175124</td>
      <td>-0.093525</td>
      <td>-0.187378</td>
    </tr>
    <tr>
      <th>global_intensity</th>
      <td>0.995525</td>
      <td>0.294988</td>
      <td>-0.350782</td>
      <td>1.000000</td>
      <td>0.326048</td>
      <td>0.201651</td>
      <td>0.608248</td>
    </tr>
    <tr>
      <th>sub_metering_1</th>
      <td>0.324621</td>
      <td>0.124556</td>
      <td>-0.175124</td>
      <td>0.326048</td>
      <td>1.000000</td>
      <td>0.116086</td>
      <td>0.160727</td>
    </tr>
    <tr>
      <th>sub_metering_2</th>
      <td>0.187453</td>
      <td>0.431917</td>
      <td>-0.093525</td>
      <td>0.201651</td>
      <td>0.116086</td>
      <td>1.000000</td>
      <td>0.054649</td>
    </tr>
    <tr>
      <th>sub_metering_3</th>
      <td>0.611548</td>
      <td>0.074071</td>
      <td>-0.187378</td>
      <td>0.608248</td>
      <td>0.160727</td>
      <td>0.054649</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting up the figure and axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Drawing the heatmap</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap (Diagonal) Without Resampling&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/37fdeb68b2efe3b5f65fb6b28cb804671cc4bd20bc11a63fd625dc0c6c55d18c.png" src="../_images/37fdeb68b2efe3b5f65fb6b28cb804671cc4bd20bc11a63fd625dc0c6c55d18c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Correlations of mean of features resampled over months</span>

<span class="c1"># Mask for the upper triangle</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>

<span class="c1"># Setting up the figure and axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Drawing the heatmap</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;inferno&quot;</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap (Diagonal) resampled over month&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Correlations of mean of features resampled over years</span>

<span class="c1"># Mask for the upper triangle</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>

<span class="c1"># Setting up the figure and axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Drawing the heatmap</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;inferno&quot;</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap (Diagonal) resampled over year&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/408c97bf498996afea0dc65b5d3893c4797d992a83589f1b5156c29d0353a885.png" src="../_images/408c97bf498996afea0dc65b5d3893c4797d992a83589f1b5156c29d0353a885.png" />
<img alt="../_images/028136861f21a93f38a5f531ebbce776dc61f7c736d8823a6833be81423f7d91.png" src="../_images/028136861f21a93f38a5f531ebbce776dc61f7c736d8823a6833be81423f7d91.png" />
</div>
</div>
</section>
<section id="it-is-seen-from-above-that-with-resampling-techniques-one-can-change-the-correlations-among-features-this-is-important-for-feature-engineering">
<h2><em><strong>It is seen from above that with resampling techniques one can change the correlations among features. This is important for feature  engineering.</strong></em><a class="headerlink" href="#it-is-seen-from-above-that-with-resampling-techniques-one-can-change-the-correlations-among-features-this-is-important-for-feature-engineering" title="Link to this heading">#</a></h2>
</section>
</section>
<section id="modeling">
<h1><em><strong>5.MODELING</strong></em><a class="headerlink" href="#modeling" title="Link to this heading">#</a></h1>
<section id="model-preparation">
<h2>5.1. Model Preparation<a class="headerlink" href="#model-preparation" title="Link to this heading">#</a></h2>
<section id="calculating-and-adding-power-factor">
<h3><em><strong><em>5.1.1. Calculating and Adding Power Factor</em></strong></em><a class="headerlink" href="#calculating-and-adding-power-factor" title="Link to this heading">#</a></h3>
<p>In power sytems analysis there is a important term called power <a class="reference external" href="http://factor.In">factor.In</a> this section, we will calculate the power factor from the active and reactive power, and add it as a new feature to our scaled DataFrame.<br></p>
<p>Power factor is an important measure in electrical systems, indicating how efficiently energy is being used. A power factor close to 1 indicates high efficiency, while a low power factor suggests inefficient energy use.<br></p>
</section>
</section>
<section id="what-is-power-factor">
<h2>What is Power Factor?<a class="headerlink" href="#what-is-power-factor" title="Link to this heading">#</a></h2>
<p>Power factor is the ratio of the <strong>active power (P)</strong> used in an electrical system to the <strong>apparent power (S)</strong> drawn. Mathematically, it is expressed as:</p>
<p>Power Factor (PF) = Active Power (P) / Apparent Power (S)</p>
<section id="where">
<h3>Where:<a class="headerlink" href="#where" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Active Power (P):</strong> The actual power that performs useful work <em>(kW  kilowatt)</em>.</p></li>
<li><p><strong>Reactive Power (Q):</strong> The power used to generate magnetic fields but does not contribute to useful work <em>(kVAR  kilovolt-ampere-reactive)</em>.</p></li>
<li><p><strong>Apparent Power (S):</strong> The total power drawn from the source <em>(kVA  kilovolt-ampere)</em>.</p></li>
</ul>
<p>The relationship between these three is given by:</p>
<p>S = P + Q</p>
<p>And the power factor is calculated as:</p>
<p>cos() = P / S</p>
</section>
<section id="look-at-the-picture-below">
<h3>Look at the picture below <br><a class="headerlink" href="#look-at-the-picture-below" title="Link to this heading">#</a></h3>
<p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/d8/Cmplxpower.svg" alt="Power Factor" width="300" height="300"> <br>
Q is Reactive Power which flows back and forth between source and load<br />
R is Active power that directly consumed on the demand side<br />
S is Apparent power that is the product of the RMS values of voltage and current.</p>
</section>
</section>
<hr class="docutils" />
<section id="why-is-power-factor-important">
<h2>Why is Power Factor Important?<a class="headerlink" href="#why-is-power-factor-important" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Energy Efficiency:</strong> A low power factor causes more current to be drawn, increasing energy losses.</p></li>
<li><p><strong>Electricity Costs:</strong> Businesses with a low power factor may be subject to penalty charges for drawing unnecessary reactive power from the grid.</p></li>
<li><p><strong>Equipment Lifespan:</strong> High currents put stress on cables and transformers, shortening their lifespan.</p></li>
<li><p><strong>Grid Capacity:</strong> A good power factor ensures the efficient operation of the electrical grid and prevents unnecessary overloading.</p></li>
</ol>
<p>The <strong>ideal power factor should be close to 1</strong> <em>(e.g., 0.95 or higher)</em>. To correct a low power factor, <strong>capacitors or power factor correction devices</strong> are used.</p>
<p>We will use the standard formulas to calculate apparent power and power factor from active and reactive power. We will then add this new feature to the <code class="docutils literal notranslate"><span class="pre">df_scaled</span></code> DataFrame for further analysis and modeling.<br><br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">active_power_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">])</span>
<span class="n">reactive_power_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_reactive_power&#39;</span><span class="p">])</span>

<span class="n">apparent_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">active_power_sq</span> <span class="o">+</span> <span class="n">reactive_power_sq</span><span class="p">)</span>

<span class="c1"># Compute numerator once</span>
<span class="n">power_factor</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">apparent_power</span>


<span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">power_factor</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>global_active_power</th>
      <th>global_reactive_power</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>4.216</td>
      <td>0.418</td>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995121</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>5.360</td>
      <td>0.436</td>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>0.996708</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>5.374</td>
      <td>0.498</td>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>0.995734</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>5.388</td>
      <td>0.502</td>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995688</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>3.666</td>
      <td>0.528</td>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.989787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;global_active_power&#39;</span><span class="p">,</span> <span class="s1">&#39;global_reactive_power&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995121</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>0.996708</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>0.995734</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995688</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.989787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_before_modeling.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="i-want-to-do-the-trend-and-seasonal-decomposition-analyses-that-i-did-for-global-active-power-in-the-previous-sections-for-the-power-factor-here">
<h2><strong>I want to do the trend and seasonal decomposition analyses that I did forglobal_active_power in the previous sections for the power factor here.</strong><a class="headerlink" href="#i-want-to-do-the-trend-and-seasonal-decomposition-analyses-that-i-did-for-global-active-power-in-the-previous-sections-for-the-power-factor-here" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Trend Analysis with Moving Average</span>

<span class="n">df_resampled1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">power_factor</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="c1"># 30-day moving average calculation</span>
<span class="n">df_resampled1</span><span class="p">[</span><span class="s1">&#39;Moving_Avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_resampled1</span><span class="o">.</span><span class="n">power_factor</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_resampled1</span><span class="o">.</span><span class="n">power_factor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Data&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_resampled1</span><span class="p">[</span><span class="s1">&#39;Moving_Avg&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;30-day Moving Average&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Moving Average Smoothing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/437afaa1a9f4d9953fec8646dc611ffae53c69962021667346486f2bdbebc0f9.png" src="../_images/437afaa1a9f4d9953fec8646dc611ffae53c69962021667346486f2bdbebc0f9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># seasonal_decomposition</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df_resampled1</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>  <span class="c1"># Annual seasonalperiyodu (365 gn)</span>

<span class="c1"># Plotting the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_resampled1</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonality&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aba838ff1d347060b945884200b555c3553435863a8467af3217d6dd2d9e2e5d.png" src="../_images/aba838ff1d347060b945884200b555c3553435863a8467af3217d6dd2d9e2e5d.png" />
</div>
</div>
</section>
<section id="power-factor-time-series-decomposition-in-detail">
<h2><em><strong>Power Factor time series decomposition in detail:</strong></em><a class="headerlink" href="#power-factor-time-series-decomposition-in-detail" title="Link to this heading">#</a></h2>
<p><em><strong>Original Data (Blue Graph):</strong></em><br><br></p>
<ul class="simple">
<li><p>Data ranges approximately between 1000-1250<br></p></li>
<li><p>Shows very stable behavior, except for sudden drops<br></p></li>
<li><p>Has several significant drop points, especially in 2008 and 2009<br></p></li>
<li><p>Generally high and stable power factor (close to 1) indicates efficient system operation<br>
<em><strong>Trend Component (Red Graph):</strong></em> <br><br></p></li>
<li><p>Moves within the 1385-1395 band<br></p></li>
<li><p>Forms a peak at the beginning of 2008<br></p></li>
<li><p>Shows a slight downward trend in mid-2009<br></p></li>
<li><p>Enters an upward trend towards 2010<br></p></li>
<li><p>Shows minimal changes overall, indicating stable system operation<br>
<em><strong>Seasonality (Green Graph):</strong></em> <br><br></p></li>
<li><p>Clear seasonal pattern present<br></p></li>
<li><p>Seasonal fluctuations between -100 and +50<br></p></li>
<li><p>Regular recurring patterns visible each year<br></p></li>
<li><p>Lower amplitude seasonal effects compared to Global Active Power<br>
<em><strong>Residuals (Purple Graph):</strong></em> <br><br></p></li>
<li><p>Residuals generally within -100 to +50 band<br></p></li>
<li><p>Shows a large negative deviation in mid-2008<br></p></li>
<li><p>Variance is generally stable, with increases in some periods<br></p></li>
<li><p>Less volatile compared to Global Active Power<br>
<em><strong>Comparative Insights with Global Active Power:</strong></em> <br><br>
Power factor shows much more stable behavior, which is expected as it should typically remain close to 1.
The amplitude of seasonal effects is lower in power factor, indicating successful reactive power compensation.
Both series show significant changes during 2008-2009, suggesting important changes in system or load during this period.
Residuals in power factor are less volatile compared to global active power, indicating good power factor control.<br></p></li>
</ul>
<p><em><strong>Recommendations:</strong></em> <br><br></p>
<ul class="simple">
<li><p>Detailed investigation of periods with large deviations<br></p></li>
<li><p>Review of compensation system during seasonal decline periods<br></p></li>
<li><p>Evaluation of long-term system performance through trend analysis<br></p></li>
<li><p>Detailed correlation analysis between the two features<br></p></li>
</ul>
<p><em><strong>Conclusion:</strong></em> <br><br></p>
<p><em><strong>When comparing the analyses, we observe that Global Active Power shows significant seasonal fluctuations, while Power Factor maintains a more stable pattern. This indicates that despite seasonal changes in electricity consumption, the systems power quality is well maintained. While Global Active Power shows more pronounced trend changes, Power Factors trend line remains more stable, indicating that the system continues to operate efficiently.
In terms of electricity consumption, high power factor values ranging between 0.95-1.00 demonstrate that the system is operating efficiently and electricity costs are optimized. Its important to monitor system capacity and implement load balancing during periods of significant seasonal changes. Additionally, regular maintenance and control of reactive power compensation systems are crucial for the systems long-term performance. Based on this data, its recommended to plan operations according to energy consumption patterns and take special measures during peak consumption periods.</strong></em></p>
</section>
<section id="model-selection">
<h2><em><strong>5.2. Model Selection:</strong></em><a class="headerlink" href="#model-selection" title="Link to this heading">#</a></h2>
<section id="arima-sarima-models">
<h3><em><strong>5.2.1.ARIMA/SARIMA MODELS</strong></em><a class="headerlink" href="#arima-sarima-models" title="Link to this heading">#</a></h3>
<p>ARIMA : Non-seasonal Autoregressive Integrated Moving Averages</p>
<p>SARIMA : Seasonal ARIMA</p>
<p>SARIMAX : Seasonal ARIMA with exogenous variables</p>
<p>If a time series, has seasonal patterns, then we need to add seasonal terms and it becomes SARIMA, short for Seasonal ARIMA.</p>
<p>Steps for building ARIMA-SARIMA models:</p>
<ol class="arabic simple">
<li><p><em><strong>Check Stationarity:</strong></em><br>
Verify the stationarity of each series using tests like ADF (Augmented Dickey-Fuller) and KPSS (Kwiatkowski-Phillips-Schmidt-Shin). Display with ACF and PACF plots.<br></p></li>
<li><p><em><strong>Make Series Stationary:</strong></em><br>
Apply transformations to make the target and exogenous variables stationary if needed. Common methods include differencing and log transformations.</p></li>
<li><p><em><strong>Model the Relationship:</strong></em><br>
Use the stationary series in your ARIMA or SARIMA model.</p></li>
</ol>
<p>For ARIMA (AutoRegressive Integrated Moving Average) and SARIMA (Seasonal AutoRegressive Integrated Moving Average) models, it is essential to make the time series data stationary before fitting the model. These models assume that the time series data is stationary, meaning that its statistical properties such as mean, variance, and autocorrelation structure do not change over time. If the data is non-stationary, it can lead to biased parameter estimates and unreliable forecasts.</p>
<p>To make the data stationary, you typically need to remove trends and seasonality. This can be done through techniques like taking differences (for removing trends) and seasonal differencing (for removing seasonality). Once the data is stationary, you can then fit the ARIMA or SARIMA model to the transformed data.</p>
</section>
<section id="checking-stationarity">
<h3><em><strong>5.2.1.1.Checking Stationarity:</strong></em><a class="headerlink" href="#checking-stationarity" title="Link to this heading">#</a></h3>
<p>The observations in a stationary time series are not dependent on time.<br></p>
<p>Time series are <em><strong>stationary</strong></em> if they do not have trend or seasonal effects. Summary statistics calculated on the time series are consistent over time, like the mean or the variance of the observations.<br></p>
<p>When a time series is stationary, it can be easier to model. Statistical modeling methods assume or require the time series to be stationary to be effective.<br>
<img alt="image.png" src="_notebooks/attachment:fe2088d1-1177-4921-ba6a-6143a8d9cc29.png" /></p>
<p>Observations from a <em><strong>non-stationary</strong></em> time series show seasonal effects, trends, and other structures that depend on the time index.<br></p>
<p>Summary statistics like the mean and variance do change over time, providing a drift in the concepts a model may try to capture.<br></p>
<p>Classical time series analysis and forecasting methods are concerned with making non-stationary time series data stationary by identifying and removing trends and removing seasonal effects.<br></p>
<p><img alt="image.png" src="_notebooks/attachment:a8374b80-a2c0-4e89-ae6e-f2242a859402.png" /></p>
<p>ACF and PACF:</p>
<ol class="arabic simple">
<li><p>Autocorrelation Function (ACF):<br><br></p></li>
</ol>
<ul class="simple">
<li><p>The ACF measures the correlation between a time series and its lagged values at different lag intervals.<br></p></li>
<li><p>On the x-axis, you have the lag or time interval.<br></p></li>
<li><p>The y-axis represents the correlation coefficient, which ranges from -1 to 1.<br></p></li>
<li><p>Positive values indicate positive correlation (similar movement in the same direction), while negative values indicate negative correlation (opposite movement).<br></p></li>
<li><p>The shaded region represents the 95% confidence interval. Correlation values outside this region are considered statistically significant.<br></p></li>
<li><p>Significant spikes in the ACF plot indicate potential seasonal patterns or trends in the data.<br></p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Partial Autocorrelation Function (PACF):<br><br></p></li>
</ol>
<ul class="simple">
<li><p>The PACF measures the correlation between a time series and its lagged values, controlling for the effects of other lags in between.<br></p></li>
<li><p>It helps identify the direct relationship between a data point and its lagged values, excluding the influence of other lags.<br></p></li>
<li><p>Similar to the ACF plot, the x-axis represents the lag or time interval, and the y-axis represents the correlation coefficient.<br></p></li>
<li><p>Significant spikes in the PACF plot indicate the number of lag terms to include in autoregressive models (AR).<br></p></li>
<li><p>Interpreting these plots helps identify potential patterns, trends, and seasonality in the time series data, providing insights for modeling and forecasting.<br></p></li>
<li><p>If there are clear patterns like seasonality in the ACF and PACF plots, it suggests that the data exhibits periodic behavior.<br> - This implies that there are recurring patterns or cycles in the data over time, which can be important for understanding and forecasting future values.<br></p></li>
</ul>
<p> Lagged Values <br>
Lagged values, in the context of time series analysis, refer to the values of a variable (or series) at previous time points. When we say lagged by k time units, it means were looking at the value of the variable k time points in the past.<br></p>
<p>For example, if we have daily temperature data for a city, and we want to analyze the temperature at time t (today) with respect to the temperature at time t-1 (yesterday), were looking at a lag of 1 day. Similarly, if were interested in the temperature at time t with respect to the temperature two days ago (t-2), were looking at a lag of 2 days.<br></p>
<p>Lagged values are essential in time series analysis for understanding temporal dependencies, identifying patterns, and building forecasting models. The Autocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) plots help visualize the correlation between the original time series and its lagged values at different time intervals.<br></p>
<p> Ideal ACF and PACF plots <br>
ACF Plot:<br>
We ideally want the autocorrelation values to start from high positive values and gradually decrease as the lag increases.
The autocorrelation values should approach zero as the lag becomes large.<br>
A gradual decay in autocorrelation indicates that the past observations have some influence on the current observation but that influence diminishes as we move further into the past.<br>
PACF Plot:<br>
We ideally want partial autocorrelation values to start from high values at lag 1 and then drop off sharply to zero or close to zero for subsequent lags.<br>
Significant spikes at lower lags (especially lag 1) indicate a strong direct relationship between the current observation and past observations.<br>
A sudden drop-off in partial autocorrelation beyond a certain lag indicates that the effects of intermediate observations are explained by more recent observations.<br>
These ideal patterns in ACF and PACF plots help in identifying the order of autoregressive (AR) and moving average (MA) terms in time series models such as ARIMA (Autoregressive Integrated Moving Average).<br>
image.png</p>
<p>Sources:<br></p>
<p><a class="reference external" href="https://spureconomics.com/autocorrelation-function-and-stationarity/#:~:text=The%20ACF%20and%20PACF%20plots%20are%20helpful%20in%20determining%20the,models%20to%20decide%20their%20structure.">https://spureconomics.com/autocorrelation-function-and-stationarity/#:~:text=The ACF and PACF plots are helpful in determining the,models to decide their structure.</a><br></p>
<p><a class="reference external" href="https://spureconomics.com/interpreting-acf-and-pacf-plots/">https://spureconomics.com/interpreting-acf-and-pacf-plots/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">statsmodels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: statsmodels in /usr/local/lib/python3.10/dist-packages (0.14.4)
Requirement already satisfied: numpy&lt;3,&gt;=1.22.3 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (1.26.4)
Requirement already satisfied: scipy!=1.9.2,&gt;=1.8 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (1.13.1)
Requirement already satisfied: pandas!=2.1.0,&gt;=1.4 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (2.2.3)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (1.0.1)
Requirement already satisfied: packaging&gt;=21.3 in /usr/local/lib/python3.10/dist-packages (from statsmodels) (24.2)
Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (1.3.8)
Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (1.2.4)
Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (0.1.1)
Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2025.0.1)
Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2022.0.0)
Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2.4.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (2025.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas!=2.1.0,&gt;=1.4-&gt;statsmodels) (1.17.0)
Requirement already satisfied: intel-openmp&gt;=2024 in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2024.2.0)
Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2022.0.0)
Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*-&gt;mkl-&gt;numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (1.2.0)
Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath-&gt;numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2024.2.0)
Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp&gt;=2024-&gt;mkl-&gt;numpy&lt;3,&gt;=1.22.3-&gt;statsmodels) (2024.2.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>

<span class="c1"># Plot ACF</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelation Function (ACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># fft=True is for using Fast Fourier Transform for faster computation</span>

<span class="c1"># Plot PACF</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ywm&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Partial Autocorrelation Function (PACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># method=&quot;ywm&quot; is for using Yule-Walker method for faster computation</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1358ff21c8f3f43e5585e9f9798641017ec30be8fd6003b047efb66dc0047303.png" src="../_images/1358ff21c8f3f43e5585e9f9798641017ec30be8fd6003b047efb66dc0047303.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Different lags number:I wanted to see it fo a long period</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Plot ACF</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelation Function (ACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># fft=True is for using Fast Fourier Transform for faster computation</span>

<span class="c1"># Plot PACF</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ywm&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Partial Autocorrelation Function (PACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># method=&quot;ywm&quot; is for using Yule-Walker method for faster computation</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2ed8fafd768cb8d280ab774ee36e30ca5045fbff26756acaa3542f3814ebcf8e.png" src="../_images/2ed8fafd768cb8d280ab774ee36e30ca5045fbff26756acaa3542f3814ebcf8e.png" />
</div>
</div>
<p>The Series does not seem stationary, ACF has to become 0 at some point. But we are not certainly sure yet.<br></p>
<p>Lets confirm with the ADF and KPSS tests..<br><br></p>
</section>
<section id="adf-and-kpss">
<h3><em><strong>ADF and KPSS</strong></em><br><a class="headerlink" href="#adf-and-kpss" title="Link to this heading">#</a></h3>
<p>To confirm the visual assessments of stationarity (due to trend and seasonality), the Dickey-Fuller and KPSS hypothesis tests are used:<br></p>
<p>Augmented Dickey-Fuller Test (ADF)<br></p>
<p>Null Hypothesis H0: The series is not stationary<br>
Alternative Hypothesis H1: The series is stationary<br><br>
Kwiatkowski-Phillips-Schmidt-Shin Test (KPSS)<br></p>
<p>Null Hypothesis H0: The series is stationary<br>
Alternative Hypothesis H1: The series is not stationary<br><br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span><span class="p">,</span> <span class="n">kpss</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_stationarity2</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">___________________Checking Stationarity for: </span><span class="si">{</span><span class="n">series</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">___________________</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># ADF Test</span>
    <span class="n">adf_test</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Test:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Critical Values:&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1">: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">adf_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">adf_test</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;5%&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u001b</span><span class="s2">[32mSeries is Stationary (ADF Test)</span><span class="se">\u001b</span><span class="s2">[0m&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[31mSeries is Non-stationary (ADF Test)</span><span class="se">\x1b</span><span class="s2">[0m&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># KPSS Test</span>
    <span class="n">kpss_test</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KPSS Test:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KPSS Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kpss_test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kpss_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Critical Values:&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kpss_test</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1">: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">kpss_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u001b</span><span class="s2">[32mSeries is Stationary (KPSS Test)</span><span class="se">\u001b</span><span class="s2">[0m&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[31mSeries is Non-stationary (KPSS Test)</span><span class="se">\x1b</span><span class="s2">[0m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample a smaller subset of the data for stationarity checks</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Check initial stationarity for each feature</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">])</span>  <span class="c1"># target is non stationary!!</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">])</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">])</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">])</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_2&#39;</span><span class="p">])</span>
<span class="n">check_stationarity2</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>___________________Checking Stationarity for: power_factor___________________

ADF Test:

ADF Statistic: -99.162469
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.102124
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>

___________________Checking Stationarity for: voltage___________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:

ADF Statistic: -98.094129
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.239757
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>

___________________Checking Stationarity for: global_intensity___________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:

ADF Statistic: -99.068280
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.042092
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>

___________________Checking Stationarity for: sub_metering_1___________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:

ADF Statistic: -69.243908
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.053618
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>

___________________Checking Stationarity for: sub_metering_2___________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:

ADF Statistic: -57.986412
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.078936
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>

___________________Checking Stationarity for: sub_metering_3___________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:

ADF Statistic: -68.923892
p-value: 0.000000
Critical Values:
	1%: -3.431
	5%: -2.862
	10%: -2.567
<span class=" -Color -Color-Green">Series is Stationary (ADF Test)</span>

--------------------------------------------------

KPSS Test:

KPSS Statistic: 0.130016
p-value: 0.100000
Critical Values:
	10%: 0.347
	5%: 0.463
	2.5%: 0.574
	1%: 0.739
<span class=" -Color -Color-Green">Series is Stationary (KPSS Test)</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-62-81cb300f3b58&gt;:24: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_test = kpss(series.values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span><span class="p">,</span> <span class="n">kpss</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_stationarity</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">series_values</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>  <span class="c1"># Daha hzl eriim iin NumPy array&#39;e evir</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="s2">&quot;_&quot;</span><span class="o">*</span><span class="mi">20</span><span class="si">}</span><span class="s1"> Checking Stationarity for: </span><span class="si">{</span><span class="n">series</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="s2">&quot;_&quot;</span><span class="o">*</span><span class="mi">20</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># ADF Test</span>
    <span class="n">adf_stat</span><span class="p">,</span> <span class="n">adf_p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">adf_crit</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">series_values</span><span class="p">)</span>
    <span class="n">adf_result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[32mStationary</span><span class="se">\033</span><span class="s2">[0m&quot;</span> <span class="k">if</span> <span class="n">adf_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[31mNon-stationary</span><span class="se">\033</span><span class="s2">[0m&quot;</span>

    <span class="c1"># KPSS Test</span>
    <span class="n">kpss_stat</span><span class="p">,</span> <span class="n">kpss_p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">kpss_crit</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">series_values</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">kpss_result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[32mStationary</span><span class="se">\033</span><span class="s2">[0m&quot;</span> <span class="k">if</span> <span class="n">kpss_p</span> <span class="o">&gt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[31mNon-stationary</span><span class="se">\033</span><span class="s2">[0m&quot;</span>

    <span class="c1"># Tek seferde byk string oluturarak yazdr</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;ADF Test:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - ADF Statistic: </span><span class="si">{</span><span class="n">adf_stat</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - p-value: </span><span class="si">{</span><span class="n">adf_p</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - Critical Values: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">adf_crit</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  =&gt; </span><span class="si">{</span><span class="n">adf_result</span><span class="si">}</span><span class="s2"> (ADF Test)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;KPSS Test:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - KPSS Statistic: </span><span class="si">{</span><span class="n">kpss_stat</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - p-value: </span><span class="si">{</span><span class="n">kpss_p</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  - Critical Values: &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kpss_crit</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  =&gt; </span><span class="si">{</span><span class="n">kpss_result</span><span class="si">}</span><span class="s2"> (KPSS Test)</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;voltage&#39;, &#39;global_intensity&#39;, &#39;sub_metering_1&#39;, &#39;sub_metering_2&#39;,
       &#39;sub_metering_3&#39;, &#39;power_factor&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample a smaller subset of the data for stationarity checks</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Check initial stationarity for each feature</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">])</span>  <span class="c1"># target is non stationary!!</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">])</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">])</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">])</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_2&#39;</span><span class="p">])</span>
<span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;sub_metering_3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>____________________ Checking Stationarity for: power_factor ____________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:
  - ADF Statistic: -99.162469
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.102124
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)


____________________ Checking Stationarity for: voltage ____________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:
  - ADF Statistic: -98.094129
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.239757
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)


____________________ Checking Stationarity for: global_intensity ____________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:
  - ADF Statistic: -99.068280
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.042092
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)


____________________ Checking Stationarity for: sub_metering_1 ____________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:
  - ADF Statistic: -69.243908
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.053618
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)


____________________ Checking Stationarity for: sub_metering_2 ____________________
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test:
  - ADF Statistic: -57.986412
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.078936
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)


____________________ Checking Stationarity for: sub_metering_3 ____________________

ADF Test:
  - ADF Statistic: -68.923892
  - p-value: 0.000000
  - Critical Values: 1%: -3.431, 5%: -2.862, 10%: -2.567
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.130016
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-tests-we-performed-showed-that-all-the-features-were-stationary-but-if-they-were-not-stationary-we-would-have-to-apply-the-following-methods">
<h3><em><strong>The tests we performed showed that all the features were stationary, but if they were not stationary, we would have to apply the following methods.</strong></em><br><br><a class="headerlink" href="#the-tests-we-performed-showed-that-all-the-features-were-stationary-but-if-they-were-not-stationary-we-would-have-to-apply-the-following-methods" title="Link to this heading">#</a></h3>
<p><em><strong>Methods to make a time series stationary:</strong></em><br>
Among the methods to make a time series stationary, differencing and detrending are two of the most common:<br></p>
<p><em><strong>Differencing:</strong></em> Taking the difference between consecutive observations helps remove trends and make the series stationary. This method is simple and often effective, especially for time series with a linear trend.<br></p>
<p><em><strong>Detrending:</strong></em> Removing a trend from the time series data is another common approach. This can involve fitting a regression model to the data and subtracting the trend component, or using other techniques like polynomial regression or moving averages to remove trend effects.<br></p>
<p>These methods are widely used because they are relatively straightforward to implement and can effectively address trend-related non-stationarity in time series data.<br></p>
<p><em><strong>Other methods:</strong></em><br>
Seasonal Differencing: Similar to differencing, but instead of taking differences between consecutive observations, take differences between observations separated by the seasonal period.<br></p>
<p><em><strong>Transformation:</strong></em> Apply mathematical transformations to stabilize the variance or make the data more linear. Common transformations include taking the logarithm, square root, or Box-Cox transformation.<br></p>
<p><em><strong>Smoothing:</strong></em> Apply moving averages or exponential smoothing to remove noise and smooth out the data.<br></p>
<p><em><strong>Decomposition:</strong></em> Decompose the time series into its trend, seasonal, and residual components, and then remove the trend and seasonal components.<br></p>
<p><em><strong>Regression:</strong></em> Fit a regression model with exogenous variables (if available) to the time series data and remove the effect of these variables.<br></p>
<p>These methods can be applied individually or in combination, depending on the characteristics of the time series and the specific goals of the analysis. Experimentation and domain knowledge often play a crucial role in selecting the most appropriate method(s) for making a time series stationary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># Reducing computation time</span>
<span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_detrended&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_detrended&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dt
2008-02-16    0.003376
2009-12-11   -0.006231
2007-01-09    0.000000
2008-01-31   -0.012723
2008-04-18   -0.014323
2008-04-17   -0.007599
2008-09-16   -0.004615
2008-10-08   -0.002599
2007-11-12    0.000000
2009-08-17    0.011098
Name: power_factor_deseasonalized, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot ACF</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelation Function (ACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># fft=True is for using Fast Fourier Transform for faster computation</span>

<span class="c1"># Plot PACF</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ywm&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Partial Autocorrelation Function (PACF) for power_factor&#39;</span><span class="p">)</span> <span class="c1"># method=&quot;ywm&quot; is for using Yule-Walker method for faster computation</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f9d65c28023dbd4a9ec5d685bac575b238c8b1078dfb93c73eafcdf766bcf0ee.png" src="../_images/f9d65c28023dbd4a9ec5d685bac575b238c8b1078dfb93c73eafcdf766bcf0ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">check_stationarity</span><span class="p">(</span><span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>____________________ Checking Stationarity for: power_factor_deseasonalized ____________________

ADF Test:
  - ADF Statistic: -9.323281
  - p-value: 0.000000
  - Critical Values: 1%: -3.435, 5%: -2.864, 10%: -2.568
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (ADF Test)

--------------------------------------------------

KPSS Test:
  - KPSS Statistic: 0.139462
  - p-value: 0.100000
  - Critical Values: 10%: 0.347, 5%: 0.463, 2.5%: 0.574, 1%: 0.739
  =&gt; <span class=" -Color -Color-Green">Stationary</span> (KPSS Test)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-bb9af1ee8e72&gt;:14: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpss_stat, kpss_p, _, kpss_crit = kpss(series_values, regression=&#39;c&#39;, nlags=&#39;auto&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="arima-sarima-model-implementation">
<h3><em><strong>5.2.1.2.ARIMA/SARIMA Model Implementation:</strong></em><br><a class="headerlink" href="#arima-sarima-model-implementation" title="Link to this heading">#</a></h3>
<p>The meaning of p, d and q<br>
source: <a class="reference external" href="https://www.kaggle.com/code/prashant111/arima-model-for-time-series-forecasting#4.-AR-and-MA-models-">https://www.kaggle.com/code/prashant111/arima-model-for-time-series-forecasting#4.-AR-and-MA-models-</a></p>
<p>p:
p is the order of the Auto Regressive (AR) term. It refers to the number of lags of Y to be used as predictors.
d:</p>
<p>The term Auto Regressive in ARIMA means it is a linear regression model that uses its own lags as predictors. Linear regression mo**dels, as we know, work best when the predictors are not correlated and are independent of each other. So we need to make the time series stationary.</p>
<p>The most common approach to make the series stationary is to difference it. That is, subtract the previous value from the current value. Sometimes, depending on the complexity of the series, more than one differencing may be needed.</p>
<p>The value of d, therefore, is the minimum number of differencing needed to make the series stationary. If the time series is already stationary, then d = 0.</p>
<p>q:
q is the order of the Moving Average (MA) term. It refers to the number of lagged forecast errors that should go into the ARIMA Model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor_detrended&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor_detrended&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">8760</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 365*24=8760</span>

<span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dt
2007-09-28 07:00:00    0.000000
2007-10-12 12:00:00    0.000000
2008-01-10 11:00:00    0.000131
2007-09-20 21:00:00    0.000000
2010-02-19 10:00:00   -0.000898
Name: power_factor_deseasonalized, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">df_hourly</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Test Statistic:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Test Statistic: -38.311735003367424
p-value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-10-09 09:00:00</th>
      <td>241.1095</td>
      <td>4.76</td>
      <td>0.0</td>
      <td>1.1</td>
      <td>13.616667</td>
      <td>0.976706</td>
      <td>-0.017313</td>
      <td>-0.021354</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">],</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train shape: </span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;First 3 rows&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Last 3 rows&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test shape: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;First 3 rows&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Last 3 rows&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Train shape: (26671, 8)&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;First 3 rows&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:00:00</th>
      <td>234.643889</td>
      <td>18.100000</td>
      <td>0.0</td>
      <td>0.527778</td>
      <td>16.861111</td>
      <td>0.997052</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 18:00:00</th>
      <td>234.580167</td>
      <td>15.600000</td>
      <td>0.0</td>
      <td>6.716667</td>
      <td>16.866667</td>
      <td>0.999518</td>
      <td>0.002466</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 19:00:00</th>
      <td>233.232500</td>
      <td>14.503333</td>
      <td>0.0</td>
      <td>1.433333</td>
      <td>16.683333</td>
      <td>0.999526</td>
      <td>0.000008</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Last 3 rows&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-12-31 21:00:00</th>
      <td>236.641500</td>
      <td>12.100000</td>
      <td>0.0</td>
      <td>0.350000</td>
      <td>18.716667</td>
      <td>0.996828</td>
      <td>-0.001040</td>
      <td>-0.000246</td>
    </tr>
    <tr>
      <th>2009-12-31 22:00:00</th>
      <td>237.913833</td>
      <td>8.520000</td>
      <td>0.0</td>
      <td>0.533333</td>
      <td>17.983333</td>
      <td>0.996412</td>
      <td>-0.000416</td>
      <td>0.003280</td>
    </tr>
    <tr>
      <th>2009-12-31 23:00:00</th>
      <td>240.071333</td>
      <td>6.956667</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>18.316667</td>
      <td>0.996957</td>
      <td>0.000545</td>
      <td>0.013880</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Test shape: (7918, 8)&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;First 3 rows&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01 00:00:00</th>
      <td>241.300000</td>
      <td>4.476667</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.516667</td>
      <td>0.989619</td>
      <td>-0.007338</td>
      <td>-0.017810</td>
    </tr>
    <tr>
      <th>2010-01-01 01:00:00</th>
      <td>241.620667</td>
      <td>2.723333</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>0.650000</td>
      <td>0.971732</td>
      <td>-0.017887</td>
      <td>-0.011808</td>
    </tr>
    <tr>
      <th>2010-01-01 02:00:00</th>
      <td>244.012333</td>
      <td>2.653333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.981504</td>
      <td>0.009772</td>
      <td>0.012361</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Last 3 rows&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-11-26 19:00:00</th>
      <td>236.741</td>
      <td>7.056667</td>
      <td>0.0</td>
      <td>0.066667</td>
      <td>0.0</td>
      <td>0.998706</td>
      <td>0.000348</td>
      <td>0.001102</td>
    </tr>
    <tr>
      <th>2010-11-26 20:00:00</th>
      <td>239.396</td>
      <td>4.913333</td>
      <td>0.0</td>
      <td>1.066667</td>
      <td>0.0</td>
      <td>0.997176</td>
      <td>-0.001530</td>
      <td>-0.002511</td>
    </tr>
    <tr>
      <th>2010-11-26 21:00:00</th>
      <td>239.690</td>
      <td>3.800000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.002824</td>
      <td>-0.000063</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ARIMA</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.arima.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Fit the ARIMA model</span>
<span class="n">arima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># ARIMA(p,d,q)</span>
<span class="n">arima_model_fit</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Make predictions</span>
<span class="n">arima_pred</span> <span class="o">=</span> <span class="n">arima_model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>

<span class="c1"># Calculate error</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">arima_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MSE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">arima_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Difference in power_factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ARIMA Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MSE: 0.001
</pre></div>
</div>
<img alt="../_images/d3ea3aed5b62ae40152bacd3365c02a6137f0a92d824b37fc5c1288a5696b2d8.png" src="../_images/d3ea3aed5b62ae40152bacd3365c02a6137f0a92d824b37fc5c1288a5696b2d8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">arima_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Difference in power_factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ARIMA Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/91b523b1580ab21db06ef6a5ae99db22859f9c2cc1ddba939c254f930bfabc73.png" src="../_images/91b523b1580ab21db06ef6a5ae99db22859f9c2cc1ddba939c254f930bfabc73.png" />
</div>
</div>
</section>
<section id="of-course-this-is-not-a-result-to-be-taken-seriously">
<h3><em><strong>Of course, this is not a result to be taken seriously.</strong></em><a class="headerlink" href="#of-course-this-is-not-a-result-to-be-taken-seriously" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ARIMA</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.arima.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Fit the ARIMA model</span>
<span class="n">arima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># ARIMA(p,d,q)</span>
<span class="n">arima_model_fit</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Make predictions</span>
<span class="n">arima_pred</span> <span class="o">=</span> <span class="n">arima_model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>

<span class="c1"># Calculate error</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">],</span> <span class="n">arima_pred</span><span class="p">)</span>
<span class="n">p_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">arima_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p_error</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor_deseasonalized&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">arima_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Difference in power_factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ARIMA Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MAE: 0.031
Test MAPE: 100.072
</pre></div>
</div>
<img alt="../_images/bce92c5f9928a5b5d9240b79bffb50a5f8b860bd8e9071152ace50f7249ff87e.png" src="../_images/bce92c5f9928a5b5d9240b79bffb50a5f8b860bd8e9071152ace50f7249ff87e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_pred</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2010-01-01 00:00:00   -0.011235
2010-01-01 01:00:00   -0.003638
2010-01-01 02:00:00   -0.001181
2010-01-01 03:00:00   -0.000385
2010-01-01 04:00:00   -0.000128
2010-01-01 05:00:00   -0.000045
2010-01-01 06:00:00   -0.000018
2010-01-01 07:00:00   -0.000009
2010-01-01 08:00:00   -0.000006
2010-01-01 09:00:00   -0.000006
Freq: h, Name: predicted_mean, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor_deseasonalized&quot;</span><span class="p">],</span> 
    <span class="n">arima_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">error_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor_deseasonalized&quot;</span><span class="p">])</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">arima_pred</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor_deseasonalized&quot;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">compare_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;actual&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">]</span>
<span class="n">compare_df</span><span class="p">[</span><span class="s2">&quot;error_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">error_p</span>
<span class="n">compare_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual</th>
      <th>pred</th>
      <th>error_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01 00:00:00</th>
      <td>-0.017810</td>
      <td>-0.011235</td>
      <td>36.919460</td>
    </tr>
    <tr>
      <th>2010-01-01 01:00:00</th>
      <td>-0.011808</td>
      <td>-0.003638</td>
      <td>69.187105</td>
    </tr>
    <tr>
      <th>2010-01-01 02:00:00</th>
      <td>0.012361</td>
      <td>-0.001181</td>
      <td>90.447853</td>
    </tr>
    <tr>
      <th>2010-01-01 03:00:00</th>
      <td>-0.005995</td>
      <td>-0.000385</td>
      <td>93.569974</td>
    </tr>
    <tr>
      <th>2010-01-01 04:00:00</th>
      <td>-0.011741</td>
      <td>-0.000128</td>
      <td>98.908173</td>
    </tr>
    <tr>
      <th>2010-01-01 05:00:00</th>
      <td>0.011308</td>
      <td>-0.000045</td>
      <td>99.602648</td>
    </tr>
    <tr>
      <th>2010-01-01 06:00:00</th>
      <td>0.000620</td>
      <td>-0.000018</td>
      <td>97.099473</td>
    </tr>
    <tr>
      <th>2010-01-01 07:00:00</th>
      <td>0.004813</td>
      <td>-0.000009</td>
      <td>99.807130</td>
    </tr>
    <tr>
      <th>2010-01-01 08:00:00</th>
      <td>-0.016831</td>
      <td>-0.000006</td>
      <td>99.961608</td>
    </tr>
    <tr>
      <th>2010-01-01 09:00:00</th>
      <td>0.014022</td>
      <td>-0.000006</td>
      <td>99.960423</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">compare_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;arima_prediction_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#train-test split in daily data</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="n">df_daily</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">],</span> <span class="n">df_daily</span><span class="p">[</span><span class="n">df_daily</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train shape: </span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test shape: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Train shape: (1112, 8)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16</th>
      <td>236.243763</td>
      <td>13.082828</td>
      <td>0.000000</td>
      <td>1.378788</td>
      <td>12.439394</td>
      <td>0.998768</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-17</th>
      <td>240.087028</td>
      <td>9.999028</td>
      <td>1.411806</td>
      <td>2.907639</td>
      <td>9.264583</td>
      <td>0.988401</td>
      <td>-0.010367</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-18</th>
      <td>241.231694</td>
      <td>6.421667</td>
      <td>0.738194</td>
      <td>1.820139</td>
      <td>9.734722</td>
      <td>0.976834</td>
      <td>-0.011568</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-19</th>
      <td>241.999313</td>
      <td>4.926389</td>
      <td>0.582639</td>
      <td>5.279167</td>
      <td>4.303472</td>
      <td>0.973061</td>
      <td>-0.003773</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-20</th>
      <td>242.308062</td>
      <td>6.467361</td>
      <td>0.000000</td>
      <td>1.838889</td>
      <td>9.765972</td>
      <td>0.978983</td>
      <td>0.005922</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Test shape: (330, 8)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>242.565722</td>
      <td>3.537083</td>
      <td>1.600000</td>
      <td>0.227083</td>
      <td>2.470833</td>
      <td>0.976637</td>
      <td>-0.005780</td>
      <td>-0.005575</td>
    </tr>
    <tr>
      <th>2010-01-02</th>
      <td>244.674514</td>
      <td>3.814325</td>
      <td>0.557029</td>
      <td>0.207846</td>
      <td>4.465596</td>
      <td>0.962314</td>
      <td>-0.014323</td>
      <td>-0.013142</td>
    </tr>
    <tr>
      <th>2010-01-03</th>
      <td>243.744528</td>
      <td>6.044167</td>
      <td>2.668056</td>
      <td>3.416667</td>
      <td>6.995833</td>
      <td>0.980319</td>
      <td>0.018005</td>
      <td>0.021778</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>245.699118</td>
      <td>4.599444</td>
      <td>0.000000</td>
      <td>0.202778</td>
      <td>7.508333</td>
      <td>0.979383</td>
      <td>-0.000936</td>
      <td>-0.008604</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>244.521035</td>
      <td>6.347083</td>
      <td>1.239583</td>
      <td>0.203472</td>
      <td>11.436111</td>
      <td>0.987479</td>
      <td>0.008096</td>
      <td>0.012874</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMAX for daily data</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.statespace.sarimax</span><span class="w"> </span><span class="kn">import</span> <span class="n">SARIMAX</span>

<span class="c1"># Define the SARIMA model parameters</span>
<span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># Non-seasonal order (p, d, q), non-seasonal order is stated for daily seasonality</span>
<span class="n">seasonal_order</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>  <span class="c1"># Seasonal order (P, D, Q, S) , S is the seasonal period, seasonal order is for weekly seasonality</span>

<span class="c1"># Fit the SARIMA model</span>
<span class="n">sarima_model</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">exog</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]],</span>
                       <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="n">seasonal_order</span><span class="p">)</span> <span class="c1"># exog is for exogenous variables for better prediction</span>
<span class="n">sarima_model_fit</span> <span class="o">=</span> <span class="n">sarima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Make predictions</span>
<span class="n">sarima_pred</span> <span class="o">=</span> <span class="n">sarima_model_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="n">exog</span><span class="o">=</span><span class="n">test</span><span class="p">[[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]])</span>

<span class="c1"># Calculate error</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">sarima_pred</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span> <span class="o">-</span>
                          <span class="n">sarima_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE:&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.2f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sarima_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SARIMA Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;power_factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SARIMA Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MAE: 0.016361095916095716
Test MAPE: 1.72%
</pre></div>
</div>
<img alt="../_images/9fe7e608bed0c225fbc4ddafd564a36715e15e3f6a256e974ec46db216d7b7ec.png" src="../_images/9fe7e608bed0c225fbc4ddafd564a36715e15e3f6a256e974ec46db216d7b7ec.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_sarima</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">],</span> 
    <span class="n">sarima_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sarima_error_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">])</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sarima_pred</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">compare_df_sarima</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;actual&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">]</span>
<span class="n">compare_df_sarima</span><span class="p">[</span><span class="s2">&quot;error_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sarima_error_p</span>
<span class="n">compare_df_sarima</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual</th>
      <th>pred</th>
      <th>error_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>0.976637</td>
      <td>0.968136</td>
      <td>0.870441</td>
    </tr>
    <tr>
      <th>2010-01-02</th>
      <td>0.962314</td>
      <td>0.966480</td>
      <td>-0.432925</td>
    </tr>
    <tr>
      <th>2010-01-03</th>
      <td>0.980319</td>
      <td>0.972409</td>
      <td>0.806951</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>0.979383</td>
      <td>0.971056</td>
      <td>0.850250</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>0.987479</td>
      <td>0.980067</td>
      <td>0.750582</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>0.977991</td>
      <td>0.973359</td>
      <td>0.473679</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>0.985284</td>
      <td>0.975013</td>
      <td>1.042377</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>0.979753</td>
      <td>0.978158</td>
      <td>0.162740</td>
    </tr>
    <tr>
      <th>2010-01-09</th>
      <td>0.979505</td>
      <td>0.979074</td>
      <td>0.044080</td>
    </tr>
    <tr>
      <th>2010-01-10</th>
      <td>0.983898</td>
      <td>0.978889</td>
      <td>0.509126</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_sarima</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;sarima_prediction_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">],</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train shape: </span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test shape: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Train shape: (26671, 8)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:00:00</th>
      <td>234.643889</td>
      <td>18.100000</td>
      <td>0.0</td>
      <td>0.527778</td>
      <td>16.861111</td>
      <td>0.997052</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 18:00:00</th>
      <td>234.580167</td>
      <td>15.600000</td>
      <td>0.0</td>
      <td>6.716667</td>
      <td>16.866667</td>
      <td>0.999518</td>
      <td>0.002466</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 19:00:00</th>
      <td>233.232500</td>
      <td>14.503333</td>
      <td>0.0</td>
      <td>1.433333</td>
      <td>16.683333</td>
      <td>0.999526</td>
      <td>0.000008</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 20:00:00</th>
      <td>234.071500</td>
      <td>13.916667</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>16.783333</td>
      <td>0.999569</td>
      <td>0.000043</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-16 21:00:00</th>
      <td>237.158667</td>
      <td>13.046667</td>
      <td>0.0</td>
      <td>0.416667</td>
      <td>17.216667</td>
      <td>0.999422</td>
      <td>-0.000147</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Test shape: (7918, 8)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01 00:00:00</th>
      <td>241.300000</td>
      <td>4.476667</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>8.516667</td>
      <td>0.989619</td>
      <td>-0.007338</td>
      <td>-0.017810</td>
    </tr>
    <tr>
      <th>2010-01-01 01:00:00</th>
      <td>241.620667</td>
      <td>2.723333</td>
      <td>0.0</td>
      <td>0.80</td>
      <td>0.650000</td>
      <td>0.971732</td>
      <td>-0.017887</td>
      <td>-0.011808</td>
    </tr>
    <tr>
      <th>2010-01-01 02:00:00</th>
      <td>244.012333</td>
      <td>2.653333</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>0.981504</td>
      <td>0.009772</td>
      <td>0.012361</td>
    </tr>
    <tr>
      <th>2010-01-01 03:00:00</th>
      <td>244.063833</td>
      <td>2.706667</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.383333</td>
      <td>0.985577</td>
      <td>0.004073</td>
      <td>-0.005995</td>
    </tr>
    <tr>
      <th>2010-01-01 04:00:00</th>
      <td>241.649333</td>
      <td>2.686667</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.666667</td>
      <td>0.973772</td>
      <td>-0.011805</td>
      <td>-0.011741</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pmdarima</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pmdarima
  Downloading pmdarima-2.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_28_x86_64.whl.metadata (7.8 kB)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (1.4.2)
Requirement already satisfied: Cython!=0.29.18,!=0.29.31,&gt;=0.29 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (3.0.11)
Requirement already satisfied: numpy&gt;=1.21.2 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (1.26.4)
Requirement already satisfied: pandas&gt;=0.19 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (2.2.3)
Requirement already satisfied: scikit-learn&gt;=0.22 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (1.2.2)
Requirement already satisfied: scipy&gt;=1.3.2 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (1.13.1)
Requirement already satisfied: statsmodels&gt;=0.13.2 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (0.14.4)
Requirement already satisfied: urllib3 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (2.3.0)
Requirement already satisfied: setuptools!=50.0.0,&gt;=38.6.0 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (75.1.0)
Requirement already satisfied: packaging&gt;=17.1 in /usr/local/lib/python3.10/dist-packages (from pmdarima) (24.2)
Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (1.3.8)
Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (1.2.4)
Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (0.1.1)
Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (2025.0.1)
Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (2022.0.0)
Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.21.2-&gt;pmdarima) (2.4.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=0.19-&gt;pmdarima) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=0.19-&gt;pmdarima) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=0.19-&gt;pmdarima) (2025.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22-&gt;pmdarima) (3.5.0)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.10/dist-packages (from statsmodels&gt;=0.13.2-&gt;pmdarima) (1.0.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=0.19-&gt;pmdarima) (1.17.0)
Requirement already satisfied: intel-openmp&gt;=2024 in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.21.2-&gt;pmdarima) (2024.2.0)
Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.21.2-&gt;pmdarima) (2022.0.0)
Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*-&gt;mkl-&gt;numpy&gt;=1.21.2-&gt;pmdarima) (1.2.0)
Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath-&gt;numpy&gt;=1.21.2-&gt;pmdarima) (2024.2.0)
Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp&gt;=2024-&gt;mkl-&gt;numpy&gt;=1.21.2-&gt;pmdarima) (2024.2.0)
Downloading pmdarima-2.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_28_x86_64.whl (2.1 MB)
    <span class=" -Color -Color-Green">2.1/2.1 MB</span> <span class=" -Color -Color-Red">34.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>a <span class=" -Color -Color-Cyan">0:00:01</span>
?25hInstalling collected packages: pmdarima
Successfully installed pmdarima-2.0.4
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_monthly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span> <span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01&#39;</span><span class="p">],</span> <span class="n">df_monthly</span><span class="p">[</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01&#39;</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train shape: </span><span class="si">{</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test shape: </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Train shape: (37, 6)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-31</th>
      <td>241.441016</td>
      <td>8.029338</td>
      <td>1.248613</td>
      <td>2.214821</td>
      <td>7.409385</td>
      <td>0.980056</td>
    </tr>
    <tr>
      <th>2007-01-31</th>
      <td>240.905098</td>
      <td>6.546829</td>
      <td>1.264230</td>
      <td>1.775909</td>
      <td>7.383309</td>
      <td>0.974331</td>
    </tr>
    <tr>
      <th>2007-02-28</th>
      <td>240.519406</td>
      <td>5.914505</td>
      <td>1.180214</td>
      <td>1.602346</td>
      <td>6.703545</td>
      <td>0.976610</td>
    </tr>
    <tr>
      <th>2007-03-31</th>
      <td>240.513476</td>
      <td>5.572958</td>
      <td>1.361338</td>
      <td>2.346848</td>
      <td>6.504647</td>
      <td>0.976222</td>
    </tr>
    <tr>
      <th>2007-04-30</th>
      <td>239.524112</td>
      <td>3.894800</td>
      <td>1.070716</td>
      <td>1.001190</td>
      <td>4.943236</td>
      <td>0.958359</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Test shape: (11, 6)&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-31</th>
      <td>243.272051</td>
      <td>5.853242</td>
      <td>1.285837</td>
      <td>1.358281</td>
      <td>9.322007</td>
      <td>0.981412</td>
    </tr>
    <tr>
      <th>2010-02-28</th>
      <td>242.348036</td>
      <td>5.715686</td>
      <td>1.221980</td>
      <td>1.329181</td>
      <td>10.211481</td>
      <td>0.986177</td>
    </tr>
    <tr>
      <th>2010-03-31</th>
      <td>241.940840</td>
      <td>4.725481</td>
      <td>0.836988</td>
      <td>1.422583</td>
      <td>7.559213</td>
      <td>0.976265</td>
    </tr>
    <tr>
      <th>2010-04-30</th>
      <td>241.782776</td>
      <td>4.305200</td>
      <td>0.884193</td>
      <td>0.844382</td>
      <td>7.780034</td>
      <td>0.972786</td>
    </tr>
    <tr>
      <th>2010-05-31</th>
      <td>240.369182</td>
      <td>4.630870</td>
      <td>1.077691</td>
      <td>1.173327</td>
      <td>8.168267</td>
      <td>0.976730</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Auto ARIMA for gridsearch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pmdarima</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">auto_arima</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span>
                      <span class="n">seasonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">m</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>  <span class="c1"># seasonality period</span>
                      <span class="n">max_p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                      <span class="n">max_d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">max_q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="n">max_P</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="n">max_D</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">max_Q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">stepwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">trace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># To print the progress of the fitting</span>
                      <span class="n">error_action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span>  <span class="c1"># Ignore potential errors</span>
                      <span class="n">uppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Suppress warnings</span>
                      <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Use all available CPU cores</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1">#Make predictions</span>
<span class="n">n_periods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">auto_arima_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n_periods</span><span class="o">=</span><span class="n">n_periods</span><span class="p">)</span>

<span class="c1"># Calculate error</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">auto_arima_pred</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span> <span class="o">-</span>
                          <span class="n">auto_arima_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE:&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.2f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">auto_arima_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Auto_Arima Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;power_factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Auto_Arima Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing stepwise search to minimize aic
 ARIMA(2,0,2)(1,0,1)[12] intercept   : AIC=-167.870, Time=0.58 sec
 ARIMA(0,0,0)(0,0,0)[12] intercept   : AIC=-157.186, Time=0.02 sec
 ARIMA(1,0,0)(1,0,0)[12] intercept   : AIC=-173.133, Time=0.21 sec
 ARIMA(0,0,1)(0,0,1)[12] intercept   : AIC=-170.581, Time=0.10 sec
 ARIMA(0,0,0)(0,0,0)[12]             : AIC=104.239, Time=0.01 sec
 ARIMA(1,0,0)(0,0,0)[12] intercept   : AIC=-165.852, Time=0.05 sec
 ARIMA(1,0,0)(2,0,0)[12] intercept   : AIC=inf, Time=0.70 sec
 ARIMA(1,0,0)(1,0,1)[12] intercept   : AIC=inf, Time=0.29 sec
 ARIMA(1,0,0)(0,0,1)[12] intercept   : AIC=-170.973, Time=0.15 sec
 ARIMA(1,0,0)(2,0,1)[12] intercept   : AIC=-169.352, Time=0.73 sec
 ARIMA(0,0,0)(1,0,0)[12] intercept   : AIC=-174.828, Time=0.27 sec
 ARIMA(0,0,0)(2,0,0)[12] intercept   : AIC=inf, Time=0.42 sec
 ARIMA(0,0,0)(1,0,1)[12] intercept   : AIC=-169.866, Time=0.24 sec
 ARIMA(0,0,0)(0,0,1)[12] intercept   : AIC=inf, Time=0.10 sec
 ARIMA(0,0,0)(2,0,1)[12] intercept   : AIC=-173.114, Time=0.61 sec
 ARIMA(0,0,1)(1,0,0)[12] intercept   : AIC=-173.097, Time=0.34 sec
 ARIMA(1,0,1)(1,0,0)[12] intercept   : AIC=-171.127, Time=0.28 sec
 ARIMA(0,0,0)(1,0,0)[12]             : AIC=inf, Time=0.11 sec

Best model:  ARIMA(0,0,0)(1,0,0)[12] intercept
Total fit time: 5.249 seconds
                                SARIMAX Results                                 
================================================================================
Dep. Variable:                        y   No. Observations:                   37
Model:             SARIMAX(1, 0, 0, 12)   Log Likelihood                  90.414
Date:                  Thu, 27 Feb 2025   AIC                           -174.828
Time:                          19:07:24   BIC                           -169.995
Sample:                      12-31-2006   HQIC                          -173.124
                           - 12-31-2009                                         
Covariance Type:                    opg                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
intercept      0.3071      0.182      1.689      0.091      -0.049       0.664
ar.S.L12       0.6810      0.190      3.592      0.000       0.309       1.053
sigma2         0.0004    6.4e-05      5.639      0.000       0.000       0.000
===================================================================================
Ljung-Box (L1) (Q):                   0.12   Jarque-Bera (JB):               171.72
Prob(Q):                              0.72   Prob(JB):                         0.00
Heteroskedasticity (H):               1.00   Skew:                            -2.74
Prob(H) (two-sided):                  1.00   Kurtosis:                        12.02
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
Test MAE: 0.007717126051122867
Test MAPE: 0.80%
</pre></div>
</div>
<img alt="../_images/7098759d4b5b93d1699f30eee74c4b4195a6913a37e3a3b24e22e39ab852ef25.png" src="../_images/7098759d4b5b93d1699f30eee74c4b4195a6913a37e3a3b24e22e39ab852ef25.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>             <td>y</td>          <th>  No. Observations:  </th>    <td>37</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 0, 0, 12)</td> <th>  Log Likelihood     </th>  <td>90.414</td> 
</tr>
<tr>
  <th>Date:</th>              <td>Thu, 27 Feb 2025</td>   <th>  AIC                </th> <td>-174.828</td>
</tr>
<tr>
  <th>Time:</th>                  <td>19:07:33</td>       <th>  BIC                </th> <td>-169.995</td>
</tr>
<tr>
  <th>Sample:</th>               <td>12-31-2006</td>      <th>  HQIC               </th> <td>-173.124</td>
</tr>
<tr>
  <th></th>                     <td>- 12-31-2009</td>     <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>          <td>opg</td>         <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    0.3071</td> <td>    0.182</td> <td>    1.689</td> <td> 0.091</td> <td>   -0.049</td> <td>    0.664</td>
</tr>
<tr>
  <th>ar.S.L12</th>  <td>    0.6810</td> <td>    0.190</td> <td>    3.592</td> <td> 0.000</td> <td>    0.309</td> <td>    1.053</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0004</td> <td>  6.4e-05</td> <td>    5.639</td> <td> 0.000</td> <td>    0.000</td> <td>    0.000</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (L1) (Q):</th>     <td>0.12</td> <th>  Jarque-Bera (JB):  </th> <td>171.72</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.72</td> <th>  Prob(JB):          </th>  <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>1.00</td> <th>  Skew:              </th>  <td>-2.74</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>1.00</td> <th>  Kurtosis:          </th>  <td>12.02</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mevsimsel olmayan parametreleri (p, d, q):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mevsimsel parametreleri (P, D, Q, m):&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">seasonal_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mevsimsel olmayan parametreleri (p, d, q): (0, 0, 0)
Mevsimsel parametreleri (P, D, Q, m): (1, 0, 0, 12)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_auto_arima</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">],</span> 
    <span class="n">auto_arima_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">autoarima_error_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">])</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sarima_pred</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s2">&quot;power_factor&quot;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">compare_df_auto_arima</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;actual&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">]</span>
<span class="n">compare_df_auto_arima</span><span class="p">[</span><span class="s2">&quot;error_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">autoarima_error_p</span>
<span class="n">compare_df_auto_arima</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual</th>
      <th>pred</th>
      <th>error_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-31</th>
      <td>0.981412</td>
      <td>0.978887</td>
      <td>0.958715</td>
    </tr>
    <tr>
      <th>2010-02-28</th>
      <td>0.986177</td>
      <td>0.977502</td>
      <td>2.665857</td>
    </tr>
    <tr>
      <th>2010-03-31</th>
      <td>0.976265</td>
      <td>0.976480</td>
      <td>-0.687787</td>
    </tr>
    <tr>
      <th>2010-04-30</th>
      <td>0.972786</td>
      <td>0.973170</td>
      <td>-0.190512</td>
    </tr>
    <tr>
      <th>2010-05-31</th>
      <td>0.976730</td>
      <td>0.969564</td>
      <td>-0.030766</td>
    </tr>
    <tr>
      <th>2010-06-30</th>
      <td>0.957170</td>
      <td>0.957883</td>
      <td>-2.638387</td>
    </tr>
    <tr>
      <th>2010-07-31</th>
      <td>0.938410</td>
      <td>0.929360</td>
      <td>-3.517225</td>
    </tr>
    <tr>
      <th>2010-08-31</th>
      <td>0.950073</td>
      <td>0.923815</td>
      <td>-3.791912</td>
    </tr>
    <tr>
      <th>2010-09-30</th>
      <td>0.968758</td>
      <td>0.952580</td>
      <td>-2.025771</td>
    </tr>
    <tr>
      <th>2010-10-31</th>
      <td>0.974951</td>
      <td>0.967953</td>
      <td>-1.289817</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_auto_arima</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;auto_arima_prediction_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#In a good model, the residuals should look like white noise (random).</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">())</span>

<span class="n">max_acf_lags</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># Safe lag value for ACF</span>
<span class="n">max_pacf_lags</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># Safe lag value for PACF</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">max_acf_lags</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">max_pacf_lags</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c7b08e150c9960ab1ae10155daaea34511ba12e9bc25d4ef744fb5bc67485d6.png" src="../_images/7c7b08e150c9960ab1ae10155daaea34511ba12e9bc25d4ef744fb5bc67485d6.png" />
<img alt="../_images/613fcd12a269a91821bc0d33ec8442be75123ab1045a49aeb7767cbb067230f5.png" src="../_images/613fcd12a269a91821bc0d33ec8442be75123ab1045a49aeb7767cbb067230f5.png" />
<img alt="../_images/7c7b08e150c9960ab1ae10155daaea34511ba12e9bc25d4ef744fb5bc67485d6.png" src="../_images/7c7b08e150c9960ab1ae10155daaea34511ba12e9bc25d4ef744fb5bc67485d6.png" />
</div>
</div>
<p>This expression means that a good model produces residuals (the differences between the observed values and the predicted values) that represent random noise (white noise), i.e., the model has captured all the patterns in the data and there are no remaining systematic patterns in the residuals.<br></p>
<p>Explanation:<br>
Model Residuals: Residuals are the differences between the observed values and the predicted values of the model. Mathematically, this is expressed as:<br></p>
<p>Residual = ActualValue  PredictedValue<br></p>
<p><em><strong>White Noise:</strong></em> White noise is a random process where there is no correlation between successive observations. It typically has a mean of zero and a constant variance.<br></p>
<p>In other words, white noise:<br></p>
<ul class="simple">
<li><p>Is random: There is no relationship between previous observations and the current observation.<br></p></li>
<li><p>Has zero mean and constant variance.<br></p></li>
<li><p>Has no autocorrelation: The previous values in a time series do not have predictive power for the future values.<br>
<em><strong>What Does Good Model Mean?</strong></em> <br>
A good time series model means that it has accurately explained the data and the residuals should behave like random white noise. In this case, the model:<br></p></li>
</ul>
<ul class="simple">
<li><p>Has correctly captured the patterns in the data.<br></p></li>
<li><p>The errors are purely random, with no further structure.<br>
<em><strong>Residuals Acting Like White Noise:</strong></em> <br>
If the residuals of a model behave like white noise:<br></p></li>
<li><p>The model is adequate: The model has learned the relationships in the data correctly, and there are only random errors left.<br>
<em><strong>If the residuals do not behave like white noise, the model:</strong></em></p></li>
<li><p>May not have captured meaningful patterns in the data.</p></li>
<li><p>Might need improvement (such as selecting a different model or tuning hyperparameters).
Additionally, to check if the residuals behave like white noise, methods like autocorrelation (ACF and PACF plots) are used. These plots help in assessing whether the model has made accurate predictions or not.</p></li>
</ul>
</section>
</section>
<section id="prophet-model">
<h2><em><strong>5.2.2.Prophet Model</strong></em><a class="headerlink" href="#prophet-model" title="Link to this heading">#</a></h2>
<p>Prophet is an open-source library for univariate (one variable) time series forecasting developed by Facebook. It works best with time series that have strong seasonal effects and several seasons of historical data</p>
<p>Official Documentation: <a class="reference external" href="https://facebook.github.io/prophet/docs/quick_start.html">here</a></p>
<p>Helpful Resources:</p>
<p><a class="reference external" href="https://machinelearningmastery.com/time-series-forecasting-with-prophet-in-python/">https://machinelearningmastery.com/time-series-forecasting-with-prophet-in-python/</a>
<a class="reference external" href="https://www.kaggle.com/code/prashant111/tutorial-time-series-forecasting-with-prophet/notebook">https://www.kaggle.com/code/prashant111/tutorial-time-series-forecasting-with-prophet/notebook</a></p>
<p>Prophet algorithm works with the ds and y variables as inputs. We will adjust our training and test sets accordingly.<br></p>
<p><em><strong>ds:</strong></em> This column contains the dates. In Prophet, the dates in this column are typically in daily frequency, although this is not mandatory. The dates can be in the format YYYY-MM-DD (e.g., 2021-01-01) or in timestamp format.<br></p>
<p><em><strong>y:</strong></em> This column contains the observed values you want to predict. For example, if you want to forecast the daily number of visitors to a website, the y column will contain these visitor numbers.<br></p>
<p><em><strong>yhat:</strong></em> This is the main value predicted by the model. In other words, it is the value that your model predicts the time series will be for a specific ds (date) value.<br></p>
<p><em><strong>yhat_lower and yhat_upper:</strong></em> These values represent the uncertainty interval of the predictions. Prophet takes into account uncertainty when making predictions, estimating with high confidence that the true value will fall within this range. For example, if yhat_lower is 50 and yhat_upper is 60, it means that the model confidently predicts that the true value will be within this range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:24:00</th>
      <td>234.84</td>
      <td>18.4</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995121</td>
    </tr>
    <tr>
      <th>2006-12-16 17:25:00</th>
      <td>233.63</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>0.996708</td>
    </tr>
    <tr>
      <th>2006-12-16 17:26:00</th>
      <td>233.29</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>0.995734</td>
    </tr>
    <tr>
      <th>2006-12-16 17:27:00</th>
      <td>233.74</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.995688</td>
    </tr>
    <tr>
      <th>2006-12-16 17:28:00</th>
      <td>235.68</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.989787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1442, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16</th>
      <td>236.243763</td>
      <td>13.082828</td>
      <td>0.000000</td>
      <td>1.378788</td>
      <td>12.439394</td>
      <td>0.998768</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-17</th>
      <td>240.087028</td>
      <td>9.999028</td>
      <td>1.411806</td>
      <td>2.907639</td>
      <td>9.264583</td>
      <td>0.988401</td>
      <td>-0.010367</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-18</th>
      <td>241.231694</td>
      <td>6.421667</td>
      <td>0.738194</td>
      <td>1.820139</td>
      <td>9.734722</td>
      <td>0.976834</td>
      <td>-0.011568</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-19</th>
      <td>241.999313</td>
      <td>4.926389</td>
      <td>0.582639</td>
      <td>5.279167</td>
      <td>4.303472</td>
      <td>0.973061</td>
      <td>-0.003773</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2006-12-20</th>
      <td>242.308062</td>
      <td>6.467361</td>
      <td>0.000000</td>
      <td>1.838889</td>
      <td>9.765972</td>
      <td>0.978983</td>
      <td>0.005922</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">prophet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: prophet in /usr/local/lib/python3.10/dist-packages (1.1.6)
Requirement already satisfied: cmdstanpy&gt;=1.0.4 in /usr/local/lib/python3.10/dist-packages (from prophet) (1.2.5)
Requirement already satisfied: numpy&gt;=1.15.4 in /usr/local/lib/python3.10/dist-packages (from prophet) (1.26.4)
Requirement already satisfied: matplotlib&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from prophet) (3.7.5)
Requirement already satisfied: pandas&gt;=1.0.4 in /usr/local/lib/python3.10/dist-packages (from prophet) (2.2.3)
Requirement already satisfied: holidays&lt;1,&gt;=0.25 in /usr/local/lib/python3.10/dist-packages (from prophet) (0.63)
Requirement already satisfied: tqdm&gt;=4.36.1 in /usr/local/lib/python3.10/dist-packages (from prophet) (4.67.1)
Requirement already satisfied: importlib-resources in /usr/local/lib/python3.10/dist-packages (from prophet) (5.13.0)
Requirement already satisfied: stanio&lt;2.0.0,&gt;=0.4.0 in /usr/local/lib/python3.10/dist-packages (from cmdstanpy&gt;=1.0.4-&gt;prophet) (0.5.1)
Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/dist-packages (from holidays&lt;1,&gt;=0.25-&gt;prophet) (2.9.0.post0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (4.55.3)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (1.4.7)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (24.2)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (11.0.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=2.0.0-&gt;prophet) (3.2.0)
Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (1.3.8)
Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (1.2.4)
Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (0.1.1)
Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (2025.0.1)
Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (2022.0.0)
Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy&gt;=1.15.4-&gt;prophet) (2.4.1)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.4-&gt;prophet) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.4-&gt;prophet) (2025.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil-&gt;holidays&lt;1,&gt;=0.25-&gt;prophet) (1.17.0)
Requirement already satisfied: intel-openmp&gt;=2024 in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.15.4-&gt;prophet) (2024.2.0)
Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy&gt;=1.15.4-&gt;prophet) (2022.0.0)
Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*-&gt;mkl-&gt;numpy&gt;=1.15.4-&gt;prophet) (1.2.0)
Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath-&gt;numpy&gt;=1.15.4-&gt;prophet) (2024.2.0)
Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp&gt;=2024-&gt;mkl-&gt;numpy&gt;=1.15.4-&gt;prophet) (2024.2.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Due to the power_factor values, the result in the MAPE calculation is NaN. To prevent this, I wanted to use the WMAPE metric,</span>
<span class="c1"># so I calculated the metric in a way that zero or very close to zero values would not cause problems.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">wmape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Weighted Mean Absolute Percentage Error (WMAPE).</span>

<span class="sd">    Args:</span>
<span class="sd">        y_true: The actual values.</span>
<span class="sd">        y_pred: The predicted values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The WMAPE as a percentage.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure input arrays are NumPy arrays for element-wise operations</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Calculate absolute errors</span>
    <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Calculate weighted absolute percentage errors</span>
    <span class="n">weighted_absolute_percentage_errors</span> <span class="o">=</span> <span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">)</span>

    <span class="c1"># Handle zero values in y_true to avoid division by zero</span>
    <span class="n">weighted_absolute_percentage_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">weighted_absolute_percentage_errors</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">posinf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">neginf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="c1"># Calculate the WMAPE</span>
    <span class="n">wmape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">absolute_errors</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="k">return</span> <span class="n">wmape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Rename columns for Prophet</span>
<span class="n">df_prophet</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;power_factor&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>

<span class="c1"># Split the data into training and testing sets</span>

<span class="n">p_train</span><span class="p">,</span> <span class="n">p_test</span> <span class="o">=</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">],</span><span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">]</span>
<span class="n">p_test</span> <span class="o">=</span> <span class="n">p_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span>

<span class="c1"># Initialize and fit the Prophet model</span>
<span class="n">prop_model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="n">seasonality_mode</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span><span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">prop_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">p_train</span><span class="p">)</span>

<span class="c1"># Make future dataframe</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">p_test</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="c1"># Make predictions</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

<span class="c1"># Extract the forecasted values for the test period</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">predicted</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>


<span class="c1"># Calculate error</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">wmape</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mae</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:15:27 - cmdstanpy - INFO - Chain [1] start processing
19:15:27 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MAE: 0.020
Test MAPE: 2.064%
</pre></div>
</div>
<img alt="../_images/6088c8b4c1490b1493ac1dc8782f32ab2d130a00a26e58079c0ed0ee015a0ad4.png" src="../_images/6088c8b4c1490b1493ac1dc8782f32ab2d130a00a26e58079c0ed0ee015a0ad4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(34589, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16 17:00:00</th>
      <td>234.643889</td>
      <td>18.1</td>
      <td>0.0</td>
      <td>0.527778</td>
      <td>16.861111</td>
      <td>0.997052</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>

<span class="c1"># Rename columns for Prophet</span>
<span class="n">df_prophet</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;power_factor&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>

<span class="c1"># Split the data into training and testing sets</span>

<span class="n">p_train</span><span class="p">,</span> <span class="n">p_test</span> <span class="o">=</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">]</span>


<span class="c1"># Initialize and fit the Prophet model with additional features</span>
<span class="n">prop_model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">()</span>

<span class="n">prop_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">p_train</span><span class="p">)</span>

<span class="c1"># Make future dataframe</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">p_test</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>

<span class="c1"># Make predictions</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

<span class="c1"># Extract the forecasted values for the test period</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">predicted</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>


<span class="c1"># Calculate error</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">wmape</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MSE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:20:20 - cmdstanpy - INFO - Chain [1] start processing
19:20:45 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MSE: 0.001
Test MAPE: 2.821%
</pre></div>
</div>
<img alt="../_images/95e95fe4b7eb05156c85deee4b28e2befa2389ab1bb5c6a966814a7d014f4745.png" src="../_images/95e95fe4b7eb05156c85deee4b28e2befa2389ab1bb5c6a966814a7d014f4745.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_test</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26671</th>
      <td>2010-01-01 00:00:00</td>
      <td>241.300000</td>
      <td>4.476667</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.516667</td>
      <td>0.989619</td>
    </tr>
    <tr>
      <th>26672</th>
      <td>2010-01-01 01:00:00</td>
      <td>241.620667</td>
      <td>2.723333</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>0.650000</td>
      <td>0.971732</td>
    </tr>
    <tr>
      <th>26673</th>
      <td>2010-01-01 02:00:00</td>
      <td>244.012333</td>
      <td>2.653333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.981504</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="zoom-in-on-estimated-time-range-this-prophet-forecast-chart-shows-the-actual-and-forecast-values-of-the-time-series-in-the-test-period-year-2010">
<h3><em><strong>zoom in on estimated time range: This Prophet forecast chart shows the actual and forecast values of the time series in the test period (year 2010)</strong></em><a class="headerlink" href="#zoom-in-on-estimated-time-range-this-prophet-forecast-chart-shows-the-actual-and-forecast-values-of-the-time-series-in-the-test-period-year-2010" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast2</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">p_test</span><span class="p">)</span>
<span class="n">forecasting</span> <span class="o">=</span> <span class="n">forecast2</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecasting</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecasting</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/58d5f61bd67b843ff778fe904cbb6a536c1e4aaab0712a1009fa595c98a86efc.png" src="../_images/58d5f61bd67b843ff778fe904cbb6a536c1e4aaab0712a1009fa595c98a86efc.png" />
</div>
</div>
<ul class="simple">
<li><p>Blue lines (Actual): Shows the actual power factor values.<br></p></li>
<li><p>Red area (Forecast): Prophet models forecast values and forecast uncertainty range.<br></p></li>
<li><p>X-axis: Time (hourly data throughout 2010).<br></p></li>
<li><p>Y-axis: Power factor (Power Factor Kilowatts).<br><br></p></li>
</ul>
<p>1- Seasonal Trend Captured:<br></p>
<ul class="simple">
<li><p>Prophet model predicted that power factor decreases in spring-summer
(June-August) and increases from autumn.<br></p></li>
<li><p>This shows that the time series has a significant seasonality.<br></p></li>
<li><p>A similar decrease is observed in the real data, meaning Prophet was able to capture this trend.<br><br>
2- Uncertainty Range Width:<br><br></p></li>
<li><p>The uncertainty range of the forecast (red area) is especially wide in summer months.<br></p></li>
<li><p>This shows that the model expects more variance during these periods and the confidence interval increases.<br><br>
Possible reasons:<br><br></p></li>
<li><p>Sudden fluctuations in power factor during summer months.<br></p></li>
<li><p>Uncertainty or missing data in the training data.<br></p></li>
<li><p>External factors not included in the model (e.g. changes in temperature or electricity demand).<br><br>
3- Model Smoothes Extreme Dips and Spikes:<br><br></p></li>
<li><p>Prophet often fails to capture extreme values because it learns about trends and seasonality.<br></p></li>
<li><p>Prophet model was unable to predict some of the sudden drops seen in real data, instead it followed an average trend.<br></p></li>
<li><p>This means that Prophet does not model extreme values well (for example, it cannot predict events such as large power grid spikes or outages).<br><br>
4- Winter and Spring Forecasts Are Better Matched:<br><br></p></li>
<li><p>Prophet forecasts for January-March and September-December are much closer to the actual data.<br></p></li>
<li><p>Prophet seems to forecast better during periods when seasonality is more regular.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_daily</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>power_factor</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-12-16</th>
      <td>236.243763</td>
      <td>13.082828</td>
      <td>0.0</td>
      <td>1.378788</td>
      <td>12.439394</td>
      <td>0.998768</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>

<span class="n">df_prophet</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;power_factor&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>

<span class="c1"># Add additional features</span>
<span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Split the data into training and testing sets</span>

<span class="n">p_train</span><span class="p">,</span> <span class="n">p_test</span> <span class="o">=</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">]</span>
<span class="n">p_test</span> <span class="o">=</span> <span class="n">p_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span>

<span class="c1"># Initialize and fit the Prophet model with additional features</span>
<span class="n">prop_model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">()</span>
<span class="n">prop_model</span><span class="o">.</span><span class="n">add_regressor</span><span class="p">(</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">)</span>
<span class="n">prop_model</span><span class="o">.</span><span class="n">add_regressor</span><span class="p">(</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">)</span>

<span class="n">prop_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">p_train</span><span class="p">)</span>


<span class="c1"># Make future dataframe and include additional features</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">p_test</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">future</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">future</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Make predictions</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

<span class="c1"># Extract the forecasted values for the test period</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">predicted</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="c1"># Calculate error</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">wmape</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mae</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>


<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_Factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:21:24 - cmdstanpy - INFO - Chain [1] start processing
19:21:25 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MAE: 0.019
Test MAPE: 1.983%
</pre></div>
</div>
<img alt="../_images/fd232fc5b0e807ca6f6f827b1bc425162f728256b811488f671b1f7be8e9804e.png" src="../_images/fd232fc5b0e807ca6f6f827b1bc425162f728256b811488f671b1f7be8e9804e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast_daily</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">p_test</span><span class="p">)</span>
<span class="n">forecasting_daily</span> <span class="o">=</span> <span class="n">forecast2</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecasting_daily</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecasting_daily</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast-zoomed view&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3ddc06eefa399e6d5bdc89607e4c759b1da3b98f011b630a5167b1f1ca2eaa33.png" src="../_images/3ddc06eefa399e6d5bdc89607e4c759b1da3b98f011b630a5167b1f1ca2eaa33.png" />
</div>
</div>
</section>
<section id="adding-features-did-not-contribute-to-the-model">
<h3><em><strong>Adding features did not contribute to the model</strong></em><a class="headerlink" href="#adding-features-did-not-contribute-to-the-model" title="Link to this heading">#</a></h3>
</section>
<section id="cross-validation-to-capture-the-best-parameters-for-prophet">
<h3><em><strong>Cross validation to capture the best parameters for Prophet</strong></em><a class="headerlink" href="#cross-validation-to-capture-the-best-parameters-for-prophet" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">prophet.diagnostics</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_validation</span><span class="p">,</span> <span class="n">performance_metrics</span> <span class="c1"># Importing necessary functions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>

<span class="n">df_prop</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;power_factor&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;changepoint_prior_scale&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="s1">&#39;seasonality_prior_scale&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">all_params</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">param_grid</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">param_grid</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>

<span class="n">best_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_prop</span><span class="p">)</span>
    <span class="n">df_cv</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="s1">&#39;365 days&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s1">&#39;180 days&#39;</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="s1">&#39;365 days&#39;</span><span class="p">)</span>
    <span class="n">df_p</span> <span class="o">=</span> <span class="n">performance_metrics</span><span class="p">(</span><span class="n">df_cv</span><span class="p">,</span> <span class="n">rolling_window</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df_p</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">best_score</span><span class="p">:</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="n">df_p</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;best parameters:&quot;</span><span class="p">,</span> <span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:45 - cmdstanpy - INFO - Chain [1] start processing
19:23:45 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "693abb7cf1214024b48c11afefa07532", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:45 - cmdstanpy - INFO - Chain [1] start processing
19:23:45 - cmdstanpy - INFO - Chain [1] done processing
19:23:45 - cmdstanpy - INFO - Chain [1] start processing
19:23:45 - cmdstanpy - INFO - Chain [1] done processing
19:23:45 - cmdstanpy - INFO - Chain [1] start processing
19:23:45 - cmdstanpy - INFO - Chain [1] done processing
19:23:46 - cmdstanpy - INFO - Chain [1] start processing
19:23:46 - cmdstanpy - INFO - Chain [1] done processing
19:23:46 - cmdstanpy - INFO - Chain [1] start processing
19:23:46 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "500903e550d74a7f935b5227e53cd426", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:46 - cmdstanpy - INFO - Chain [1] start processing
19:23:46 - cmdstanpy - INFO - Chain [1] done processing
19:23:46 - cmdstanpy - INFO - Chain [1] start processing
19:23:46 - cmdstanpy - INFO - Chain [1] done processing
19:23:47 - cmdstanpy - INFO - Chain [1] start processing
19:23:47 - cmdstanpy - INFO - Chain [1] done processing
19:23:47 - cmdstanpy - INFO - Chain [1] start processing
19:23:47 - cmdstanpy - INFO - Chain [1] done processing
19:23:47 - cmdstanpy - INFO - Chain [1] start processing
19:23:47 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "462d0f1c34a34ac7b0553e5f3344c4fd", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:47 - cmdstanpy - INFO - Chain [1] start processing
19:23:47 - cmdstanpy - INFO - Chain [1] done processing
19:23:48 - cmdstanpy - INFO - Chain [1] start processing
19:23:48 - cmdstanpy - INFO - Chain [1] done processing
19:23:48 - cmdstanpy - INFO - Chain [1] start processing
19:23:48 - cmdstanpy - INFO - Chain [1] done processing
19:23:48 - cmdstanpy - INFO - Chain [1] start processing
19:23:48 - cmdstanpy - INFO - Chain [1] done processing
19:23:48 - cmdstanpy - INFO - Chain [1] start processing
19:23:48 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2a18b263af4e4e15bd1230a10af03a21", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:49 - cmdstanpy - INFO - Chain [1] start processing
19:23:49 - cmdstanpy - INFO - Chain [1] done processing
19:23:49 - cmdstanpy - INFO - Chain [1] start processing
19:23:49 - cmdstanpy - INFO - Chain [1] done processing
19:23:49 - cmdstanpy - INFO - Chain [1] start processing
19:23:49 - cmdstanpy - INFO - Chain [1] done processing
19:23:49 - cmdstanpy - INFO - Chain [1] start processing
19:23:49 - cmdstanpy - INFO - Chain [1] done processing
19:23:50 - cmdstanpy - INFO - Chain [1] start processing
19:23:50 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "08667cf3630b48d9a5b550fc563dc794", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:50 - cmdstanpy - INFO - Chain [1] start processing
19:23:50 - cmdstanpy - INFO - Chain [1] done processing
19:23:50 - cmdstanpy - INFO - Chain [1] start processing
19:23:50 - cmdstanpy - INFO - Chain [1] done processing
19:23:50 - cmdstanpy - INFO - Chain [1] start processing
19:23:50 - cmdstanpy - INFO - Chain [1] done processing
19:23:50 - cmdstanpy - INFO - Chain [1] start processing
19:23:50 - cmdstanpy - INFO - Chain [1] done processing
19:23:51 - cmdstanpy - INFO - Chain [1] start processing
19:23:51 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c77e8210ee884acc98cea78642cea8e3", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:51 - cmdstanpy - INFO - Chain [1] start processing
19:23:51 - cmdstanpy - INFO - Chain [1] done processing
19:23:51 - cmdstanpy - INFO - Chain [1] start processing
19:23:51 - cmdstanpy - INFO - Chain [1] done processing
19:23:51 - cmdstanpy - INFO - Chain [1] start processing
19:23:51 - cmdstanpy - INFO - Chain [1] done processing
19:23:52 - cmdstanpy - INFO - Chain [1] start processing
19:23:52 - cmdstanpy - INFO - Chain [1] done processing
19:23:52 - cmdstanpy - INFO - Chain [1] start processing
19:23:52 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ce9ff28b3a240929cf7b25ae8f77219", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:52 - cmdstanpy - INFO - Chain [1] start processing
19:23:52 - cmdstanpy - INFO - Chain [1] done processing
19:23:52 - cmdstanpy - INFO - Chain [1] start processing
19:23:52 - cmdstanpy - INFO - Chain [1] done processing
19:23:53 - cmdstanpy - INFO - Chain [1] start processing
19:23:53 - cmdstanpy - INFO - Chain [1] done processing
19:23:53 - cmdstanpy - INFO - Chain [1] start processing
19:23:53 - cmdstanpy - INFO - Chain [1] done processing
19:23:53 - cmdstanpy - INFO - Chain [1] start processing
19:23:53 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "58e24f920b7c4e78a540a1b6ea8491de", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:53 - cmdstanpy - INFO - Chain [1] start processing
19:23:53 - cmdstanpy - INFO - Chain [1] done processing
19:23:54 - cmdstanpy - INFO - Chain [1] start processing
19:23:54 - cmdstanpy - INFO - Chain [1] done processing
19:23:54 - cmdstanpy - INFO - Chain [1] start processing
19:23:54 - cmdstanpy - INFO - Chain [1] done processing
19:23:54 - cmdstanpy - INFO - Chain [1] start processing
19:23:54 - cmdstanpy - INFO - Chain [1] done processing
19:23:54 - cmdstanpy - INFO - Chain [1] start processing
19:23:55 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5b545c9f63734092af6fa783cdee8af7", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:55 - cmdstanpy - INFO - Chain [1] start processing
19:23:55 - cmdstanpy - INFO - Chain [1] done processing
19:23:55 - cmdstanpy - INFO - Chain [1] start processing
19:23:55 - cmdstanpy - INFO - Chain [1] done processing
19:23:55 - cmdstanpy - INFO - Chain [1] start processing
19:23:56 - cmdstanpy - INFO - Chain [1] done processing
19:23:56 - cmdstanpy - INFO - Chain [1] start processing
19:23:57 - cmdstanpy - INFO - Chain [1] done processing
19:23:57 - cmdstanpy - INFO - Chain [1] start processing
19:23:58 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b12cc383bb514d6c873dd958c3256dac", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:23:58 - cmdstanpy - INFO - Chain [1] start processing
19:23:58 - cmdstanpy - INFO - Chain [1] done processing
19:23:58 - cmdstanpy - INFO - Chain [1] start processing
19:23:58 - cmdstanpy - INFO - Chain [1] done processing
19:23:58 - cmdstanpy - INFO - Chain [1] start processing
19:23:59 - cmdstanpy - INFO - Chain [1] done processing
19:23:59 - cmdstanpy - INFO - Chain [1] start processing
19:24:00 - cmdstanpy - INFO - Chain [1] done processing
19:24:00 - cmdstanpy - INFO - Chain [1] start processing
19:24:01 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e85eb3b5d1ba41d3986e03f195989623", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:01 - cmdstanpy - INFO - Chain [1] start processing
19:24:01 - cmdstanpy - INFO - Chain [1] done processing
19:24:01 - cmdstanpy - INFO - Chain [1] start processing
19:24:01 - cmdstanpy - INFO - Chain [1] done processing
19:24:01 - cmdstanpy - INFO - Chain [1] start processing
19:24:02 - cmdstanpy - INFO - Chain [1] done processing
19:24:02 - cmdstanpy - INFO - Chain [1] start processing
19:24:03 - cmdstanpy - INFO - Chain [1] done processing
19:24:03 - cmdstanpy - INFO - Chain [1] start processing
19:24:04 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1379aa6eb124f889eb5251a1489afcf", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:04 - cmdstanpy - INFO - Chain [1] start processing
19:24:04 - cmdstanpy - INFO - Chain [1] done processing
19:24:04 - cmdstanpy - INFO - Chain [1] start processing
19:24:04 - cmdstanpy - INFO - Chain [1] done processing
19:24:04 - cmdstanpy - INFO - Chain [1] start processing
19:24:05 - cmdstanpy - INFO - Chain [1] done processing
19:24:05 - cmdstanpy - INFO - Chain [1] start processing
19:24:05 - cmdstanpy - INFO - Chain [1] done processing
19:24:06 - cmdstanpy - INFO - Chain [1] start processing
19:24:06 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b57ce63db1cd434d85444afa8253e00e", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:07 - cmdstanpy - INFO - Chain [1] start processing
19:24:07 - cmdstanpy - INFO - Chain [1] done processing
19:24:07 - cmdstanpy - INFO - Chain [1] start processing
19:24:07 - cmdstanpy - INFO - Chain [1] done processing
19:24:07 - cmdstanpy - INFO - Chain [1] start processing
19:24:08 - cmdstanpy - INFO - Chain [1] done processing
19:24:09 - cmdstanpy - INFO - Chain [1] start processing
19:24:09 - cmdstanpy - INFO - Chain [1] done processing
19:24:10 - cmdstanpy - INFO - Chain [1] start processing
19:24:10 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "73dc0145bae6476ea0c9a99352d3e61e", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:10 - cmdstanpy - INFO - Chain [1] start processing
19:24:11 - cmdstanpy - INFO - Chain [1] done processing
19:24:11 - cmdstanpy - INFO - Chain [1] start processing
19:24:11 - cmdstanpy - INFO - Chain [1] done processing
19:24:11 - cmdstanpy - INFO - Chain [1] start processing
19:24:12 - cmdstanpy - INFO - Chain [1] done processing
19:24:12 - cmdstanpy - INFO - Chain [1] start processing
19:24:13 - cmdstanpy - INFO - Chain [1] done processing
19:24:13 - cmdstanpy - INFO - Chain [1] start processing
19:24:13 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9b5909933987448dbbac284695b565b5", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:14 - cmdstanpy - INFO - Chain [1] start processing
19:24:14 - cmdstanpy - INFO - Chain [1] done processing
19:24:14 - cmdstanpy - INFO - Chain [1] start processing
19:24:14 - cmdstanpy - INFO - Chain [1] done processing
19:24:15 - cmdstanpy - INFO - Chain [1] start processing
19:24:16 - cmdstanpy - INFO - Chain [1] done processing
19:24:16 - cmdstanpy - INFO - Chain [1] start processing
19:24:16 - cmdstanpy - INFO - Chain [1] done processing
19:24:17 - cmdstanpy - INFO - Chain [1] start processing
19:24:17 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6ac5c93b465948f0bb82d15e5603a384", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:24:17 - cmdstanpy - INFO - Chain [1] start processing
19:24:18 - cmdstanpy - INFO - Chain [1] done processing
19:24:18 - cmdstanpy - INFO - Chain [1] start processing
19:24:18 - cmdstanpy - INFO - Chain [1] done processing
19:24:19 - cmdstanpy - INFO - Chain [1] start processing
19:24:20 - cmdstanpy - INFO - Chain [1] done processing
19:24:20 - cmdstanpy - INFO - Chain [1] start processing
19:24:20 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best parameters: {&#39;changepoint_prior_scale&#39;: 0.5, &#39;seasonality_prior_scale&#39;: 0.01}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;best parameters:&quot;</span><span class="p">,</span> <span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best parameters: {&#39;changepoint_prior_scale&#39;: 0.5, &#39;seasonality_prior_scale&#39;: 0.01}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>

<span class="n">df_prophet</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;power_factor&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">})</span>

<span class="c1"># Add additional features</span>
<span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Split the data into training and testing sets</span>

<span class="n">p_train</span><span class="p">,</span> <span class="n">p_test</span> <span class="o">=</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="n">df_prophet</span><span class="o">.</span><span class="n">ds</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">]</span>
<span class="n">p_test</span> <span class="o">=</span> <span class="n">p_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span>

<span class="c1"># Initialize and fit the Prophet model with additional features</span>
<span class="n">prop_model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="n">changepoint_prior_scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">seasonality_prior_scale</span><span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">prop_model</span><span class="o">.</span><span class="n">add_regressor</span><span class="p">(</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">)</span>
<span class="n">prop_model</span><span class="o">.</span><span class="n">add_regressor</span><span class="p">(</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">)</span>

<span class="n">prop_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">p_train</span><span class="p">)</span>


<span class="c1"># Make future dataframe and include additional features</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">p_test</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">future</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;global_intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">future</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;sub_metering_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Make predictions</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

<span class="c1"># Extract the forecasted values for the test period</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]]</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">predicted</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="c1"># Calculate error</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">wmape</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAE: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mae</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test MAPE: </span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mape</span><span class="p">)</span>


<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span> <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predicted</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power_Factor_kilowatts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prophet Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20:01:36 - cmdstanpy - INFO - Chain [1] start processing
20:01:37 - cmdstanpy - INFO - Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test MAE: 0.015
Test MAPE: 1.539%
</pre></div>
</div>
<img alt="../_images/34faf5d4b6b3fdd86fac4aa0667a0afe37257154c8f7538d00c8ce42690f2437.png" src="../_images/34faf5d4b6b3fdd86fac4aa0667a0afe37257154c8f7538d00c8ce42690f2437.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>trend</th>
      <th>yhat_lower</th>
      <th>yhat_upper</th>
      <th>trend_lower</th>
      <th>trend_upper</th>
      <th>additive_terms</th>
      <th>additive_terms_lower</th>
      <th>additive_terms_upper</th>
      <th>extra_regressors_additive</th>
      <th>extra_regressors_additive_lower</th>
      <th>extra_regressors_additive_upper</th>
      <th>global_intensity</th>
      <th>global_intensity_lower</th>
      <th>global_intensity_upper</th>
      <th>sub_metering_1</th>
      <th>sub_metering_1_lower</th>
      <th>sub_metering_1_upper</th>
      <th>weekly</th>
      <th>weekly_lower</th>
      <th>weekly_upper</th>
      <th>yearly</th>
      <th>yearly_lower</th>
      <th>yearly_upper</th>
      <th>multiplicative_terms</th>
      <th>multiplicative_terms_lower</th>
      <th>multiplicative_terms_upper</th>
      <th>yhat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2006-12-16</td>
      <td>0.953651</td>
      <td>0.992334</td>
      <td>1.027077</td>
      <td>0.953651</td>
      <td>0.953651</td>
      <td>0.056642</td>
      <td>0.056642</td>
      <td>0.056642</td>
      <td>0.053690</td>
      <td>0.053690</td>
      <td>0.053690</td>
      <td>0.051515</td>
      <td>0.051515</td>
      <td>0.051515</td>
      <td>0.002174</td>
      <td>0.002174</td>
      <td>0.002174</td>
      <td>-0.002033</td>
      <td>-0.002033</td>
      <td>-0.002033</td>
      <td>0.004985</td>
      <td>0.004985</td>
      <td>0.004985</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.010294</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2006-12-17</td>
      <td>0.953680</td>
      <td>0.972365</td>
      <td>1.005448</td>
      <td>0.953680</td>
      <td>0.953680</td>
      <td>0.035118</td>
      <td>0.035118</td>
      <td>0.035118</td>
      <td>0.032146</td>
      <td>0.032146</td>
      <td>0.032146</td>
      <td>0.032618</td>
      <td>0.032618</td>
      <td>0.032618</td>
      <td>-0.000473</td>
      <td>-0.000473</td>
      <td>-0.000473</td>
      <td>-0.002155</td>
      <td>-0.002155</td>
      <td>-0.002155</td>
      <td>0.005127</td>
      <td>0.005127</td>
      <td>0.005127</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.988797</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2006-12-18</td>
      <td>0.953708</td>
      <td>0.953847</td>
      <td>0.988546</td>
      <td>0.953708</td>
      <td>0.953708</td>
      <td>0.017635</td>
      <td>0.017635</td>
      <td>0.017635</td>
      <td>0.011488</td>
      <td>0.011488</td>
      <td>0.011488</td>
      <td>0.010697</td>
      <td>0.010697</td>
      <td>0.010697</td>
      <td>0.000790</td>
      <td>0.000790</td>
      <td>0.000790</td>
      <td>0.000866</td>
      <td>0.000866</td>
      <td>0.000866</td>
      <td>0.005281</td>
      <td>0.005281</td>
      <td>0.005281</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.971343</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2006-12-19</td>
      <td>0.953737</td>
      <td>0.946738</td>
      <td>0.979484</td>
      <td>0.953737</td>
      <td>0.953737</td>
      <td>0.009401</td>
      <td>0.009401</td>
      <td>0.009401</td>
      <td>0.002617</td>
      <td>0.002617</td>
      <td>0.002617</td>
      <td>0.001535</td>
      <td>0.001535</td>
      <td>0.001535</td>
      <td>0.001082</td>
      <td>0.001082</td>
      <td>0.001082</td>
      <td>0.001343</td>
      <td>0.001343</td>
      <td>0.001343</td>
      <td>0.005441</td>
      <td>0.005441</td>
      <td>0.005441</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.963137</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006-12-20</td>
      <td>0.953765</td>
      <td>0.955896</td>
      <td>0.988617</td>
      <td>0.953765</td>
      <td>0.953765</td>
      <td>0.018692</td>
      <td>0.018692</td>
      <td>0.018692</td>
      <td>0.013152</td>
      <td>0.013152</td>
      <td>0.013152</td>
      <td>0.010977</td>
      <td>0.010977</td>
      <td>0.010977</td>
      <td>0.002174</td>
      <td>0.002174</td>
      <td>0.002174</td>
      <td>-0.000062</td>
      <td>-0.000062</td>
      <td>-0.000062</td>
      <td>0.005602</td>
      <td>0.005602</td>
      <td>0.005602</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.972458</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast</span><span class="p">[</span><span class="s1">&#39;Actual_pf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[[</span><span class="s1">&#39;Actual_pf&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat&#39;</span><span class="p">,</span> <span class="s1">&#39;yhat_lower&#39;</span><span class="p">,</span><span class="s1">&#39;yhat_upper&#39;</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9f54b86637f0a11b05c6d2a78c17807e8a11a17ce03f0850865aee994b05d104.png" src="../_images/9f54b86637f0a11b05c6d2a78c17807e8a11a17ce03f0850865aee994b05d104.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">prop_model</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f677f3be448539ae35a9cbabd6acab44dace227bb1b9c40d36803333ff16ee80.png" src="../_images/f677f3be448539ae35a9cbabd6acab44dace227bb1b9c40d36803333ff16ee80.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>yhat</th>
    </tr>
    <tr>
      <th>ds</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>0.968214</td>
    </tr>
    <tr>
      <th>2010-01-02</th>
      <td>0.969182</td>
    </tr>
    <tr>
      <th>2010-01-03</th>
      <td>0.978786</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>0.977981</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>0.986872</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_test</span> <span class="o">=</span> <span class="n">p_test</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;ds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>voltage</th>
      <th>global_intensity</th>
      <th>sub_metering_1</th>
      <th>sub_metering_2</th>
      <th>sub_metering_3</th>
      <th>y</th>
      <th>power_factor_detrended</th>
      <th>power_factor_deseasonalized</th>
    </tr>
    <tr>
      <th>ds</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>242.565722</td>
      <td>3.537083</td>
      <td>1.600000</td>
      <td>0.227083</td>
      <td>2.470833</td>
      <td>0.976637</td>
      <td>-0.005780</td>
      <td>-0.005575</td>
    </tr>
    <tr>
      <th>2010-01-02</th>
      <td>244.674514</td>
      <td>3.814325</td>
      <td>0.557029</td>
      <td>0.207846</td>
      <td>4.465596</td>
      <td>0.962314</td>
      <td>-0.014323</td>
      <td>-0.013142</td>
    </tr>
    <tr>
      <th>2010-01-03</th>
      <td>243.744528</td>
      <td>6.044167</td>
      <td>2.668056</td>
      <td>3.416667</td>
      <td>6.995833</td>
      <td>0.980319</td>
      <td>0.018005</td>
      <td>0.021778</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>245.699118</td>
      <td>4.599444</td>
      <td>0.000000</td>
      <td>0.202778</td>
      <td>7.508333</td>
      <td>0.979383</td>
      <td>-0.000936</td>
      <td>-0.008604</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>244.521035</td>
      <td>6.347083</td>
      <td>1.239583</td>
      <td>0.203472</td>
      <td>11.436111</td>
      <td>0.987479</td>
      <td>0.008096</td>
      <td>0.012874</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_prophet</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">p_test</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> 
    <span class="n">predicted</span><span class="p">[</span><span class="s2">&quot;yhat&quot;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">prophet_error_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted</span><span class="p">[</span><span class="s2">&quot;yhat&quot;</span><span class="p">]))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_test</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">compare_df_prophet</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;actual&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">]</span>
<span class="n">compare_df_prophet</span><span class="p">[</span><span class="s2">&quot;error_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prophet_error_p</span>
<span class="n">compare_df_prophet</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual</th>
      <th>pred</th>
      <th>error_%</th>
    </tr>
    <tr>
      <th>ds</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01</th>
      <td>0.976637</td>
      <td>0.968214</td>
      <td>0.862422</td>
    </tr>
    <tr>
      <th>2010-01-02</th>
      <td>0.962314</td>
      <td>0.969182</td>
      <td>-0.713748</td>
    </tr>
    <tr>
      <th>2010-01-03</th>
      <td>0.980319</td>
      <td>0.978786</td>
      <td>0.156396</td>
    </tr>
    <tr>
      <th>2010-01-04</th>
      <td>0.979383</td>
      <td>0.977981</td>
      <td>0.143197</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>0.987479</td>
      <td>0.986872</td>
      <td>0.061455</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>0.977991</td>
      <td>0.978011</td>
      <td>-0.002028</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>0.985284</td>
      <td>0.979927</td>
      <td>0.543651</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>0.979753</td>
      <td>0.981383</td>
      <td>-0.166422</td>
    </tr>
    <tr>
      <th>2010-01-09</th>
      <td>0.979505</td>
      <td>0.984852</td>
      <td>-0.545797</td>
    </tr>
    <tr>
      <th>2010-01-10</th>
      <td>0.983898</td>
      <td>0.986864</td>
      <td>-0.301452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_df_prophet</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;prophet_prediction_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="xgboost">
<h2><em><strong>5.2.3.XGBoost</strong></em><a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h2>
<p>XGBoost is short for Extreme Gradient Boosting and is an efficient implementation of the stochastic gradient boosting machine learning algorithm</p>
<p>The stochastic gradient boosting algorithm, also called gradient boosting machines or tree boosting, is a powerful machine learning technique that performs well or even best on a wide range of challenging machine learning problems</p>
<p>To be able to use XGBoost for time series forecasting, the data should be transformed into supervised learning before feeding it into the model</p>
<p>Official Documentation: here</p>
<p>Helpful Resources:</p>
<p><a class="reference external" href="https://machinelearningmastery.com/xgboost-for-time-series-forecasting/">https://machinelearningmastery.com/xgboost-for-time-series-forecasting/</a> <a class="reference external" href="https://www.kaggle.com/code/robikscube/tutorial-time-series-forecasting-with-xgboost">https://www.kaggle.com/code/robikscube/tutorial-time-series-forecasting-with-xgboost</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2010</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2010</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Timestamp(&#39;2010-01-01 00:00:00&#39;), Timestamp(&#39;2010-11-26 21:00:00&#39;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">],</span> <span class="n">df_hourly</span><span class="p">[</span><span class="n">df_hourly</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01 00:00:00&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train:	 26671
Test:	 7918
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">date_transform</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofweek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofmonth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weekofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isocalendar</span><span class="p">()</span><span class="o">.</span><span class="n">week</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;power_factor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">date_transform</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">date_transform</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">xgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: xgboost in /usr/local/lib/python3.10/dist-packages (2.0.3)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.26.4)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.13.1)
Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (1.3.8)
Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (1.2.4)
Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (0.1.1)
Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (2025.0.1)
Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (2022.0.0)
Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy-&gt;xgboost) (2.4.1)
Requirement already satisfied: intel-openmp&gt;=2024 in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy-&gt;xgboost) (2024.2.0)
Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl-&gt;numpy-&gt;xgboost) (2022.0.0)
Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*-&gt;mkl-&gt;numpy-&gt;xgboost) (1.2.0)
Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath-&gt;numpy-&gt;xgboost) (2024.2.0)
Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp&gt;=2024-&gt;mkl-&gt;numpy-&gt;xgboost) (2024.2.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBRegressor</span>

<span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                         <span class="n">eval_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span><span class="s1">&#39;mape&#39;</span><span class="p">],</span>
                         <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                         <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">xgb_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)])</span>
<span class="n">xgb_pred</span> <span class="o">=</span> <span class="n">xgb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]	validation_0-mae:0.03118	validation_0-rmse:0.04115	validation_0-mape:0.03348	validation_1-mae:0.02645	validation_1-rmse:0.03144	validation_1-mape:0.02761
[1]	validation_0-mae:0.03002	validation_0-rmse:0.03965	validation_0-mape:0.03224	validation_1-mae:0.02543	validation_1-rmse:0.03022	validation_1-mape:0.02654
[2]	validation_0-mae:0.02889	validation_0-rmse:0.03822	validation_0-mape:0.03102	validation_1-mae:0.02438	validation_1-rmse:0.02898	validation_1-mape:0.02545
[3]	validation_0-mae:0.02781	validation_0-rmse:0.03687	validation_0-mape:0.02987	validation_1-mae:0.02344	validation_1-rmse:0.02785	validation_1-mape:0.02445
[4]	validation_0-mae:0.02680	validation_0-rmse:0.03559	validation_0-mape:0.02879	validation_1-mae:0.02255	validation_1-rmse:0.02682	validation_1-mape:0.02353
[5]	validation_0-mae:0.02584	validation_0-rmse:0.03438	validation_0-mape:0.02776	validation_1-mae:0.02167	validation_1-rmse:0.02582	validation_1-mape:0.02260
[6]	validation_0-mae:0.02493	validation_0-rmse:0.03324	validation_0-mape:0.02679	validation_1-mae:0.02089	validation_1-rmse:0.02493	validation_1-mape:0.02178
[7]	validation_0-mae:0.02407	validation_0-rmse:0.03215	validation_0-mape:0.02587	validation_1-mae:0.02014	validation_1-rmse:0.02411	validation_1-mape:0.02100
[8]	validation_0-mae:0.02327	validation_0-rmse:0.03116	validation_0-mape:0.02501	validation_1-mae:0.01950	validation_1-rmse:0.02338	validation_1-mape:0.02033
[9]	validation_0-mae:0.02251	validation_0-rmse:0.03022	validation_0-mape:0.02420	validation_1-mae:0.01890	validation_1-rmse:0.02272	validation_1-mape:0.01970
[10]	validation_0-mae:0.02180	validation_0-rmse:0.02935	validation_0-mape:0.02344	validation_1-mae:0.01831	validation_1-rmse:0.02208	validation_1-mape:0.01908
[11]	validation_0-mae:0.02114	validation_0-rmse:0.02851	validation_0-mape:0.02273	validation_1-mae:0.01776	validation_1-rmse:0.02148	validation_1-mape:0.01851
[12]	validation_0-mae:0.02049	validation_0-rmse:0.02769	validation_0-mape:0.02203	validation_1-mae:0.01726	validation_1-rmse:0.02095	validation_1-mape:0.01798
[13]	validation_0-mae:0.01989	validation_0-rmse:0.02694	validation_0-mape:0.02139	validation_1-mae:0.01680	validation_1-rmse:0.02047	validation_1-mape:0.01750
[14]	validation_0-mae:0.01932	validation_0-rmse:0.02626	validation_0-mape:0.02078	validation_1-mae:0.01633	validation_1-rmse:0.01999	validation_1-mape:0.01702
[15]	validation_0-mae:0.01880	validation_0-rmse:0.02561	validation_0-mape:0.02021	validation_1-mae:0.01596	validation_1-rmse:0.01962	validation_1-mape:0.01663
[16]	validation_0-mae:0.01830	validation_0-rmse:0.02501	validation_0-mape:0.01968	validation_1-mae:0.01558	validation_1-rmse:0.01925	validation_1-mape:0.01624
[17]	validation_0-mae:0.01783	validation_0-rmse:0.02445	validation_0-mape:0.01917	validation_1-mae:0.01527	validation_1-rmse:0.01896	validation_1-mape:0.01592
[18]	validation_0-mae:0.01738	validation_0-rmse:0.02390	validation_0-mape:0.01869	validation_1-mae:0.01499	validation_1-rmse:0.01871	validation_1-mape:0.01563
[19]	validation_0-mae:0.01696	validation_0-rmse:0.02342	validation_0-mape:0.01824	validation_1-mae:0.01473	validation_1-rmse:0.01848	validation_1-mape:0.01536
[20]	validation_0-mae:0.01656	validation_0-rmse:0.02294	validation_0-mape:0.01781	validation_1-mae:0.01449	validation_1-rmse:0.01828	validation_1-mape:0.01511
[21]	validation_0-mae:0.01618	validation_0-rmse:0.02250	validation_0-mape:0.01740	validation_1-mae:0.01428	validation_1-rmse:0.01812	validation_1-mape:0.01490
[22]	validation_0-mae:0.01582	validation_0-rmse:0.02209	validation_0-mape:0.01702	validation_1-mae:0.01411	validation_1-rmse:0.01801	validation_1-mape:0.01472
[23]	validation_0-mae:0.01549	validation_0-rmse:0.02171	validation_0-mape:0.01666	validation_1-mae:0.01388	validation_1-rmse:0.01783	validation_1-mape:0.01448
[24]	validation_0-mae:0.01516	validation_0-rmse:0.02134	validation_0-mape:0.01630	validation_1-mae:0.01374	validation_1-rmse:0.01776	validation_1-mape:0.01434
[25]	validation_0-mae:0.01487	validation_0-rmse:0.02101	validation_0-mape:0.01599	validation_1-mae:0.01358	validation_1-rmse:0.01765	validation_1-mape:0.01418
[26]	validation_0-mae:0.01458	validation_0-rmse:0.02069	validation_0-mape:0.01568	validation_1-mae:0.01345	validation_1-rmse:0.01759	validation_1-mape:0.01405
[27]	validation_0-mae:0.01431	validation_0-rmse:0.02040	validation_0-mape:0.01539	validation_1-mae:0.01330	validation_1-rmse:0.01750	validation_1-mape:0.01390
[28]	validation_0-mae:0.01406	validation_0-rmse:0.02012	validation_0-mape:0.01512	validation_1-mae:0.01320	validation_1-rmse:0.01747	validation_1-mape:0.01379
[29]	validation_0-mae:0.01381	validation_0-rmse:0.01984	validation_0-mape:0.01485	validation_1-mae:0.01312	validation_1-rmse:0.01747	validation_1-mape:0.01372
[30]	validation_0-mae:0.01358	validation_0-rmse:0.01959	validation_0-mape:0.01460	validation_1-mae:0.01306	validation_1-rmse:0.01748	validation_1-mape:0.01365
[31]	validation_0-mae:0.01336	validation_0-rmse:0.01936	validation_0-mape:0.01437	validation_1-mae:0.01299	validation_1-rmse:0.01751	validation_1-mape:0.01359
[32]	validation_0-mae:0.01317	validation_0-rmse:0.01915	validation_0-mape:0.01416	validation_1-mae:0.01293	validation_1-rmse:0.01753	validation_1-mape:0.01354
[33]	validation_0-mae:0.01298	validation_0-rmse:0.01895	validation_0-mape:0.01395	validation_1-mae:0.01285	validation_1-rmse:0.01753	validation_1-mape:0.01346
[34]	validation_0-mae:0.01280	validation_0-rmse:0.01876	validation_0-mape:0.01376	validation_1-mae:0.01279	validation_1-rmse:0.01753	validation_1-mape:0.01339
[35]	validation_0-mae:0.01262	validation_0-rmse:0.01858	validation_0-mape:0.01357	validation_1-mae:0.01276	validation_1-rmse:0.01758	validation_1-mape:0.01336
[36]	validation_0-mae:0.01246	validation_0-rmse:0.01842	validation_0-mape:0.01340	validation_1-mae:0.01269	validation_1-rmse:0.01760	validation_1-mape:0.01330
[37]	validation_0-mae:0.01232	validation_0-rmse:0.01827	validation_0-mape:0.01324	validation_1-mae:0.01264	validation_1-rmse:0.01763	validation_1-mape:0.01326
[38]	validation_0-mae:0.01217	validation_0-rmse:0.01812	validation_0-mape:0.01309	validation_1-mae:0.01259	validation_1-rmse:0.01765	validation_1-mape:0.01321
[39]	validation_0-mae:0.01204	validation_0-rmse:0.01799	validation_0-mape:0.01295	validation_1-mae:0.01253	validation_1-rmse:0.01765	validation_1-mape:0.01315
[40]	validation_0-mae:0.01192	validation_0-rmse:0.01786	validation_0-mape:0.01281	validation_1-mae:0.01249	validation_1-rmse:0.01767	validation_1-mape:0.01311
[41]	validation_0-mae:0.01180	validation_0-rmse:0.01775	validation_0-mape:0.01269	validation_1-mae:0.01247	validation_1-rmse:0.01772	validation_1-mape:0.01309
[42]	validation_0-mae:0.01168	validation_0-rmse:0.01764	validation_0-mape:0.01256	validation_1-mae:0.01247	validation_1-rmse:0.01777	validation_1-mape:0.01309
[43]	validation_0-mae:0.01158	validation_0-rmse:0.01754	validation_0-mape:0.01245	validation_1-mae:0.01244	validation_1-rmse:0.01782	validation_1-mape:0.01307
[44]	validation_0-mae:0.01148	validation_0-rmse:0.01745	validation_0-mape:0.01234	validation_1-mae:0.01243	validation_1-rmse:0.01787	validation_1-mape:0.01306
[45]	validation_0-mae:0.01138	validation_0-rmse:0.01735	validation_0-mape:0.01224	validation_1-mae:0.01241	validation_1-rmse:0.01791	validation_1-mape:0.01304
[46]	validation_0-mae:0.01129	validation_0-rmse:0.01727	validation_0-mape:0.01215	validation_1-mae:0.01242	validation_1-rmse:0.01797	validation_1-mape:0.01305
[47]	validation_0-mae:0.01121	validation_0-rmse:0.01719	validation_0-mape:0.01205	validation_1-mae:0.01240	validation_1-rmse:0.01800	validation_1-mape:0.01304
[48]	validation_0-mae:0.01113	validation_0-rmse:0.01711	validation_0-mape:0.01197	validation_1-mae:0.01239	validation_1-rmse:0.01805	validation_1-mape:0.01303
[49]	validation_0-mae:0.01105	validation_0-rmse:0.01702	validation_0-mape:0.01188	validation_1-mae:0.01239	validation_1-rmse:0.01810	validation_1-mape:0.01303
[50]	validation_0-mae:0.01097	validation_0-rmse:0.01695	validation_0-mape:0.01180	validation_1-mae:0.01239	validation_1-rmse:0.01814	validation_1-mape:0.01303
[51]	validation_0-mae:0.01090	validation_0-rmse:0.01688	validation_0-mape:0.01172	validation_1-mae:0.01241	validation_1-rmse:0.01820	validation_1-mape:0.01305
[52]	validation_0-mae:0.01084	validation_0-rmse:0.01682	validation_0-mape:0.01165	validation_1-mae:0.01239	validation_1-rmse:0.01823	validation_1-mape:0.01303
[53]	validation_0-mae:0.01077	validation_0-rmse:0.01676	validation_0-mape:0.01158	validation_1-mae:0.01241	validation_1-rmse:0.01829	validation_1-mape:0.01305
[54]	validation_0-mae:0.01072	validation_0-rmse:0.01670	validation_0-mape:0.01152	validation_1-mae:0.01241	validation_1-rmse:0.01833	validation_1-mape:0.01305
[55]	validation_0-mae:0.01065	validation_0-rmse:0.01664	validation_0-mape:0.01146	validation_1-mae:0.01241	validation_1-rmse:0.01837	validation_1-mape:0.01306
[56]	validation_0-mae:0.01060	validation_0-rmse:0.01659	validation_0-mape:0.01140	validation_1-mae:0.01243	validation_1-rmse:0.01843	validation_1-mape:0.01308
[57]	validation_0-mae:0.01054	validation_0-rmse:0.01654	validation_0-mape:0.01134	validation_1-mae:0.01245	validation_1-rmse:0.01849	validation_1-mape:0.01310
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">xgb_model</span><span class="o">.</span><span class="n">evals_result</span><span class="p">()</span>

<span class="c1"># MAE ve RMSE deerlerini yazdr</span>
<span class="n">train_mae</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># MAE in the last iteration</span>
<span class="n">test_mae</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">train_rmse</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;rmse&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># RMSE in the last iteration</span>
<span class="n">test_rmse</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;rmse&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">train_mape</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># MAPE in the last iteration</span>
<span class="n">test_mape</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train MAE: </span><span class="si">{</span><span class="n">train_mae</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAE: </span><span class="si">{</span><span class="n">test_mae</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train RMSE: </span><span class="si">{</span><span class="n">train_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test RMSE: </span><span class="si">{</span><span class="n">test_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train MAPE: % </span><span class="si">{</span><span class="n">train_mape</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAPE: % </span><span class="si">{</span><span class="n">test_mape</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train MAE: 0.0105
Test MAE: 0.0125
Train RMSE: 0.0165
Test RMSE: 0.0186
Train MAPE: % 1.1273
Test MAPE: % 1.3130
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">xgb_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb_pred</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.98140675, 0.9538372 , 0.9789601 , 0.9783878 , 0.9560736 ,
       0.9784849 , 0.97572845, 0.9751216 , 0.9606995 , 0.97613233],
      dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dt
2010-01-01 00:00:00    0.989619
2010-01-01 01:00:00    0.971732
2010-01-01 02:00:00    0.981504
2010-01-01 03:00:00    0.985577
2010-01-01 04:00:00    0.973772
2010-01-01 05:00:00    0.982072
2010-01-01 06:00:00    0.989798
2010-01-01 07:00:00    0.985212
2010-01-01 08:00:00    0.968061
2010-01-01 09:00:00    0.989297
Freq: h, Name: power_factor, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">xgb_pred</span>
<span class="n">error_perc</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span><span class="o">/</span><span class="n">y_test</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>

<span class="n">df_compare_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;real_value&quot;</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s2">&quot;predicted_value&quot;</span><span class="p">:</span> <span class="n">xgb_pred</span><span class="p">,</span>
        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span>
        <span class="s2">&quot;percentage&quot;</span> <span class="p">:</span> <span class="n">error_perc</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">df_compare_xgb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>real_value</th>
      <th>predicted_value</th>
      <th>error</th>
      <th>percentage</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-24 06:00:00</th>
      <td>0.931862</td>
      <td>0.925834</td>
      <td>0.006028</td>
      <td>0.646902</td>
    </tr>
    <tr>
      <th>2010-05-29 03:00:00</th>
      <td>0.931241</td>
      <td>0.942589</td>
      <td>-0.011349</td>
      <td>-1.218671</td>
    </tr>
    <tr>
      <th>2010-02-06 09:00:00</th>
      <td>0.995440</td>
      <td>0.992268</td>
      <td>0.003172</td>
      <td>0.318672</td>
    </tr>
    <tr>
      <th>2010-01-26 10:00:00</th>
      <td>0.995135</td>
      <td>0.992856</td>
      <td>0.002279</td>
      <td>0.229022</td>
    </tr>
    <tr>
      <th>2010-04-17 06:00:00</th>
      <td>0.974493</td>
      <td>0.972513</td>
      <td>0.001980</td>
      <td>0.203162</td>
    </tr>
    <tr>
      <th>2010-01-31 04:00:00</th>
      <td>0.944938</td>
      <td>0.967511</td>
      <td>-0.022574</td>
      <td>-2.388896</td>
    </tr>
    <tr>
      <th>2010-06-27 02:00:00</th>
      <td>0.939908</td>
      <td>0.945474</td>
      <td>-0.005566</td>
      <td>-0.592156</td>
    </tr>
    <tr>
      <th>2010-06-16 07:00:00</th>
      <td>0.962058</td>
      <td>0.953766</td>
      <td>0.008291</td>
      <td>0.861836</td>
    </tr>
    <tr>
      <th>2010-05-19 04:00:00</th>
      <td>0.974993</td>
      <td>0.956017</td>
      <td>0.018976</td>
      <td>1.946268</td>
    </tr>
    <tr>
      <th>2010-05-10 17:00:00</th>
      <td>0.976991</td>
      <td>0.964259</td>
      <td>0.012733</td>
      <td>1.303260</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_compare_xgb</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;xgb_prediction_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="xgboost-with-daily-data">
<h3><em><strong>XgBoost with daily data</strong></em><a class="headerlink" href="#xgboost-with-daily-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">df_daily</span><span class="p">[</span><span class="n">df_daily</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">],</span> <span class="n">df_daily</span><span class="p">[</span><span class="n">df_daily</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test:</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train:	 1112
Test:	 330
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">date_transformed</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofweek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofmonth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dayofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weekofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isocalendar</span><span class="p">()</span><span class="o">.</span><span class="n">week</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;power_factor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;power_factor&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">date_transformed</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">date_transformed</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBRegressor</span>

<span class="n">xgb_model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                         <span class="n">eval_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span><span class="s1">&#39;mape&#39;</span><span class="p">],</span>
                         <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                         <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">xgb_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)])</span>
<span class="n">xgb_pred</span> <span class="o">=</span> <span class="n">xgb_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]	validation_0-mae:0.02192	validation_0-rmse:0.02955	validation_0-mape:0.02333	validation_1-mae:0.01637	validation_1-rmse:0.01902	validation_1-mape:0.01694
[1]	validation_0-mae:0.02101	validation_0-rmse:0.02833	validation_0-mape:0.02237	validation_1-mae:0.01568	validation_1-rmse:0.01817	validation_1-mape:0.01622
[2]	validation_0-mae:0.02017	validation_0-rmse:0.02717	validation_0-mape:0.02146	validation_1-mae:0.01502	validation_1-rmse:0.01737	validation_1-mape:0.01553
[3]	validation_0-mae:0.01934	validation_0-rmse:0.02608	validation_0-mape:0.02058	validation_1-mae:0.01442	validation_1-rmse:0.01667	validation_1-mape:0.01491
[4]	validation_0-mae:0.01856	validation_0-rmse:0.02503	validation_0-mape:0.01975	validation_1-mae:0.01387	validation_1-rmse:0.01602	validation_1-mape:0.01433
[5]	validation_0-mae:0.01783	validation_0-rmse:0.02405	validation_0-mape:0.01897	validation_1-mae:0.01334	validation_1-rmse:0.01544	validation_1-mape:0.01378
[6]	validation_0-mae:0.01711	validation_0-rmse:0.02310	validation_0-mape:0.01821	validation_1-mae:0.01286	validation_1-rmse:0.01493	validation_1-mape:0.01328
[7]	validation_0-mae:0.01645	validation_0-rmse:0.02220	validation_0-mape:0.01750	validation_1-mae:0.01243	validation_1-rmse:0.01451	validation_1-mape:0.01283
[8]	validation_0-mae:0.01581	validation_0-rmse:0.02134	validation_0-mape:0.01682	validation_1-mae:0.01203	validation_1-rmse:0.01410	validation_1-mape:0.01241
[9]	validation_0-mae:0.01522	validation_0-rmse:0.02053	validation_0-mape:0.01619	validation_1-mae:0.01161	validation_1-rmse:0.01370	validation_1-mape:0.01197
[10]	validation_0-mae:0.01464	validation_0-rmse:0.01976	validation_0-mape:0.01557	validation_1-mae:0.01126	validation_1-rmse:0.01341	validation_1-mape:0.01161
[11]	validation_0-mae:0.01411	validation_0-rmse:0.01903	validation_0-mape:0.01501	validation_1-mae:0.01092	validation_1-rmse:0.01312	validation_1-mape:0.01126
[12]	validation_0-mae:0.01361	validation_0-rmse:0.01835	validation_0-mape:0.01448	validation_1-mae:0.01065	validation_1-rmse:0.01288	validation_1-mape:0.01096
[13]	validation_0-mae:0.01312	validation_0-rmse:0.01769	validation_0-mape:0.01395	validation_1-mae:0.01040	validation_1-rmse:0.01268	validation_1-mape:0.01071
[14]	validation_0-mae:0.01268	validation_0-rmse:0.01706	validation_0-mape:0.01348	validation_1-mae:0.01030	validation_1-rmse:0.01255	validation_1-mape:0.01061
[15]	validation_0-mae:0.01223	validation_0-rmse:0.01645	validation_0-mape:0.01301	validation_1-mae:0.01022	validation_1-rmse:0.01247	validation_1-mape:0.01053
[16]	validation_0-mae:0.01183	validation_0-rmse:0.01589	validation_0-mape:0.01258	validation_1-mae:0.01018	validation_1-rmse:0.01240	validation_1-mape:0.01049
[17]	validation_0-mae:0.01143	validation_0-rmse:0.01536	validation_0-mape:0.01215	validation_1-mae:0.01008	validation_1-rmse:0.01230	validation_1-mape:0.01040
[18]	validation_0-mae:0.01105	validation_0-rmse:0.01486	validation_0-mape:0.01175	validation_1-mae:0.01002	validation_1-rmse:0.01222	validation_1-mape:0.01033
[19]	validation_0-mae:0.01072	validation_0-rmse:0.01438	validation_0-mape:0.01139	validation_1-mae:0.00999	validation_1-rmse:0.01220	validation_1-mape:0.01032
[20]	validation_0-mae:0.01039	validation_0-rmse:0.01394	validation_0-mape:0.01104	validation_1-mae:0.00996	validation_1-rmse:0.01218	validation_1-mape:0.01029
[21]	validation_0-mae:0.01008	validation_0-rmse:0.01352	validation_0-mape:0.01070	validation_1-mae:0.00993	validation_1-rmse:0.01215	validation_1-mape:0.01026
[22]	validation_0-mae:0.00979	validation_0-rmse:0.01313	validation_0-mape:0.01040	validation_1-mae:0.00990	validation_1-rmse:0.01212	validation_1-mape:0.01024
[23]	validation_0-mae:0.00950	validation_0-rmse:0.01276	validation_0-mape:0.01009	validation_1-mae:0.00984	validation_1-rmse:0.01207	validation_1-mape:0.01017
[24]	validation_0-mae:0.00922	validation_0-rmse:0.01238	validation_0-mape:0.00979	validation_1-mae:0.00988	validation_1-rmse:0.01217	validation_1-mape:0.01022
[25]	validation_0-mae:0.00895	validation_0-rmse:0.01202	validation_0-mape:0.00950	validation_1-mae:0.00992	validation_1-rmse:0.01228	validation_1-mape:0.01027
[26]	validation_0-mae:0.00869	validation_0-rmse:0.01168	validation_0-mape:0.00923	validation_1-mae:0.00994	validation_1-rmse:0.01237	validation_1-mape:0.01030
[27]	validation_0-mae:0.00846	validation_0-rmse:0.01137	validation_0-mape:0.00898	validation_1-mae:0.00994	validation_1-rmse:0.01244	validation_1-mape:0.01030
[28]	validation_0-mae:0.00825	validation_0-rmse:0.01107	validation_0-mape:0.00875	validation_1-mae:0.00992	validation_1-rmse:0.01244	validation_1-mape:0.01028
[29]	validation_0-mae:0.00804	validation_0-rmse:0.01079	validation_0-mape:0.00853	validation_1-mae:0.00994	validation_1-rmse:0.01253	validation_1-mape:0.01031
[30]	validation_0-mae:0.00785	validation_0-rmse:0.01053	validation_0-mape:0.00832	validation_1-mae:0.00991	validation_1-rmse:0.01252	validation_1-mape:0.01028
[31]	validation_0-mae:0.00764	validation_0-rmse:0.01027	validation_0-mape:0.00810	validation_1-mae:0.00992	validation_1-rmse:0.01260	validation_1-mape:0.01029
[32]	validation_0-mae:0.00747	validation_0-rmse:0.01004	validation_0-mape:0.00792	validation_1-mae:0.00990	validation_1-rmse:0.01260	validation_1-mape:0.01027
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">xgb_model</span><span class="o">.</span><span class="n">evals_result</span><span class="p">()</span>

<span class="c1"># MAE ve RMSE deerlerini yazdr</span>
<span class="n">train_mae</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># MAE in the last iteration</span>
<span class="n">test_mae</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">train_rmse</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;rmse&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># RMSE in the last iteration</span>
<span class="n">test_rmse</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;rmse&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">train_mape</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_0&#39;</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># MAPE in the last iteration</span>
<span class="n">test_mape</span> <span class="o">=</span> <span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;validation_1&#39;</span><span class="p">][</span><span class="s1">&#39;mape&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train MAE: </span><span class="si">{</span><span class="n">train_mae</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAE: </span><span class="si">{</span><span class="n">test_mae</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train RMSE: </span><span class="si">{</span><span class="n">train_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test RMSE: </span><span class="si">{</span><span class="n">test_rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train MAPE: % </span><span class="si">{</span><span class="n">train_mape</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAPE: % </span><span class="si">{</span><span class="n">test_mape</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train MAE: 0.0073
Test MAE: 0.0099
Train RMSE: 0.0098
Test RMSE: 0.0126
Train MAPE: % 0.7750
Test MAPE: % 1.0222
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">xgb_pred</span>
<span class="n">error_perc</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span><span class="o">/</span><span class="n">y_test</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>

<span class="n">df_compare_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;real_value&quot;</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s2">&quot;predicted_value&quot;</span><span class="p">:</span> <span class="n">xgb_pred</span><span class="p">,</span>
        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span>
        <span class="s2">&quot;percentage&quot;</span> <span class="p">:</span> <span class="n">error_perc</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">df_compare_xgb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>real_value</th>
      <th>predicted_value</th>
      <th>error</th>
      <th>percentage</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-22</th>
      <td>0.982808</td>
      <td>0.978409</td>
      <td>0.004399</td>
      <td>0.447585</td>
    </tr>
    <tr>
      <th>2010-10-28</th>
      <td>0.973067</td>
      <td>0.966535</td>
      <td>0.006531</td>
      <td>0.671190</td>
    </tr>
    <tr>
      <th>2010-01-28</th>
      <td>0.983070</td>
      <td>0.975062</td>
      <td>0.008008</td>
      <td>0.814542</td>
    </tr>
    <tr>
      <th>2010-02-21</th>
      <td>0.988678</td>
      <td>0.980185</td>
      <td>0.008493</td>
      <td>0.859030</td>
    </tr>
    <tr>
      <th>2010-02-12</th>
      <td>0.990036</td>
      <td>0.978898</td>
      <td>0.011138</td>
      <td>1.125025</td>
    </tr>
    <tr>
      <th>2010-03-29</th>
      <td>0.970172</td>
      <td>0.976209</td>
      <td>-0.006037</td>
      <td>-0.622297</td>
    </tr>
    <tr>
      <th>2010-03-03</th>
      <td>0.976115</td>
      <td>0.964946</td>
      <td>0.011168</td>
      <td>1.144178</td>
    </tr>
    <tr>
      <th>2010-02-19</th>
      <td>0.985835</td>
      <td>0.978864</td>
      <td>0.006971</td>
      <td>0.707103</td>
    </tr>
    <tr>
      <th>2010-06-14</th>
      <td>0.964894</td>
      <td>0.965776</td>
      <td>-0.000883</td>
      <td>-0.091472</td>
    </tr>
    <tr>
      <th>2010-10-09</th>
      <td>0.965106</td>
      <td>0.968537</td>
      <td>-0.003432</td>
      <td>-0.355588</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_compare_xgb</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;xgb_daily_pred_results.csv&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>


<span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;arima_prediction_results.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sarima_prediction_results.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auto_arima_prediction_results.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;prophet_prediction_results.csv&quot;</span>   
    <span class="p">]</span>


<span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_names</span><span class="p">:</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_prediction_results.csv&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;error_%&quot;</span><span class="p">])</span> 
    <span class="n">new_columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>  
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_columns</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
    <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  


<span class="n">df_compare_all_models</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_compare_all_models</span><span class="p">[</span><span class="s2">&quot;xgb_error_%&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;xgb_daily_pred_results.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span>


<span class="n">df_compare_all_models</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arima/error_%</th>
      <th>sarima/error_%</th>
      <th>auto_arima/error_%</th>
      <th>prophet/error_%</th>
      <th>xgb_error_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36.919460</td>
      <td>0.870441</td>
      <td>0.958715</td>
      <td>0.862422</td>
      <td>0.318493</td>
    </tr>
    <tr>
      <th>1</th>
      <td>69.187105</td>
      <td>-0.432925</td>
      <td>2.665857</td>
      <td>-0.713748</td>
      <td>-1.019247</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90.447853</td>
      <td>0.806951</td>
      <td>-0.687787</td>
      <td>0.156396</td>
      <td>0.388411</td>
    </tr>
    <tr>
      <th>3</th>
      <td>93.569974</td>
      <td>0.850250</td>
      <td>-0.190512</td>
      <td>0.143197</td>
      <td>0.193820</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98.908173</td>
      <td>0.750582</td>
      <td>-0.030766</td>
      <td>0.061455</td>
      <td>0.834630</td>
    </tr>
    <tr>
      <th>5</th>
      <td>99.602648</td>
      <td>0.473679</td>
      <td>-2.638387</td>
      <td>-0.002028</td>
      <td>0.309031</td>
    </tr>
    <tr>
      <th>6</th>
      <td>97.099473</td>
      <td>1.042377</td>
      <td>-3.517225</td>
      <td>0.543651</td>
      <td>0.679661</td>
    </tr>
    <tr>
      <th>7</th>
      <td>99.807130</td>
      <td>0.162740</td>
      <td>-3.791912</td>
      <td>-0.166422</td>
      <td>0.462942</td>
    </tr>
    <tr>
      <th>8</th>
      <td>99.961608</td>
      <td>0.044080</td>
      <td>-2.025771</td>
      <td>-0.545797</td>
      <td>0.115095</td>
    </tr>
    <tr>
      <th>9</th>
      <td>99.960423</td>
      <td>0.509126</td>
      <td>-1.289817</td>
      <td>-0.301452</td>
      <td>0.434722</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_compare_all_models</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>arima/error_%         99.708973
sarima/error_%        -1.373724
auto_arima/error_%    -1.054760
prophet/error_%       -0.796400
xgb_error_%            0.679632
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusion">
<h1><em><strong>Conclusion:</strong></em><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h1>
<p>According to the results so far, the Xgboost model is the best model to predict our future data, but based on extensive results review, Prophet may be preferred.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="LSTM_GRU_DeepAR_notebook.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><em><strong>About Dataset And Features:</strong></em></p>
      </div>
    </a>
    <a class="right-next"
       href="OpenCV.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Face Detection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><u> <p style="text-indent:30px; text-align:center;"><strong>Household Electric Power Consumption Forecasting</strong></p></u></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-dataset-and-features"><em><strong>About Dataset And Features:</strong></em><br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notes"><em><strong>Notes:</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#features"><em><strong><u>Features:</u></strong></em> <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries"><strong>1.Import Libraries:</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data"><em><strong>2.Reading Data</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#change-all-column-names-to-lowercase"><strong>Change all column names to lowercase</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-values-nan-with-a-test-statistic"><em><strong>Dealing with missing values  nan with a test statistic</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-and-analyzing-values-feature-by-feature"><em><strong>3. Data visualization and analyzing values feature by feature</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dt-dates-and-time">3.1 dt (Dates and time)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-active-power-kw">3.2 Global_Active_Power[kw]:<br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#above-i-resampled-data-over-day-and-show-the-sum-and-mean-of-global-active-power-it-is-seen-that-mean-and-sum-of-resampled-dataset-have-similar-behaviour">Above I resampled data over day, and show the sum and mean of Global_active_power. It is seen that mean and sum of resampled dataset, have similar behaviour.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-with-moving-average">Trend Analysis with Moving Average</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-graph-displays-daily-total-active-power-consumption-blue-line-and-its-30-day-moving-average-red-line-for-smoothing-fluctuations">This graph displays daily total active power consumption (blue line) and its 30-day moving average (red line) for smoothing fluctuations.<br/></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-decomposition"><strong>Seasonal Decomposition</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-very-important-to-note-from-above-plots-that-resampling-over-larger-time-inteval-will-diminish-the-periodicity-of-system-as-we-expect-this-is-important-for-machine-learning-feature-engineering">It is very important to note from above plots that resampling over larger time inteval, will diminish the periodicity of system as we expect. This is important for machine learning feature engineering.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-reactive-power-kw">3.3 Global_reactive_power[kw]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-intensity-ampere">3.4 Global_intensity[Ampere]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voltage-v">3.5 Voltage[ V ]:<br/></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-seen-from-the-above-plots-that-the-mean-of-volage-over-month-is-pretty-much-constant-compared-to-other-features-this-is-important-again-in-feature-selection">It is seen from the above plots that the mean of Volage over month is pretty much constant compared to other features. This is important again in feature selection.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-1-wh">3.6 Sub_metering_1[WH]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-2-wh">3.7 Sub_metering_2[WH]:<br/></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sub-metering-3-wh">3.8 Sub_metering_3[WH]:<br/></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations-among-features"><em><strong>4.Correlations among features</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-above-two-plots-it-is-seen-that-global-intensity-and-global-active-power-correlated-but-voltage-global-active-power-are-less-correlated-this-is-important-observation-for-machine-learning-purpose">From above two plots it is seen that Global_intensity and Global_active_power correlated. But Voltage, Global_active_power are less correlated. This is important observation for machine learning purpose.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#it-is-seen-from-above-that-with-resampling-techniques-one-can-change-the-correlations-among-features-this-is-important-for-feature-engineering"><em><strong>It is seen from above that with resampling techniques one can change the correlations among features. This is important for feature  engineering.</strong></em></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling"><em><strong>5.MODELING</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-preparation">5.1. Model Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-and-adding-power-factor"><em><strong><em>5.1.1. Calculating and Adding Power Factor</em></strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-power-factor">What is Power Factor?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where">Where:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-the-picture-below">Look at the picture below <br/></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-power-factor-important">Why is Power Factor Important?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-want-to-do-the-trend-and-seasonal-decomposition-analyses-that-i-did-for-global-active-power-in-the-previous-sections-for-the-power-factor-here"><strong>I want to do the trend and seasonal decomposition analyses that I did forglobal_active_power in the previous sections for the power factor here.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#power-factor-time-series-decomposition-in-detail"><em><strong>Power Factor time series decomposition in detail:</strong></em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection"><em><strong>5.2. Model Selection:</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-sarima-models"><em><strong>5.2.1.ARIMA/SARIMA MODELS</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-stationarity"><em><strong>5.2.1.1.Checking Stationarity:</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adf-and-kpss"><em><strong>ADF and KPSS</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tests-we-performed-showed-that-all-the-features-were-stationary-but-if-they-were-not-stationary-we-would-have-to-apply-the-following-methods"><em><strong>The tests we performed showed that all the features were stationary, but if they were not stationary, we would have to apply the following methods.</strong></em><br/><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arima-sarima-model-implementation"><em><strong>5.2.1.2.ARIMA/SARIMA Model Implementation:</strong></em><br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#of-course-this-is-not-a-result-to-be-taken-seriously"><em><strong>Of course, this is not a result to be taken seriously.</strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prophet-model"><em><strong>5.2.2.Prophet Model</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zoom-in-on-estimated-time-range-this-prophet-forecast-chart-shows-the-actual-and-forecast-values-of-the-time-series-in-the-test-period-year-2010"><em><strong>zoom in on estimated time range: This Prophet forecast chart shows the actual and forecast values of the time series in the test period (year 2010)</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-features-did-not-contribute-to-the-model"><em><strong>Adding features did not contribute to the model</strong></em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-to-capture-the-best-parameters-for-prophet"><em><strong>Cross validation to capture the best parameters for Prophet</strong></em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost"><em><strong>5.2.3.XGBoost</strong></em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-with-daily-data"><em><strong>XgBoost with daily data</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><em><strong>Conclusion:</strong></em></a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nazm ALIK
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>